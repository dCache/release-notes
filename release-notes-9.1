HTML header: <title>dCache 9.1 Release Notes</title>
             <!--#include virtual="/template/default-head.shtml" -->
             <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
             <!-- Bootstrap -->
             <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css"
                   integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous"/>
             <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap-theme.min.css"
                   integrity="sha384-fLW2N01lMqjakBkx3l/M9EahuwpSfeNvV63J5ezn3uZzapT0u7EYsXMjQV+0En5r" crossorigin="anonymous"/>
             <!--link type="text/css" rel="stylesheet" href="jquery.tocify.css" /-->
             <style type="text/css">
             h5 {
                 font-size: 15px;
                 font-style: italic;
                 margin-top: 20px;
             }
             body {
                 padding-top: 20px;
             }
             @media (max-width: 767px) {
                 #toc {
                     position: relative;
                     width: 100%;
                     margin: 0px 0px 20px 0px;
                 }
             }
             @media print {
                 #toc {
                     display: none;
                 }
             }
             </style>

<div class="container">
<div id="banner">
   <div id="bird_large">
      <img src="/images/dcache-banner.png" class="bird"></img>
   </div>
   <div id="sidebar-b">
      <span class="dcache-nav-bar">
      <a href="/index.shtml">home</a>
      |
      <a href="/news.shtml">news</a>
      |
      <a href="/manuals/index.shtml">documentation</a>
      |
      <a href="/downloads/IAgree.shtml">downloads</a>
      |
      <a href="/feedback.shtml">feedback</a>
      |
      <a href="/manuals/googlesearch.shtml">search</a>
      |
      <a href="/imprint.shtml">imprint&#160;</a>
      </span>
   </div>
</div>
<div id="content">

<div class="row">

<div class="page-header">
<h1>What's new in dCache 9.1<br/>
<small>Release notes</small></h1>
</div>

## Highlights

- Improve concurrent file create rate in a single directory

## Incompatibilities

- Starting version 9.1 the nlink count for directories shows only number of subdirectories. Thus, the existing
  nlink count can be out-of-sync with we no automatic re-synchronization is performed.
- dropped gplazma support for XACML
- pool binds TCP port for `http` and `xroot` movers on startup

## Acknowledgments

(tbd, this section uses markdown formatting)


## Release 9.1.0


### Packaging

The rpm package will call `systemctl daemon-reload` after install or update.

### Pinmanager

### PNFS Manager

The chimera layer supports two new java properties that control parent directory attribyte update on create:

 - chimera_lazy_wcc
 - chimera_soft_update
 
 The `chimera_lazy_wcc` options instruct dcache not to update directoy attributes right away. Instead the desired information is stored
 in additiona `t_lazy_wcc` table, that is periodically merged into `t_inodes`. This behavior improves concurrent file create rate in a single directory.
 The attribute syncronization time is hard-coded and equals to 30 seconds.
 
 The `chimera_soft_update` options tells dcache to check for pending updates in `t_lazy_wcc` on `stat` calls. This option should be enabled, if 30 seconds
 attribute merge time can't be used (typically NFS write based workloads).


### Pool

Added posibility to dynamically add and remove nearline storage providers, which allows to update the provider without
restarting the dCache:

```
    (pool_write@dCacheDomain) admin > hsm show providers
    PROVIDER DESCRIPTION                                                 DYNAMIC
    script   Calls out to an HSM integration script.                     no
    link     Hard links flushed files in another directory.              no
    copy     Copies files to and from another directory.                 no
    tar      Bundles files into tar archives (not ready for production). no
    
    (pool_write@dCacheDomain) admin > hsm load provider /tmp/dcache-cta-0.6.0
    New provides:
    PROVIDER   DESCRIPTION
    dcache-cta dCache Nearline Storage Driver for CTA. Version: 0.6.0 2022-07-20T09:33:38Z
    
    (pool_write@dCacheDomain) admin > hsm show providers
    PROVIDER   DESCRIPTION                                                                 DYNAMIC
    script     Calls out to an HSM integration script.                                      no
    link       Hard links flushed files in another directory.                               no
    copy       Copies files to and from another directory.                                  no
    tar        Bundles files into tar archives (not ready for production).                  no
    dcache-cta dCache Nearline Storage Driver for CTA. Version: 0.6.0 2022-07-20T09:33:38Z yes
    
    (pool_write@dCacheDomain) admin > hsm unload provider dcache-cta
    Removed provides:
    PROVIDER   DESCRIPTION
    dcache-cta dCache Nearline Storage Driver for CTA. Version: 0.6.0 2022-07-20T09:33:38Z
    
    (pool_write@dCacheDomain) admin > hsm show providers
    PROVIDER DESCRIPTION                                                 DYNAMIC
    script   Calls out to an HSM integration script.                     no
    link     Hard links flushed files in another directory.              no
    copy     Copies files to and from another directory.                 no
    tar      Bundles files into tar archives (not ready for production). no
    
    (pool_write@dCacheDomain) admin > hsm load provider /tmp/dcache-cta-0.7.0
    New provides:
    PROVIDER   DESCRIPTION
    dcache-cta dCache Nearline Storage Driver for CTA. Version: 0.7.0 2022-11-04T08:32:39Z
    
    (pool_write@dCacheDomain) admin > hsm show providers
    PROVIDER   DESCRIPTION                                                                 DYNAMIC
    script     Calls out to an HSM integration script.                                      no
    link       Hard links flushed files in another directory.                               no
    copy       Copies files to and from another directory.                                  no
    tar        Bundles files into tar archives (not ready for production).                  no
    dcache-cta dCache Nearline Storage Driver for CTA. Version: 0.7.0 2022-11-04T08:32:39Z yes
```

The `mover ls` command updated to display remote peers IP address for xroot and http movers.

The `st/rh/rm kill` admin commands accept `*` to cancel all running requests.

Kafka message include pool's local socket address used by the transfer.


The until release 9.1 xroot and http movers ware binding TCP port on a first request and then shutdown the
socket when no movers runnig. Now on, dCache will binds the ports on startup and keep them for the whole JVM
lifetime.


### SystemCell

The system cell provides new two commands `jfr start` and `jfr stop` to start and stop Java flight
recorder directly from the admin interface. More Information aboit flight recorder and dCache can be found
[debug section](https://github.com/dCache/dcache/blob/master/docs/TheBook/src/main/markdown/cookbook-debugging.md) of the dCache Book.
The JFR can be stated with one of the pre-defined JVM supplied configurations or with a custom configuration file.



### Changelog from 9.0.0 to 9.1.0

[dba3b07251](https://github.com/dcache/dcache/commit/dba3b07251d47ab87a2ac830fca1805976c5d779)
:   [maven-release-plugin] prepare for next development iteration

[51c87fdc3b](https://github.com/dcache/dcache/commit/51c87fdc3b4748c0e9256cdadaaa19dea13f6c3e)
:   [maven-release-plugin] prepare release 9.1.0

[3f7b872a85](https://github.com/dcache/dcache/commit/3f7b872a857fa1992cd46087f94fd2633bc0a68c)
:   [maven-release-plugin] prepare branch @{releaseLabel}

[a8e0c4fe7b](https://github.com/dcache/dcache/commit/a8e0c4fe7b5c7972413a4cfedea2690aaa297a6b)
:   core: don't contact pools for regulary expired pins

[984c96671e](https://github.com/dcache/dcache/commit/984c96671e76737f83ac172d1ba0541721683116)
:   several: remove suspicious whitespace char occurrences

[94776d6629](https://github.com/dcache/dcache/commit/94776d6629e18e30c70be1cf68e145c79eb00fa5)
:   build(deps): bump jetty-server from 9.4.44.v20210927 to 9.4.51.v20230217

[9057f64428](https://github.com/dcache/dcache/commit/9057f64428a59c76124a90837dc798bb3d209455)
:   pool: always bind to TCP ports for netty based movers

[326de63d4d](https://github.com/dcache/dcache/commit/326de63d4d5a3fc9f17da61937245246e0b0de58)
:   webdav: fix dropdown menu layout

[96c8a9bd97](https://github.com/dcache/dcache/commit/96c8a9bd977126ffa31291f8f74cc6b03632b1b5)
:   webdav: fix regression of visual elements with bootstrap 5

[92858afb06](https://github.com/dcache/dcache/commit/92858afb06b5a290cf45046b4ce316196d27b277)
:   webdav: fix visual element regression after bootstrap 5 upgrade

[4644c6863b](https://github.com/dcache/dcache/commit/4644c6863bc4d81a0b3c08cac56f036269c47b97)
:   metadata: add (some) ORCIDs to CITATION.cff

[2e1b3bc9c9](https://github.com/dcache/dcache/commit/2e1b3bc9c9387daf075690bba26582d0c73e63df)
:   dcache-frontend: update SWAGGER comments for bulk offset on POST and GET

[4525fc12e1](https://github.com/dcache/dcache/commit/4525fc12e1adcb72f44a642b9bbfbdcd4b20a8bc)
:   dcache-bulk: increment/decrement in-memory counts exclusively in the target object

[d7653b9a01](https://github.com/dcache/dcache/commit/d7653b9a01649ad30dd29541af467b95daefe6b8)
:   pnfsmanager: process listings of the same path sequentially, implement list message folding

[9680a857e0](https://github.com/dcache/dcache/commit/9680a857e07c7565ac12aaff2544a84e660e731e)
:   benchmark: fix CreateBenchmark

[10c2fe8c6b](https://github.com/dcache/dcache/commit/10c2fe8c6bd94a0c1a05e9dc7d79b58af9a5a0dd)
:   dcache-bulk: fix double counting of RUNNING targets

[ff7a67afc9](https://github.com/dcache/dcache/commit/ff7a67afc97c3bdfce6791a3d4d8359c76a72aea)
:   dcache-bulk,dcache-frontend: distinguish "Not Found" from "Invalid" request

[5a902367f4](https://github.com/dcache/dcache/commit/5a902367f413d4863743eb7cd0f7c48278e5464d)
:   Update BUILDING.md: mention required patch utility

[050f680f10](https://github.com/dcache/dcache/commit/050f680f108ef54c46435d9c205c84ebedfce6f4)
:   pool: include local endpoint information into billing info

[8819d134f4](https://github.com/dcache/dcache/commit/8819d134f4a4a25ae896c1f7f2602000d613fb04)
:   benchmarks:  remove call to removed psu method

[55e3bf9280](https://github.com/dcache/dcache/commit/55e3bf92801545c519d370f20ee148b84ef32d09)
:   libs: use netty-4.1.92

[aa96df7804](https://github.com/dcache/dcache/commit/aa96df7804b61cbd8617691468f6b7337f2493a4)
:   gplazma: print selected JWT claims for failed logins

[cef9e7759d](https://github.com/dcache/dcache/commit/cef9e7759d86e9dac8d4e56d97d79a08321f9248)
:   rc: remove xacml plugin leftovers

[6fe9d443b4](https://github.com/dcache/dcache/commit/6fe9d443b405caf37d568b01bd652d079e94582e)
:   build(deps): bump json from 20141113 to 20230227

[42a3332348](https://github.com/dcache/dcache/commit/42a33323487cd371e2835b39015f764542d38f26)
:   gplazma2: drop gplazma2-xacml plugin

[62de04a14e](https://github.com/dcache/dcache/commit/62de04a14ea8290cb41ac75dc67edcc42262fdce)
:   poolmanager: fix bad commit

[3005ec0c77](https://github.com/dcache/dcache/commit/3005ec0c775c88050a394584fafbf6259b5dc7cf)
:   psu:do not allow doublicates in nested subgroup

[c0c11f4aa2](https://github.com/dcache/dcache/commit/c0c11f4aa2cc9926ce5e91d63319d3a2e6254ec9)
:   poolmanager: delete property for switchingon/off caching for psu Motivation

[9a2291cfa4](https://github.com/dcache/dcache/commit/9a2291cfa489f7a76b947b81de8193e7df38b3fa)
:   nfs: remove failed to start read transfers

[1484e3f19b](https://github.com/dcache/dcache/commit/1484e3f19b5d3ab549e82411d362b7b42f913ac0)
:   Motivation:

[7817174e3e](https://github.com/dcache/dcache/commit/7817174e3ec17edc3061ba18586c04af04759964)
:   dcache-core,dcache-xroot,dcache-bulk,dcache-frontend:  resolve path prefixes and paths for symlinks

[3657a1f4e6](https://github.com/dcache/dcache/commit/3657a1f4e6681aebec236ab5086dbaece1864643)
:   commons,dcache:  alternative symlinks resolution on restrictions

[bc3f277cc1](https://github.com/dcache/dcache/commit/bc3f277cc1a368fdc8c1377ac7d46a23adbdd4b2)
:   chimera: fix recursive delete

[11d6f04170](https://github.com/dcache/dcache/commit/11d6f041703ad63aa3765709dc8344d51a19ecbd)
:   Add headline to minimal dCache installation guide

[f3286f9d05](https://github.com/dcache/dcache/commit/f3286f9d05c82dbadfe635921955b750dc923551)
:   chimera: introduce lazy update of parent directory attribute update

[129ae11c87](https://github.com/dcache/dcache/commit/129ae11c87329ee8e707f7c849ce5c6d2949c09d)
:   kafka:fix issue 7123  Kafka events fail to post

[1e2464c29c](https://github.com/dcache/dcache/commit/1e2464c29c5a32663cfa7e912be221d8db023703)
:   nearline-storage: update st/rh/rm kill command to accept wildcard

[c136bb3fb7](https://github.com/dcache/dcache/commit/c136bb3fb76cd2ceec0dd964ba1beab5e69a2371)
:   util: don't use ListenableFuture in SpreadAndWait

[8ceacc81d8](https://github.com/dcache/dcache/commit/8ceacc81d8f412c58347d5abada4f93e8a1d04ce)
:   dcache-xroot: restore proper handling of single-slash paths

[caf34efe74](https://github.com/dcache/dcache/commit/caf34efe74b904c17c4ff5d56e62c1d353ad646d)
:   systemtest: fix support for oidc testing

[8e7b31ff4c](https://github.com/dcache/dcache/commit/8e7b31ff4c6414417a9f6f09ed808abee9903f4c)
:   libs: use spring-5.3.27

[a760a0b9c8](https://github.com/dcache/dcache/commit/a760a0b9c8165cebc04b1725664ac3af91afd36d)
:   build: make container build part of tar package

[c8b83dba2f](https://github.com/dcache/dcache/commit/c8b83dba2fb0f9b7becba1c358699aef6b707ec4)
:   pool: include client IP in `mover ls` for netty based movers

[7e25d2947a](https://github.com/dcache/dcache/commit/7e25d2947a09ab1ed7da0864da8fe0512c242af0)
:   rpm: reload systemd daemon after update/uninstall

[7e35bbd0ae](https://github.com/dcache/dcache/commit/7e35bbd0aeb2e9092f0be327fb8bdd52e192aed7)
:   nearline-storage: add possibility to dynamically un/load providers

[8a4273fa8c](https://github.com/dcache/dcache/commit/8a4273fa8ce478fd5dffa425728fe505b367d629)
:   webdav: preserve request URL in protocol info

[303ee5a4a1](https://github.com/dcache/dcache/commit/303ee5a4a15f2fca52be7e34d8f558634c221ea9)
:   dcache-bulk: fix prefix-stripping logic when returning request info

[954c1b2e11](https://github.com/dcache/dcache/commit/954c1b2e11e3151f2e2d58a5db6ca2358adf1c59)
:   dcache-bulk:  reset policy defaults

[7d898c5601](https://github.com/dcache/dcache/commit/7d898c5601d30c6f8cc027e4080f3b82c2072f4b)
:   dcache-qos:  propagate subject to QoS Adjuster

[777aa7bc86](https://github.com/dcache/dcache/commit/777aa7bc86318c4e47af3490edc5eb4070f7d330)
:   cells: drop ListenableFuture from CellNucleus startup logic

[7c14b06ebe](https://github.com/dcache/dcache/commit/7c14b06ebecde35d66abadcd676aec69b8a16a01)
:   cells: allow configuration selection for JFR

[54154107bb](https://github.com/dcache/dcache/commit/54154107bb989e9645df96993b2b57965d9243bf)
:   update

[4580af2108](https://github.com/dcache/dcache/commit/4580af21084a28a49d0ff1fcff4394beaa6a5fa8)
:   update

[cbd4a44ad8](https://github.com/dcache/dcache/commit/cbd4a44ad81c06b17f84eba9651ba4679482ca84)
:   oicd-gplazma-explained

[c5b4dc9751](https://github.com/dcache/dcache/commit/c5b4dc9751b0d2dfa68fa731607ac029e7f7fd7a)
:   bulk: let bulk propagate Subject for pin/stage

[33c52d6152](https://github.com/dcache/dcache/commit/33c52d61529658f0d1bdb8af6c4ea79c384164d7)
:   libs: update nfs4j to 0.24.3

[1c0276a8d2](https://github.com/dcache/dcache/commit/1c0276a8d2022a697d27ffb1128614fbdd301bd7)
:   Revocation entries are defunct since gplazma-1 is discontinued

[0391098818](https://github.com/dcache/dcache/commit/0391098818f8c426ecb6f1ffd50eec964711a854)
:   nfs: bind layout disposal to layout state id

[431d1384a3](https://github.com/dcache/dcache/commit/431d1384a30237d8296f1dabbca33132f047d7c5)
:   chimera:  fix bug in resolve_path stored procedure

[7d9baa5f6f](https://github.com/dcache/dcache/commit/7d9baa5f6feef3d9c1804ee7626f8c6caf7a70f4)
:   nfs: ensure that mover always associated with an open-stateid

[b080d270e8](https://github.com/dcache/dcache/commit/b080d270e8cf56b2736f7ef99f8b24b02a0b868f)
:   pom.xml: update to next xrootd4j version (4.5.6, 4.4.7, 4.3.8, 4.2.12)

[51594993ee](https://github.com/dcache/dcache/commit/51594993ee1ac88d8b8ad350788f5153e0665b98)
:   dcache-frontend: support VO- or user-root relative paths in requests

[c491f2d312](https://github.com/dcache/dcache/commit/c491f2d312abcbadefcf1df2af85c5620e1e1867)
:   dcache-xroot:  support relative path in URL

[eb3713fded](https://github.com/dcache/dcache/commit/eb3713fded3c3da45887b7f01342be4af7335b51)
:   chimera: let JdbcFs run maintenance tasks for all backend implementation

[138b0ca4c2](https://github.com/dcache/dcache/commit/138b0ca4c263a5bd8776dd2ae8f05eb57ac162c1)
:   webdav: return empty list instead of null as an empty collection

[c4c31e989f](https://github.com/dcache/dcache/commit/c4c31e989f5a9ba0056e3eb5b11a93e60e0cc2db)
:   pool: ensure that nfs mover completion takes place

[ec1ab13610](https://github.com/dcache/dcache/commit/ec1ab1361099e96d8cd16932fd657d1951adda7a)
:   dcache-frontend:  improve Swagger annotations for release and archiveinfo

[b40119c377](https://github.com/dcache/dcache/commit/b40119c37741513a1e336300e99fbdd1ba2d6b4c)
:   dcache-frontend: improve error message for empty string or non-JSON payload

[b347d250f8](https://github.com/dcache/dcache/commit/b347d250f87a969e2f1a8a6dbb2338ad84445d3a)
:   common-cli: add possibility to have command duplicates

[575a62f4ab](https://github.com/dcache/dcache/commit/575a62f4ab89b6e5f0d934293ba5e27ec1c99f0e)
:   pnfsmanager: fix migration move/copy going into SLEEP mode when the file on the pool has been deleted

[3f92bfa260](https://github.com/dcache/dcache/commit/3f92bfa260f24fab51d870d4b6ecd8a043d74462)
:   migration: fixing sleeping state for broken  files

[cede2bad9a](https://github.com/dcache/dcache/commit/cede2bad9a16937731b35e3c37eaf74c6a896af6)
:   kafka: ensure that errors are logged properly

[59f5862dd5](https://github.com/dcache/dcache/commit/59f5862dd51d158439874bdd99ae1886665be430)
:   pom.xml: update to next xrood4j version (4.5.5, 4.3.7, 4.2.11)

[60c9937ad9](https://github.com/dcache/dcache/commit/60c9937ad9cb3fdf631ee077384288b7b4f73a99)
:   cells: add commands to start/stop java flight recording

[081fdf0e3c](https://github.com/dcache/dcache/commit/081fdf0e3cb1d710da584df5fb440dd1842d1dcc)
:   poolmanager: chache the pool selection prefferences key for request

[002c2805a8](https://github.com/dcache/dcache/commit/002c2805a8d3663d798b9d925b21d40633960ec4)
:   chimera: fix PostgreSQL optimization for labels

[725eda7b24](https://github.com/dcache/dcache/commit/725eda7b24640e72b27850314187e2d35305408a)
:   gplazma: oidc add suppress for audience claim verification

[1d41db5ace](https://github.com/dcache/dcache/commit/1d41db5ace9320b7c575dd6c674f82b2a6cebc91)
:   gplazma: oidc allow suppression of offline verification

[f13812ea01](https://github.com/dcache/dcache/commit/f13812ea01da469edf82f319fa1b3b6f4c98aa08)
:   gplazma: oidc add support for suppress option

[ecc1b2bbfb](https://github.com/dcache/dcache/commit/ecc1b2bbfb9bde299b64620a35c8a596e040416e)
:   unit test: fix NPE in NearlineStorageHandler test introduced by commit 5cb806a904a846395e48528dfc6bcb16a7afc26a

[5cb806a904](https://github.com/dcache/dcache/commit/5cb806a904a846395e48528dfc6bcb16a7afc26a)
:   pool: add variable to control duration of initial sticky bit upon restore.

[7f16ca2ca3](https://github.com/dcache/dcache/commit/7f16ca2ca375bd1bc9b8971572897d348dd06386)
:   dcache-frontend:  add more detailed description of request objects for bulk and stage

[44701e6ded](https://github.com/dcache/dcache/commit/44701e6ded84b1a68d898a150e5d7aa98746c5ca)
:   dcache-bulk: small improvement to RB 13915

[8f0653e520](https://github.com/dcache/dcache/commit/8f0653e5202d56768140e90be70e0ec240610a45)
:   chimera: testDeleteDir should create a directory

[f240f1fdc3](https://github.com/dcache/dcache/commit/f240f1fdc301432943cab1f94ab4764d69d30ed4)
:   dcache-bulk:  fix JSON object key not found exception

[7cb0cd0c5f](https://github.com/dcache/dcache/commit/7cb0cd0c5f5c1debe97ee0ff868e5455f33fefdb)
:   dcache,chimera: resolve symlink before applying Restriction

[5a573a5d56](https://github.com/dcache/dcache/commit/5a573a5d562c2ecda9261e8921f8de19b1a2ef30)
:   dcache: add admin cmd to forget FAILED_TO_UNPINs for pool

[f55bb87d90](https://github.com/dcache/dcache/commit/f55bb87d90cc56823b757b2c8d3ff58fb6dadb98)
:   [maven-release-plugin] prepare for next development iteration

[e0a1266c9d](https://github.com/dcache/dcache/commit/e0a1266c9d7b00f1699821fa31979c19c6f89668)
:   Fix grammar and formatting.

[1a3d39be9a](https://github.com/dcache/dcache/commit/1a3d39be9ac5c5802b78265bd5c1a6d381c48a68)
:   Allow for getting Migration Information per REST. Also cleanup some code for Migration REST in general.

[5d13f0e518](https://github.com/dcache/dcache/commit/5d13f0e518768921cae34d89d2daba335a8ae54b)
:   build(deps): bump netty-codec-http from 4.1.77.Final to 4.1.86.Final





<!-- git log 9.0..9.1 -no-merges -format='[%h](https://github.com/dcache/dcache/commit/%H)%n:   %s%n' -->

(tbd as soon as the branching is done)


</div>
</div>
</div>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js" type="text/javascript"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"
        integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>

<script src="https://google-code-prettify.googlecode.com/svn/loader/run_prettify.js" type="text/javascript"></script>
