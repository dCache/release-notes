HTML header: <title>dCache 2.10 Release Notes</title>
             <!--#include virtual="/template/default-head.shtml" -->
             <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
             <!-- Bootstrap -->
             <link rel="stylesheet" href="https://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css"/>
             <link rel="stylesheet" href="https://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap-theme.min.css"/>
             <!--link type="text/css" rel="stylesheet" href="jquery.tocify.css" /-->
             <style type="text/css">
	     h5 {
		 font-size: 15px;
		 font-style: italic;
                 margin-top: 20px;
             }
             body {
                 padding-top: 20px;
             }
             @media (max-width: 767px) {
                 #toc {
                     position: relative;
                     width: 100%;
                     margin: 0px 0px 20px 0px;
                 }
             }
             @media print {
                 #toc {
                     display: none;
                 }
             }
             table.table {
                 font-size: 12px;
             }
             </style>

<div class="container">
<div id="banner">
   <div id="bird_large">
      <img src="/images/dcache-banner.png" class="bird"></img>
   </div>
   <div id="sidebar-b">
      <span class="dcache-nav-bar">
      <a href="/index.shtml">home</a>
      |
      <a href="/news.shtml">news</a>
      |
      <a href="/manuals/index.shtml">documentation</a>
      |
      <a href="/downloads/IAgree.shtml">downloads</a>
      |
      <a href="/feedback.shtml">feedback</a>
      |
      <a href="/manuals/googlesearch.shtml">search</a>
      |
      <a href="/imprint.shtml">imprint&#160;</a>
      </span>
   </div>
</div>
<div id="content">

<div class="row">

<div class="page-header">
<h1>What's new in dCache 2.10<br/>
<small>The release notes</small></h1>
<address>
<strong>Authors</strong><br/>
Paul Millar  &lt;paul.millar@desy.de&gt;
</address>
</div>


## Executive summary

* Improved SRM scheduling and protection of other components.

* Reimplemented webadmin active transfers page.

* Improved support for HTTP and HTTPS 3rd-party transfers.

* Added support for 3rd-party transfers through WebDAV.

* Improved support for HTTP 3rd-party transfers through SRM.

* Improved default HTML rendering in WebDAV.

* Added JSON support for info.

## Incompatibilities

* The NFS namespace cache configuration parameter
  nfs.namespace-cache.unit is renamed to
  nfs.namespace-cache.time.unit; this makes it compliant with dCache
  configuration guidelines.

* Kerberos uses values in /etc/krb5.conf by default.  If both
  kerberos.realm and kerberos.key-distribution-center-list are set
  then custom values are used.

* In billing log files, transfer-specific information is written as a
  colon-separated list of items.  For HTTP and xrootd, the format has
  changed, with a colon now separating the protocol version
  information and the client IP address.  The output for HTTP and
  xrootd is now consistent with information recorded for other
  protocol transfers.

## Release 2.10.55

### Changes affecting multiple services

Several cases of slow performance were reported while deleting
directory in Chimera.  This is now fixed.

### pool

When command execution to migrate files between pools (e.g. `migration
concurrency` or `migration copy`) is interrupted due to the failure to
find migration job the returned error message is considered as a bug.
This is now fixed so that a new message is returned indicating that
the job being requested does not exist.

### srm

When file upload is cancelled the value of temporary upload path
tracked by SRM could be a value different from a regular path, either
because it was changed outside of dCache, or it contains entries from
a very old version of dCache. This could result in data loss while
canceling upload.  The current release fixed a potential data loss
scenario.

### statistics

The statistics service creates static HTML pages that describe dCache
usage over time as simple files that the webadmin service can
serve. This includes information about pools and store-units.  The
problem is that the statistics webpages do not show information about
any pool or store-unit that contains a `/` in the name.  This is now
fixed.  A side-effect is that the history of any pool or store-unit
containing a `^` in the name is lost.


### Changelog 2.10.54..2.10.55

<!-- git log 2.10.54..2.10.55 -no-merges -format='[%h](https://github.com/dcache/dcache/commit/%H)%n:   %s%n' -->

[940029f](https://github.com/dcache/dcache/commit/940029f0bdcf5121efe03cfe79d26a42c84263c0)
:   [maven-release-plugin] prepare release 2.10.55

[f3a19ff](https://github.com/dcache/dcache/commit/f3a19ffc5b7157093e14ab247266bbeaebd8268b)
:   chimera: Alter statistics target for t_tags(itagid)

[6a2f876](https://github.com/dcache/dcache/commit/6a2f876c6d7499f969ad12cf527c4786e26ce7bd)
:   srm: Add safe-guard against invalid file ID in put requests

[e05f2b0](https://github.com/dcache/dcache/commit/e05f2b0c69c82bb492548adfad8bca32fc5a89f0)
:   pool: Don't consider failure to find migration job a bug

[d9503fe](https://github.com/dcache/dcache/commit/d9503feae74e2ba23468fc4cd276cbbe1e58e14a)
:   statistics: encode '/' in filenames

[194d2af](https://github.com/dcache/dcache/commit/194d2af257e8356fdf6fee0ce4d2600f9eb59e55)
:   [maven-release-plugin] prepare for next development iteration

## Release 2.10.54

### nfs

Pinning files is now a non-blocking operation. For files stored on tape, this should result in a more responsive system behaviour, avoiding NFS blocking in situations with many concurrent pin requests.


### Changelog 2.10.53..2.10.54

<!-- git log 2.10.53..2.10.54 -no-merges -format='[%h](https://github.com/dcache/dcache/commit/%H)%n:   %s%n' -->

[c27ed41](https://github.com/dcache/dcache/commit/c27ed41511b109fa597a98d9a126260d448a4c8d)
:   [maven-release-plugin] prepare release 2.10.54

[7b3c317](https://github.com/dcache/dcache/commit/7b3c317ebc9257bc84b1cd7de1877bf8334d0941)
:   adapted commit 3eab402754b814f681a14d296d808031b05f2737 for 2.10 branch

[e83c140](https://github.com/dcache/dcache/commit/e83c1403bf3bdea51098497cb2e6faa37a83458f)
:       nfs: use noitify instead of blocking sendAndWait when          sending pin/unpin messages via touch ".(get)(<file_name>)(pin)"          command

[c00a14b](https://github.com/dcache/dcache/commit/c00a14b67964d1b2e8042ef6665539c3095cc629)
:   [maven-release-plugin] prepare for next development iteration

## Release 2.10.53

### Changes affecting multiple services

Sometimes when a cell start up was interrupted an error message was logged as a bug. This is now fixed.  

### info-provider

The GLUE infomation provider supplies information about the dCache instance, which is important for the clients in WLCG area.
Because in dCache different doors can have different roots, clients may need to adjust their path when accessing dCache through different doors.
The info-provider is updated so that a new **path root**  property is provided.  This allows clients to modify paths, as necessary.  Note that
the SRM door already supports this translation when redirecting clients for transfers.


### Changelog 2.10.52..2.10.53

<!-- git log 2.10.52..2.10.53 -no-merges -format='[%h](https://github.com/dcache/dcache/commit/%H)%n:   %s%n' -->

[627dfda](https://github.com/dcache/dcache/commit/627dfdaa6f5ee4654c7cb4b25f1e9ac85ab37f5b)
:   [maven-release-plugin] prepare release 2.10.53

[1e40f5f](https://github.com/dcache/dcache/commit/1e40f5f7f10667c22d041362a0e8187602ebdb94)
:   info-provider: publish door root path

[902503e](https://github.com/dcache/dcache/commit/902503e0cfc27cbf5a7c09be14f565915d16b2ff)
:   cells: Suppress illegal state exception during initialization

[8e7fbb8](https://github.com/dcache/dcache/commit/8e7fbb84b35ebc3d409952828f6427c2c9f695a4)
:   [maven-release-plugin] prepare for next development iteration

## Release 2.10.52

### pool

Revert Netty version back to v3.9.9.  A previous release upgraded the
version of Netty, but this appears to have introduced problems for
some HTTP transfers where the pools run out of memory.

### spacemanager

Spacemanager backs off when it encounters a problem writing to the
database.  Previously, if the problem was due to deadlocks then the
two tasks involved are delayed by the same amount, which means it is
possible that subsequent attempt will also deadlock.  This release
randomises the delay to reduce the likelihood of this problem
occuring.


### Changelog 2.10.51..2.10.52

<!-- git log 2.10.51..2.10.52 -no-merges -format='[%h](https://github.com/dcache/dcache/commit/%H)%n:   %s%n' -->

[770e638](https://github.com/dcache/dcache/commit/770e638063cbcb1ce83d04678916a8c625511eea)
:   [maven-release-plugin] prepare release 2.10.52

[985cbae](https://github.com/dcache/dcache/commit/985cbae610e69b45f307fa84bc135a531c86db4e)
:   pool: revert Netty back to v3.9.9

[b3edbfc](https://github.com/dcache/dcache/commit/b3edbfca66d5e84bac9273069ede24e312fec44c)
:   spacemanager: Randomize backoff in case of transient errors

[82c9902](https://github.com/dcache/dcache/commit/82c9902700ce292a4f1482a53dfd55e8f0e959aa)
:   [maven-release-plugin] prepare for next development iteration

## Release 2.10.51

### xrootd

Fix dCache handling of open requests where uploads were considered
downloads.


### Changelog 2.10.50..2.10.51

<!-- git log 2.10.50..2.10.51 -no-merges -format='[%h](https://github.com/dcache/dcache/commit/%H)%n:   %s%n' -->

[cf8c162](https://github.com/dcache/dcache/commit/cf8c16233b17643e3bffec4a08e37efd71ffefe5)
:   [maven-release-plugin] prepare release 2.10.51

[bd1bf66](https://github.com/dcache/dcache/commit/bd1bf669726bc72874776c9f7535dd119dd0cfbc)
:   xrootd: Fix classification of uploads

[94f6494](https://github.com/dcache/dcache/commit/94f6494e0f4579bf097d55913a100226fe3221a9)
:   [maven-release-plugin] prepare for next development iteration

## Release 2.10.50

### Changes affecting multiple services

Don't log `Error while reading from tunnel:
java.nio.channels.AsynchronousCloseException` when a domain shuts
down.


### Changelog 2.10.49..2.10.50

<!-- git log 2.10.49..2.10.50 -no-merges -format='[%h](https://github.com/dcache/dcache/commit/%H)%n:   %s%n' -->

[a13edb1](https://github.com/dcache/dcache/commit/a13edb12650736c6143d53192c3bf7e11bd11c91)
:   [maven-release-plugin] prepare release 2.10.50

[2e55290](https://github.com/dcache/dcache/commit/2e55290f46c32645ee0d50e13298962b94763684)
:   cells: Don't log AsynchronousCloseException when tunnel closes

[3baf68f](https://github.com/dcache/dcache/commit/3baf68f4b9469fd10f822a4960f143c1e500e1a9)
:   [maven-release-plugin] prepare for next development iteration

## Release 2.10.49

### Changes affecting multiple services

Update the Spring, Milton, AspectJ, Jetty and DataNucleus-core
libraries to latest version.  All dCache services are affected.

### pool

If a 3rd-party transfer fails then the pool may log and report
incomplete information on why this happened.  This release fixes this
problem.


### Changelog 2.10.48..2.10.49

<!-- git log 2.10.48..2.10.49 -no-merges -format='[%h](https://github.com/dcache/dcache/commit/%H)%n:   %s%n' -->

[b107659](https://github.com/dcache/dcache/commit/b1076590bd3ff13be9d264ac09d7eb591e2c20f2)
:   [maven-release-plugin] prepare release 2.10.49

[52b890a](https://github.com/dcache/dcache/commit/52b890a6be26a99c6b1bedf1f322d0f542c7d04a)
:   2.10: upgrade third party dependencies

[8fa4aa4](https://github.com/dcache/dcache/commit/8fa4aa449c045ffa6bad211a63b867fac11f7f75)
:   http-3rd-party: ensure IOException logged with toString

[f5bba65](https://github.com/dcache/dcache/commit/f5bba65838a50131bce34d392485b540380db3a8)
:   info: fix test to be less critical on timing

[5047e84](https://github.com/dcache/dcache/commit/5047e84df3d400e866a55a5d3864793582cdb98d)
:   [maven-release-plugin] prepare for next development iteration

## Release 2.10.48

### nfs

Report EOF when client undertakes mixed read/write workload and
attempts to read beyond currently written data.

### poolmanager

Previous releases of dCache contained a bug where replicas generated
by pool-to-pool copies failed to include the access latency and
retention policy.  While not directly affecting dCache operations, the
result is that this information is no longer reliable.

### spacemanager

Fix listing by PNFS-ID.  Glob support is removed as it was
non-functional.


### Changelog 2.10.47..2.10.48

<!-- git log 2.10.47..2.10.48 -no-merges -format='[%h](https://github.com/dcache/dcache/commit/%H)%n:   %s%n' -->

[6cd514d](https://github.com/dcache/dcache/commit/6cd514d0effa2c767e775882c8daef7511343696)
:   [maven-release-plugin] prepare release 2.10.48

[4422057](https://github.com/dcache/dcache/commit/44220577dc5685a05660625b966c392b9c4513ee)
:   poolmanager: Fix missing access latency and retention policy on pool to pool copy

[05f9430](https://github.com/dcache/dcache/commit/05f94307738d95c68bd7a3261771b8c73959dfb7)
:   spacemanager: Fix listing by pnfs id

[f6aada3](https://github.com/dcache/dcache/commit/f6aada3fe39768e8febc34745085ce84da7b6670)
:   [maven-release-plugin] prepare for next development iteration

[761dd30](https://github.com/dcache/dcache/commit/761dd3050617e8f7a24304827e27c60208b70d8e)
:   nfs-proxy: keep track of written bytes

## Release 2.10.47

### Changes affecting multiple services

This release fixes a caching issue where changes to inode metadata
(e.g., ownership or permissions) for `/` (the root directory of
Chimera) are not visible until the service is restarted.  This affects
NFS doors and pnfsmanager service.


### Changelog 2.10.46..2.10.47

<!-- git log 2.10.46..2.10.47 -no-merges -format='[%h](https://github.com/dcache/dcache/commit/%H)%n:   %s%n' -->

[69ef1b6](https://github.com/dcache/dcache/commit/69ef1b615fef9257c76823c6e1a25b54ef026248)
:   [maven-release-plugin] prepare release 2.10.47

[c54b8b5](https://github.com/dcache/dcache/commit/c54b8b575642d890a34b327cbd5f278950bb4eed)
:   chimera: Prevent filling of stat cache of root inode

[15012ac](https://github.com/dcache/dcache/commit/15012ac52bdcd94c469d1bd6f29820db264bb4a8)
:   [maven-release-plugin] prepare for next development iteration

## Release 2.10.46

### Changes affecting multiple services

The chimera library, used by PnfsManager and NFS, contains possible
race conditions that can lead to a NullPointerException.  These are
updated so that Chimera gives the correct error message under these
circumstances.

The chimera library, used by the pnfsmanager and nfs services,
contains a bug where two near-simultaneous attempts to delete a
hitherto empty directory and write a file into the same directory will
both succeed but leave an orphaned file: it exists in the `t_dirs`
table but the parent does not exist in `t_inodes` table.  This seems
to be triggered when an ftp door fails with `no write pool
configured`.  This release fixes this problem.

### pnfsmanager

Fix the error message (logged by the domain hosting pnfsmanager) if an
attempt to finalise an SRM upload fails within pnfsmanager, or if an
attempt to cancel an SRM upload fails within pnfsmanager.

### webdav

Update to the latest version of milton.

### xrootd

Update the `alice-token` plugin to allow the host name check to
succeed on dual-stack (IPv4 and IPv6) machines.


### Changelog 2.10.45..2.10.46

<!-- git log 2.10.45..2.10.46 -no-merges -format='[%h](https://github.com/dcache/dcache/commit/%H)%n:   %s%n' -->

[7b4db8b](https://github.com/dcache/dcache/commit/7b4db8b2d109e5ef53b85a0288b2439947c775ff)
:   [maven-release-plugin] prepare release 2.10.46

[06416d1](https://github.com/dcache/dcache/commit/06416d1aa8a79cd1b4e5b6145a3a3dc10087a53f)
:   xrootd: Update alice token plugin to fix IPv6 compatibility

[6540fed](https://github.com/dcache/dcache/commit/6540feddd9f1f265ed17c7d4a1b02737c5f672e1)
:   chimera: Detect races in directory deletion

[5e4d00b](https://github.com/dcache/dcache/commit/5e4d00ba75b00d01128bd7659294e474f7b2a6ea)
:   chimera: Detect races during move

[6d150cb](https://github.com/dcache/dcache/commit/6d150cb238f1691123e550b8ac85f08d2ef1accc)
:   webdav: update to latest milton

[5b065e8](https://github.com/dcache/dcache/commit/5b065e82d53a5154d593656f015c970f97a1e4c5)
:   PnfsManager: remove copy-n-paste error in error message

[96a2000](https://github.com/dcache/dcache/commit/96a200013bf9fdddcefff142b515d5e1e340111d)
:   system-test: Fix grid-security settings

[2386c80](https://github.com/dcache/dcache/commit/2386c8030388a054972c3a18f8945591b1e060b4)
:   rpm: enforce SL5 compatibility when building RPM packages

[948023b](https://github.com/dcache/dcache/commit/948023b88fd1cadeb4587c580a577a67d7b46275)
:   [maven-release-plugin] prepare for next development iteration

## Release 2.10.45

### Changes affecting multiple services

Eliminate race condition that can lead to a NullPointerException if a
cell does not shut down cleanly.

The `dcache` script no longer checks whether the `hostkey.pem` file is in
PKCS#8 format when `dcache stop` is invoked.  Previously this could lead
to orphaned dCache domains; for example, when upgrading dCache RPM.

### admin

Fix potential IndexOutOfBoundsException should the response from the
`acm` cell be malformed.

### pnfsmanager

Contribution from Kurchatov: update the ChimeraCleaner to work-around
the Java compiler's inability to produce compatible Java 7 binaries
when compiling with JDK 8.  **Note**: sites using official dCache.org
packages do NOT need to upgrade as a result of this change.

### pool

Fix an intended pool-to-pool transfer optimisation: the receiving pool
failed to reuse a delayed mover, should the pool-to-pool request
timeout and be retried.

Fix pools so that they do not log NullPointerException if a pool
receives a request to restore a file from an HSM to which it has no
access.

### Scripts

Fix how the `writedata` command in the `chimera` shell accepted data:
the command-line argument was ignored if supplied and data was taken
from stdin, if no argument was supplied then the command would fail
with NullPointerException.  ***Note***: this command does NOT write
data into dCache, but into Chimera.

### srm

Fix the context information included when logging failures to write
job information to the database.


### Changelog 2.10.44..2.10.45

<!-- git log 2.10.44..2.10.45 -no-merges -format='[%h](https://github.com/dcache/dcache/commit/%H)%n:   %s%n' -->

[f0cd764](https://github.com/dcache/dcache/commit/f0cd76472e20b5ced0e23bd3eff4c74643992984)
:   [maven-release-plugin] prepare release 2.10.45

[03207f3](https://github.com/dcache/dcache/commit/03207f3f5f2a2563d3fdd3b5c5cc52db8a192a0d)
:   srm-client, dcache: fixed passing incompatible arguments to functions

[049be02](https://github.com/dcache/dcache/commit/049be02239affc16c1bd828e00904ddc0c0eb5da)
:   dcache: removed unecessary use of non-short-circuit logic

[6212e25](https://github.com/dcache/dcache/commit/6212e2597dd769bdaaac005a24377f3074ea9713)
:   pool: Fix NPE when restoring file

[21b618f](https://github.com/dcache/dcache/commit/21b618f0078cb6c5cb1d22c19e20fec39ed479ad)
:   ChimeraCleaner: reallow to be compiled/run on different Java versions

[bc2c0da](https://github.com/dcache/dcache/commit/bc2c0da77ba584ac506cb819326db88aa82be484)
:   scripts: do not check for PKCS#8 formatted hostkey.pem on shutdown

[3f10a11](https://github.com/dcache/dcache/commit/3f10a11c9d0e86c959b7af9fb6a99e3629ad35b2)
:   chimera: Null value passed to non-null parameter in org.dcache.chimera.cli.Shell$WriteCommand.call()

[434b345](https://github.com/dcache/dcache/commit/434b34587312d9e96d8ee276c4a0baa433148ce3)
:   srm: Use correct logging context when saving jobs

[5d75167](https://github.com/dcache/dcache/commit/5d75167ab8e8351c0f254ae4448474d485abb15b)
:   cells: Fix NPE during shutdown

[3d7d49e](https://github.com/dcache/dcache/commit/3d7d49e322f34c7ef1292886853ca6b627d79f4f)
:   [maven-release-plugin] prepare for next development iteration

## Release 2.10.44

### Changes affecting multiple services

When starting up, all doors (dcap, ftp, nfs, srm, webdav, xrootd) and
pools advertise their presence to other dCache components before they
are able to handle incoming requests.  This can lead to subsequent
queries timing out as the service finishes starting up.  With this
version of dCache, doors and pools only advertise their presence once
they can handle incoming requests.

### pool

This release updates how dCache configures the Berkeley DB when used
for storing pool metadata.  In addition, dCache will now no longer
disable the pool when suffering a Berkeley DB-related problem if the
Berkeley DB environment is still valid.  Combined, these two changed
should greatly reduce the occurances of pools disabling themselves
when under heavy IO load.


### Changelog 2.10.43..2.10.44

<!-- git log 2.10.43..2.10.44 -no-merges -format='[%h](https://github.com/dcache/dcache/commit/%H)%n:   %s%n' -->

[92d00ca](https://github.com/dcache/dcache/commit/92d00ca6fbd1f794e6041a8e9b2e818c8b019322)
:   [maven-release-plugin] prepare release 2.10.44

[56cd33a](https://github.com/dcache/dcache/commit/56cd33a69f7e4bd2c712e9b370f321feb772cd8e)
:   pool: Refine Berkeley DB failure handling

[7253888](https://github.com/dcache/dcache/commit/7253888cea5848ea772eaba6de203cc30b41a198)
:   Don't announce cells to other services until they have started

[2e2680a](https://github.com/dcache/dcache/commit/2e2680a6603e53bc6302ad8c7fd7279e2cd0d075)
:   [maven-release-plugin] prepare for next development iteration

## Release 2.10.43

### Changes affecting multiple services

The `ftp`, `webdav` and `xrootd` doors will delete the target file if
an upload was unsuccessful.  The copy manager (part of the
`transfermanagers` service) has a similar behaviour if an internal
copy is unsuccessful.  If this delete was unsuccessful (e.g., the
client deleted the file itself) previous dCache versions would log
this at `ERROR` level.  With this dCache version, such occurrences are
logged at `DEBUG` level.

### nfs

Fix race condition that can occur when a pool is first accepting pNFS
transfers if multiple requests are processed almost simultaneously.

### webdav

The webdav door has separate configuration allowing the admin to
configure the door-local path that contains site-local files and the
URI prefix to access those files.  Earlier versions of dCache
mistakenly used the former for the latter, which this release fixes.


### Changelog 2.10.42..2.10.43

<!-- git log 2.10.42..2.10.43 -no-merges -format='[%h](https://github.com/dcache/dcache/commit/%H)%n:   %s%n' -->

[1d3e3ad](https://github.com/dcache/dcache/commit/1d3e3ad014cd5a7d42637e12ed3f4f6b37f0b424)
:   [maven-release-plugin] prepare release 2.10.43

[f74cb79](https://github.com/dcache/dcache/commit/f74cb7932b2eb37b322469b9012d4be6e73ffd33)
:   Revert "webdav: Add robots.txt"

[1b30b12](https://github.com/dcache/dcache/commit/1b30b125d7171db67671bb0488a0007b8c06e19a)
:   webdav: Respect webdav.static-content.uri property

[cf20217](https://github.com/dcache/dcache/commit/cf2021731ab31f4f969bdb008f54df2e68ac9f8a)
:   doors: Do not log failure to delete absent files on upload failures:

[d4d8283](https://github.com/dcache/dcache/commit/d4d82834072faf7919ee281add232e4a91e1a95f)
:   nfs4: fix race in request processing

[afddd5b](https://github.com/dcache/dcache/commit/afddd5b8d6c41b413d2872bde80ef4e73e1c16fd)
:   webdav: Add robots.txt

[e066291](https://github.com/dcache/dcache/commit/e0662910b69ddc5db73093245871f7351d20a867)
:   [maven-release-plugin] prepare for next development iteration

## Release 2.10.42

### dcap

Doors describe their root path to SRM so it can calculate appropriate
TURLs.  Previous versions of dCache had dcap doors register incorrect
paths, which this release fixes.

dCache configuration allows an admin to control if certain ciphers are
allowed.  In particular, this allows sites to remove support for
problematic ciphers or hashing algorithms.  This release fixes a
problem where the GSI-dcap door failed to honour such settings.

### pool

The replica-manager periodically requests a list of file replicas that
a pool is hosting.  In previous versions of dCache, if the pool finds
a broken file then an error is returned to replica-manager.  The
replica-manager then considered the entire pool as being offline.
With this version od dCache, such errors are logged on the pool.  The
replica-manager will not consider the pool as hosting that file's
data, but will otherwise consider the pool online.

The different HSM operations (flush, stage and remove) have internal
timeouts after which the pool considers the request as failed.  In
previous versions of dCache, the default pool setup includes a four
hour timeout for flush and stage but neglected to set a default for
delete.  This omission caused delete operations to time-out very
quickly. With this release, delete operations also have a default of
four hours.

Fix the Ruby implementation of the hsmcp script (`hsmcp.rb`) so it can
parse new command-line arguments that include concurrency options.

The concurrency for active HSM operations is configurable and may be
adjusted dynamically.  In earlier versions of dCache, decreasing the
concurrency only became effective when that operation started to idle.
This has been fixed so the limits start to have an effect as
operations complete.

Each movers can have one of three priority (LOW, MEDIUM, HIGH) and a
selection discipline (FIFO or LIFO).  The documented behaviour was for
queue with names that start with `-` have LIFO discipline and those
that start with any other character have FIFO discipline.  Due to a
bug, the order was wrong, with the priorities inverted and the two
disciplines swapped, so LOW priority movers were started before MEDIUM
level and MEDIUM were started before HIGH.  This release fixes this so
HIGH priority movers are selected preferentially over MEDIUM and,
MEDIUM priority movers are chosen over LOW priority; however, it was
decided to keep the disciplines as in previous versions and updated
the documentation accordingly.  There are several reasons for this:
first, there is no difference between LIFO and FIFO when movers are
not queued; second, neither discipline will help if the pool is
persistently overloaded; third, LIFO discipline (although unfair) is
documented as providing a better overall throughput during a
time-limited overload; fourth, by default dCache has been running with
LIFO discipline since v1.9.11 (released 2011-01-13) without any
apparent problems.

HTTP third-party transfers report back if there was a problem
verifying that the transfer was successful.  One possible problem is
that the remote server failed to supply checksum information.
Reporting of such situations is now fixed.

### webdav

In previous versions of dCache, should a user cancel a transfer
shortly after a mover is created then there was a risk that the mover
is abandoned.  This is fixed with this release.

### xrootd

In earlier versions of dCache, if the xrootd door times out for a
write request while waiting for the mover to send the redirection
information then the mover is abandoned.  This is fixed with this
release.


### Changelog 2.10.41..2.10.42

<!-- git log 2.10.41..2.10.42 -no-merges -format='[%h](https://github.com/dcache/dcache/commit/%H)%n:   %s%n' -->

[ade3c9b](https://github.com/dcache/dcache/commit/ade3c9bc5bfd3d991fa32c895a9c8845640f5126)
:   [maven-release-plugin] prepare release 2.10.42

[4710de1](https://github.com/dcache/dcache/commit/4710de1c882161d54b4803751793810e5f35bed2)
:   hsmcp: update to match new HSM interface.

[abf2356](https://github.com/dcache/dcache/commit/abf23563696d636f5a27682c386fe631b1b1d63a)
:   (2.10) old replica manager: prevent pool being listed as offline when there are files with corrupt metadata

[524026d](https://github.com/dcache/dcache/commit/524026d0a6328f1578089832edc764675f61d75b)
:   webdav: Kill abandoned movers

[64b14ef](https://github.com/dcache/dcache/commit/64b14ef86e6bd2aa73ed6e16e3d9df77b24c2aa0)
:   xrootd: Kill mover on aborted write

[7d25a32](https://github.com/dcache/dcache/commit/7d25a32edd5f5707a4e1a9aa5240a3bea35048a5)
:   pool: Fix transfer prioritization

[f3082be](https://github.com/dcache/dcache/commit/f3082be6809d2fb56f478d4965aa362023cace74)
:   pool: Add nearline storage default timeouts

[b9ab9bd](https://github.com/dcache/dcache/commit/b9ab9bdb44851e5bc7f2093a47fe44d9512c6ce4)
:   pool: Let script nearline storage provider scale down when lowering limits

[9b110dc](https://github.com/dcache/dcache/commit/9b110dc3e5ef650f50862b3d05e6aabcdb0b6743)
:   dcap: Fix broken argument parsing

[a07edc5](https://github.com/dcache/dcache/commit/a07edc51a01cd8f6791023dc14174aadfc5d74e3)
:   dcap: Fix socket factory argument parsing

[75c5e85](https://github.com/dcache/dcache/commit/75c5e856cc1f18065946617a700c86850d04b73a)
:   pool: Fix error reporting in remote HTTP mover

[1c08f8c](https://github.com/dcache/dcache/commit/1c08f8c8b65c343cca88cc9daf6093f5f16a8ede)
:   prepare for next development iteration

## Release 2.10.41

### srm

Fix security vulnerability in srm
[EGI-SVG-2015-9495](https://wiki.egi.eu/wiki/SVG:Advisory-SVG-2015-9495)
(restricted).

## Release 2.10.40

### Changes affecting multiple services

Fix a performance regression when deleting directories; the fix
affects the pnfsmanager and nfs services.

In many cases, poolmanager would timeout after ten seconds when asked
which pool to use for a transfer.  This behaviour was not intended.
The consequence of this bug is protocol specific: for some protocols,
the door retries internally while other doors propagate this error to
the client.  Another consequence was the increased risk of the domain
hosting poolmanager running out of memory, particularly when staging
files.  This release fixes the underlying problem.  It is recommended
that all doors be upgraded.

### spacemanager

Fix bug that can result in leaked entries in space-manager file
management from failed uploads.  The problem is most likely triggered
when a client cancels an FTP upload at the same time as the
correponding SRM upload request expires.  The problem may also be
triggered by communication failure with PnfsManager and the user
deleting the failed upload before the pool retries.


### Changelog 2.10.39..2.10.40

<!-- git log 2.10.39..2.10.40 -no-merges -format='[%h](https://github.com/dcache/dcache/commit/%H)%n:   %s%n' -->

[e420596](https://github.com/dcache/dcache/commit/e420596b6af28d699242dbf64873bc07df3ad4b7)
:   [maven-release-plugin] prepare release 2.10.40

[c67c041](https://github.com/dcache/dcache/commit/c67c04187fbb0c7892e937a2832a285e5d4e05d5)
:   spacemanager: Fix race condition leading to leaked reservation entries

[5dbfa08](https://github.com/dcache/dcache/commit/5dbfa0824f4a5653170012684c0876e12d1842cb)
:   chimera: Resolve performance regression in directory deletion

[b022089](https://github.com/dcache/dcache/commit/b0220896caea8f943fc90983c0debe183fecd7ac)
:   doors: Fix pool selection timeout handling

[fc881e4](https://github.com/dcache/dcache/commit/fc881e426b2a77ce4181df633720c1c4c513e93d)
:   Fix timeout math to avoid overflow

[b77a047](https://github.com/dcache/dcache/commit/b77a047f791e4999d7f04b052f1cbd808e8f59ff)
:   Preparing for next release cycle

## Release 2.10.39

### ftp

Fix security vulnerability in `gsi` and `kerberos` authenticated ftp.

## Release 2.10.38

### Changes affecting multiple services

The `System` cell of each domain contains a `version` command that
allows discovery of which dCache version is running.  This release
fixes this command.  **Note:** there is no problem with the `dcache`
script's `version` command.

### nfs

The NFS protocol provides access to additional infomation through dot
commands.  This release fixes the `nameof` and `pathof` commands for
non-ASCII filenames.

### pnfsmanager

Fix that dCache respects the setgid bit on a parent directory when the
user uploads a file via the SRM protocol.  **Important:** the srm node
should be updated at the same time.

### srm

Enforce authorisation of requests to finalise or cancel an upload.
When initiating an upload, the user's uid and primary gid are taken as
the request owner-uid and owner-gid respectively.  Only users that
have the same uid as the request's owner-uid or are a member of the
request's owner-gid are allowed to cancel or finalise an upload.
**Important:** the `srm` must be updated if the `pnfsmanager` is
updated.

### webadmin

This release fixes a bug with the periodic building of billing plots.
Previously, if the billing service took too long to reply then there
would be no further updates to the billing plots.


### Changelog 2.10.37..2.10.38

<!-- git log 2.10.37..2.10.38 -no-merges -format='[%h](https://github.com/dcache/dcache/commit/%H)%n:   %s%n' -->

[a2c9f0c](https://github.com/dcache/dcache/commit/a2c9f0c1c5e00e693704e476b5a544838d8252a9)
:   [maven-release-plugin] prepare release 2.10.38

[5feb45b](https://github.com/dcache/dcache/commit/5feb45ba617d4625ad16b98f1ca6ed96a0ea16a2)
:   rpm: remove "commented out" macros lines from spec file

[511e4fe](https://github.com/dcache/dcache/commit/511e4fee921ebfb230db1b63eedb6842175db062)
:   chimera: fix nameof and pathof for paths containing unicode

[dacd102](https://github.com/dcache/dcache/commit/dacd1023acd75e8e85b542567aa44ae4b55afca2)
:   chimera: Let SRM respect setgid on upload

[ec811ad](https://github.com/dcache/dcache/commit/ec811ad6e5fa16e4ff85b4050e798a175441b41e)
:   srm: Add authorization to put done and abort requests

[f2f1f44](https://github.com/dcache/dcache/commit/f2f1f44329ec957d4c0e5cf44c689c3e1ea57f2f)
:   module: cells

[bc0f510](https://github.com/dcache/dcache/commit/bc0f510f726b2a747152b10804ec01f0c6b05a8d)
:   (2.10) dcache-webadmin: add TimeoutCacheException to catch clause in billing service

[ecc0aed](https://github.com/dcache/dcache/commit/ecc0aed2b89b5211f45dc66ecd78feb6d71250c8)
:   [maven-release-plugin] prepare for next development iteration

## Release 2.10.37

### Changes affecting multiple services

Specifying the `DISABLE_BROKEN_DH` flag in the `dcache.authn.ciphers`
configuration property disables all Diffie-Hellman ciphers if Java 7
is used; if dCache is run with Java 8 then this flag has no effect.
Disabling DH ciphers is necessary because Java 7 contains a broken
implementation of Diffie-Hellman, which was fixed with the release of
Java 7 update 51.  This dCache release updates the behaviour of the
`DISABLE_BROKEN_DH` flag to allow Diffie-Hellman ciphers if dCache is
run within Java 7 update 51 or later.

The description of the `DISABLE_EC` and `DISABLE_RC4` flags have been
expanded and updated.

### infoprovider

An earlier patch added support for publishing a single dCache instance
with multiple SRM endpoints.  This provided incompatible with sites
that use a DNS alias for their official SRM endpoint, so that change
is reverted with this release.  Support for publishing multiple SRM
endpoints is available with dCache v2.13.

### nfs

Add support for the `TEST_STATEID` and `FREE_STATEID` RPC methods.
These are used by the Linux kernel during recovery procedure.  The
previous lack of support for these methods can lead to the leaking of
stateids, which can lead to `NFS4ERR_RESOURCE : Too many states` being
logged.

### pool

Improve the error message (logged by the pool and in billing) should
the FTP mover fail to connect to the client.

This release updates the error the pool reports to an NFS client when
the client attempts to read or write and the pool cannot find the
mover.  This situation is mostly likely caused by restarting the pool.
When it receives the modified response, the client will fall back to
using proxy-IO.  This allows NFS clients that were reading a file to
survive a pool restart.


### Changelog 2.10.36..2.10.37

<!-- git log 2.10.36..2.10.37 -no-merges -format='[%h](https://github.com/dcache/dcache/commit/%H)%n:   %s%n' -->

[09b0d9d](https://github.com/dcache/dcache/commit/09b0d9de4d559f34786e89e8ff49f17feec5e250)
:   [maven-release-plugin] prepare release 2.10.37

[22bc8dd](https://github.com/dcache/dcache/commit/22bc8dd19e9879d07495b5678227ace971869a09)
:   pool: fix ftp mover to provide better logging when failing to connect

[364d627](https://github.com/dcache/dcache/commit/364d627916185b3a393489888e3f3056dc86f48e)
:   crypto: refine handling of broken ciphers

[2a76e9a](https://github.com/dcache/dcache/commit/2a76e9a7bd3eab29114382dbc5259ee02b2eff69)
:   Revert "infoprovider: remove single SRM instance limitation"

[2d3dfa2](https://github.com/dcache/dcache/commit/2d3dfa21c8ff76bc7dfd158f09652bc08e860571)
:   libs: update to nfs4j-0.9.7

[354a7d6](https://github.com/dcache/dcache/commit/354a7d662c426cc66411cbff4a8242e5aeff12af)
:   pool: report IO error if we cant find NFS mover

[7957f75](https://github.com/dcache/dcache/commit/7957f7531da9b2b2a48b55a4a480351f66396fb0)
:   [maven-release-plugin] prepare for next development iteration

## Release 2.10.36

### Changes affecting multiple services

The event logger records when messages are received and sent by cells.
Some cell messages send string commands; if so, the log entry contains
that string.  In previous releases, such string commands were
mistakenly double-escaped.  This is fixed with this release.

### ftp

Fix debug output to include the flavour of GSS implementation; for
example, `GssFtpDoorV1::secure_reply: going to authorize using k5`

### pnfsmanager

When a user attempts to delete a symbolic link using a non-NFS door,
previous versions of dCache would resolve the symbolic link to
determine whether the user is allowed to delete the symblic link: only
if the user is allowed to delete the symblic link's target would the
symbolic link be removed.  With this release, the check verifies if
the user is allowed to delete the symbolic link instead.

### pool

This release updates the JVM command-line to make it explicit that
compressed object references are in use.  This allows the Berkeley DB
library to calculate a more accurate cache size, potentially improving
pool performance.

In previuos releases, any attempt is made to query a pool's info
(e.g., via the admin interface) while the pool is initialising will
block until the initialisation has completed.  This has a knock-on
effect of blocking all subsequent messages.  With this release,
requesting information about a pool will not block during
initialisation.

Fix high memory usage during pool initialisation if pool has any
precious files.

### xrootd

Earlier releases will record a stack-trace if xrootd recieves a
malformed request.  This is now fixed.


### Changelog 2.10.35..2.10.36

<!-- git log 2.10.35..2.10.36 -no-merges -format='[%h](https://github.com/dcache/dcache/commit/%H)%n:   %s%n' -->

[46cc3fd](https://github.com/dcache/dcache/commit/46cc3fda70aad4309e69c510178b234192274a18)
:   [maven-release-plugin] prepare release 2.10.36

[052822f](https://github.com/dcache/dcache/commit/052822f86a6c8f0e0a4b7a81d8cf4ff804dd42cc)
:   cell: Don't quote string command in event logger

[ca11c50](https://github.com/dcache/dcache/commit/ca11c503428be79763387c69f401359626ffbd5c)
:   pool: Explicitly enable compressed oops to calculate correct cache size

[70a70e1](https://github.com/dcache/dcache/commit/70a70e1194d8105e597fb853fcdd4b152fa1e100)
:   pool: Fix locking bug causing high memory usage during pool initialization

[c781e18](https://github.com/dcache/dcache/commit/c781e182d752da2a9ee377311496165ceb443796)
:   chimera: Fix path resolution on delete

[f3007c3](https://github.com/dcache/dcache/commit/f3007c38db8510118015f177af72aa5087139380)
:   xrootd: Fix 'xrootd logs stack-trace on malformed request'

[1b70957](https://github.com/dcache/dcache/commit/1b70957dafa3e67628fa869c9c5d8b4fccae7b9a)
:       move execution of the superclass method before any concrete class initializations

[b87523b](https://github.com/dcache/dcache/commit/b87523b0dfef2b1dedc275e724f815469421fbc3)
:   pool: do not list a repository during initialization

[a5c220a](https://github.com/dcache/dcache/commit/a5c220a886037068ad37745f7df7a490f8fe12c8)
:   [maven-release-plugin] prepare for next development iteration

## Release 2.10.35

### pool

The Berkeley DB based metadata storage can sometimes fail.  Should
this happen, the pool must be restarted.  In previously releases, such
problems were logged with an unclear message and a stack-trace; the
pool would continue to operate but would fail all subsequent
transfers; nothing made it clear the pool must be restarted.  With
this release, such Berkeley DB problems will be logged with a concise
error message and the pool will be disable, making the restart
requirement explicit.

### srm

In previous versions of dCache, the `ls` operation in SRM occationally
returned incomplete or inconsistent results.  This is now fixed.


### Changelog 2.10.34..2.10.35

<!-- git log 2.10.34..2.10.35 -no-merges -format='[%h](https://github.com/dcache/dcache/commit/%H)%n:   %s%n' -->

[472479e](https://github.com/dcache/dcache/commit/472479e42885d5c7b80db583f01326c03c4dc572)
:   [maven-release-plugin] prepare release 2.10.35

[70b12c0](https://github.com/dcache/dcache/commit/70b12c0cb25f65ecaee16afc48abdf92ab040b6a)
:   srm: fix race condition in ls response

[de527be](https://github.com/dcache/dcache/commit/de527be9abd9a5679fdbc92c4b15e0ccb72d4bbf)
:   pool: Disable pool on meta data failures

[1f7f733](https://github.com/dcache/dcache/commit/1f7f7339fd68cc119b36be1ebf3a1ffee3d23330)
:   [maven-release-plugin] prepare for next development iteration

## Release 2.10.34

### Changes affecting multiple services

In previous releases, dCache required a layout file be present, even
if that file was empty.  This has two negative impacts: the `dcache stop`
(typically invoked automatically when updating a package) would not work,
nodes where only scripts (e.g., info-provider) are used would require unecessary
configuration.  With this release, a missing file generates a warning but
does not prevent the `dcache stop` command or scripts from working.  This
warning may be suppressed by setting `dcache.layout.uri` to an empty string.

### httpd

The tape related queues (flush and restore) have no maximum limit, yet
both the old web information and new webadmin show a dummy maximum value
for these queues.  This meaningless maximum value is no longer shown.

### info

The info service collects information about, amongst other things,
the interface(s) a door listens on.  This is made available in
different formats.  The URL-formatted version, used by info-provider,
always used an IP address even when a name was known.  This is now
fixed.

### infoprovider

It is possible to run multiple SRM endpoints in dCache, provided certain
restrictions are upheld.  With this release, the info-provider publishes
multiple SRM endpoints correctly.

### nfs

Some shells, when attempt to overwrite a tag's content using NFS, do so
in a way that Chimera previously failed to support.  This failure was
reported back to the user as a remote I/O error.  This release fixes this
problem.

### pool

Reduce latency when a pool processes a request to start a read mover.
This improves dCache responsiveness when a client opens a file for reading.

The NFS mover uses the file's size when processing read and write requests.
For read operations, the file size cannot change.  This release takes advantage
of this to reduce the load on the underlying filesystem.

### poolmanager

Poolmanager may attempt to create additional copies of a file, only to discover
such attempts fail because of other constraints.  This leads to the log file
containing entries like `P2P denied: already too many copies` and `P2P denied:
No pool candidates available/configured/left for p2p or file already everywhere`.
With this release, such entries are logged at info level: they no longer appear
in the log file, but are available via the poolmanager's pinboard.

### webdav

Fix proxied uploads when the client does not send the file size, either
directly or via SRM; in particular, this fixes compatibility with ARC.


### Changelog 2.10.33..2.10.34

<!-- git log 2.10.33..2.10.34 -no-merges -format='[%h](https://github.com/dcache/dcache/commit/%H)%n:   %s%n' -->

[ea62128](https://github.com/dcache/dcache/commit/ea6212833b1ab31b31f10da0bd6c261bc41f03d0)
:   [maven-release-plugin] prepare release 2.10.34

[136a382](https://github.com/dcache/dcache/commit/136a38251fb6ea43f2728e64a5cd29c69d202c2f)
:   systemtest: fix install command in credentials command

[085ef11](https://github.com/dcache/dcache/commit/085ef1136e0b6e819d21857d2fb5ea277ad301a1)
:   infoprovider: remove single SRM instance limitation

[6dcb36e](https://github.com/dcache/dcache/commit/6dcb36ea2ee4d8e06eedd7cd90437d8232af7a4a)
:   info: fix url-name to publish hostname

[3d69717](https://github.com/dcache/dcache/commit/3d69717ac6462f9e6746850bfa230e2fb0f72e81)
:   chimera: throw FileExistChimeraException if tag already exists

[7f5b622](https://github.com/dcache/dcache/commit/7f5b6227598adf9c261e2525a85f24eb9e0c8c90)
:   (2.10) webadmin: do not display numerical value for max restores or stores

[700915f](https://github.com/dcache/dcache/commit/700915fe54b8e98c69d893d52c5d62b45b11b99b)
:   boot: Don't fail on missing layout file

[c7fc663](https://github.com/dcache/dcache/commit/c7fc663f6a814f29eb7521d3f0adbe0b49268624)
:   httpd: Do now show maximum for restore and flush queues

[2291a98](https://github.com/dcache/dcache/commit/2291a98012e13eed7792ccf4626d46bf0b795c59)
:   poolmanager: Reduce log level of p2p denial

[63d5f7b](https://github.com/dcache/dcache/commit/63d5f7bb3572e30c2846e33ceddff45bb3a84a3f)
:   webdav: Fix proxied upload with chunked encoding

[c981400](https://github.com/dcache/dcache/commit/c9814006a015de5bacef89a1a972c22c0a44d1a0)
:   pool: simplify duplicate request handling

[85cf92e](https://github.com/dcache/dcache/commit/85cf92e5e7d63e187756ecc8e9ad3e44e75ddd6e)
:   [maven-release-plugin] prepare for next development iteration

[efaff21](https://github.com/dcache/dcache/commit/efaff214c28758d13eef2f2e5b0213f75a94c75b)
:   pool: reduce load on back-end file system

## Release 2.10.33

### Changes affecting multiple services

A new security configuration option allows the dCache admin to ban all
SSL/TLS ciphers that use the RC4 cipher.  RFC-7465 states services
MUST NOT accept an RC4-based cipher suite.  Adding the `DISABLE_RC4`
option to the `dcache.authn.ciphers` makes dCache compliant with
RFC-7465.  This option is not enabled by default to avoid possible
regression with clients that require the RC4 cipher.  This property
affects dcap (with GSI), ftp (with GSI), srm, webadmin, webdav (with
SSL/TLS), xrootd (GSI plugin) services.

### pnfsmanager

Fixed ACL inheritance when uploading data through SRM.  In earlier
versions of dCache, a file uploaded through SRM failed to inherit any
inheritable ACEs from the parent directory.

This release brings some modest performance improvements when creating
upload directories.  This improvement is available automatically only
to sites that have not yet upgraded to 2.10 (or later).  Sites already
running 2.10 or later can enjoy the same improvements by deleting the
upload directory (`/upload` by default) to allow dCache to recreate
it.  **Important**: deleting the upload directory will fail any
current SRM uploads; it is recommended to do this during down-time.

### pool

The pool's migration module may be invoked with different pool
selection modes: the `-select` option.  The random selection option
(`-select=random`) excludes pools that are full, but mistakenly
considers replicas that could be deleted (i.e., non-sticky cached
replicas) as part of the used space; this treats a pool as full even
when the pool has removable files.  With this release, pools that are
full but contain some cached files are potential targets for random
pool selection.

In earlier releases of dCache, the `save` command failed to record the
stage, flush and remove timeouts for nearline storage (`rh set
timeout`, `st set timeout`, `rm set timeout` respectively).  This is
now fixed.

This release introduces the `pool.mover.nfs.port.min` and
`pool.mover.nfs.port.max` configuration properties.  Previously, pools
listened on a random port between `dcache.net.lan.port.min` and
`dcache.net.lan.port.max`; the two new configuration properties take
the two `dcache...` configuration properties as default values.  Once
the pool is listening on a particular port, it will try to listen on
the same port after restarting.  If this proves impossible, another
port is selected and will be used subsequently.  **Important:** using
the same port is important as the pool listening on another TCP port
can trigger high load on the client machine.

### Scripts

Fix JAR selection when a short-lived java process is started.  This is
typically done when using one of the scripts.

### spacemanager

Fix writing into a reservation when using a protocol that does not
provide a username or FQAN; for example, when writing into dCache
using NFS and with the `WriteToken` directory tag set.  Previously
writing would fail with a `Message processing failed: null group`
message.

### srm

The srm service can generate `RemoteException` stack traces when
dCache is behaving correctly.  These are now logged at debug level and
without a stack trace.


### Changelog 2.10.32..2.10.33

<!-- git log 2.10.32..2.10.33 -no-merges -format='[%h](https://github.com/dcache/dcache/commit/%H)%n:   %s%n' -->

[d443035](https://github.com/dcache/dcache/commit/d443035db10c1e3e18632d1d691463288d227d39)
:   [maven-release-plugin] prepare release 2.10.33

[52eac62](https://github.com/dcache/dcache/commit/52eac62fc94d95551f517cdf8d9b92a3186c960f)
:   chimera: Fix merge conflict and Java 7 compatibility

[1e39414](https://github.com/dcache/dcache/commit/1e39414e17a550770cc53b6f445c01a57e736c58)
:   pool: introduce unique port number for nfs mover

[f1ec21a](https://github.com/dcache/dcache/commit/f1ec21a98326c0ac5603346d44346520f062df27)
:   pool: dedicated port range for nfs

[61caf5a](https://github.com/dcache/dcache/commit/61caf5a613e65c64fe27544202d88eedaf98ac8f)
:   pool: Store nearline storage timeouts to pool setup file

[e98b145](https://github.com/dcache/dcache/commit/e98b145dde4f729046bc896ee42992d4171f2d98)
:   pnfsmanager: Create base upload directories without tags and acls

[b5a9992](https://github.com/dcache/dcache/commit/b5a9992f16d709f6c58ee6178a84338f40087cb3)
:   pnfsmanager: Inherit ACLs on upload with SRM

[dcb821e](https://github.com/dcache/dcache/commit/dcb821ec12821bd0036bd60352bb2501508f19da)
:   chimera: Add ACL insert triggers for HSQLDB

[528d5ed](https://github.com/dcache/dcache/commit/528d5edfdb482a390a04ab3643fac91d4c518be1)
:   Fix limited class path generation

[0ed000f](https://github.com/dcache/dcache/commit/0ed000ffba6fd600c930300ad7c162651002d782)
:   pool: Let random pool selection select pools with removable files

[9248f25](https://github.com/dcache/dcache/commit/9248f254e8de65ee5c52371c8bcf9bf05dc45dc6)
:   crypto: allow banning of RC4 cipher suites

[73c07e0](https://github.com/dcache/dcache/commit/73c07e03aaac25129a04126e49ff595bbcf52fbe)
:   spacemanager: Allow unowned files in reservations

[54a6df2](https://github.com/dcache/dcache/commit/54a6df2365434daa3b80e8e0e3c1acbf08324951)
:   srm: Don't log erroneous stack trace

[9ae8661](https://github.com/dcache/dcache/commit/9ae86614f443b05e69eec8cc470284574fe0d7af)
:   [maven-release-plugin] prepare for next development iteration

## Release 2.10.32

### Changes affecting multiple services

This release upgrades the BouncyCastle version from v1.45 to v1.46.
The main motivation is to improve concurrency, so obtaining better
performance on multi-core machines.  The update affects the `xacml`
and `voms` plugins to gPlazma and any door configured to use (or that
always uses) GSI authentication: dcap, ftp and srm.  There is no
cross-dependency; domains hosting these service may be updated
independently.

### pnfsmanager

Fix possible leaked upload directory if PnfsManager takes too long to
create the upload directory.

### scripts

The `chimera` script provides both an interactive shell and the
ability to run a Chimera operation as a single command-line
invocation.  This release fixes an problem where the single Chimera
operation fails to provide the output if it is too short.

### srm

If a client releases a reservation using the SRM protocol while
another SRM client is querying for information about that reservation
then there is a risk that the reservation will appear to exist for
some 30 seconds, despite the reservation being successfully released.
This release fixes this problem.


### Changelog 2.10.31..2.10.32

<!-- git log 2.10.31..2.10.32 -no-merges -format='[%h](https://github.com/dcache/dcache/commit/%H)%n:   %s%n' -->

[c2452f6](https://github.com/dcache/dcache/commit/c2452f67f0fa1358d05295747b8233c01422af45)
:   [maven-release-plugin] prepare release 2.10.32

[4751d27](https://github.com/dcache/dcache/commit/4751d2755eed6ed763eb2033640afc0daaf9e327)
:   srm: Fix cache invalidation of space meta data

[7d4d98d](https://github.com/dcache/dcache/commit/7d4d98deef3640e3814915380558978cb06adfb5)
:   libs: Update to voms-api-java 2.0.10.1

[eeaf8cc](https://github.com/dcache/dcache/commit/eeaf8cc6b1de62e941af81daebd2b2de13c86ea8)
:   libs: use bouncycastle-1.46

[f33549d](https://github.com/dcache/dcache/commit/f33549ded503c66ecc540ef51b2336a6ede2eb9f)
:   libs: update jglobus to 2.0.6.9d

[19baddc](https://github.com/dcache/dcache/commit/19baddc1b48e0ada412e2bd66bb048a906112988)
:   chimera: Fix single command invocation of chimera utility

[277cde1](https://github.com/dcache/dcache/commit/277cde1763b1a8e29f0ccd3d707beeac6ab551d0)
:   pnfsmanager: Resolve upload directory leak caused by missing reply flag

[dd3b1ac](https://github.com/dcache/dcache/commit/dd3b1ac3dddb2574ce12ab0f42322fd021eb600f)
:   [maven-release-plugin] prepare for next development iteration

## Release 2.10.31

### Changes affecting multiple services

dCache uses a standard format to monitor the performance of various
components: in the srm door to record how quickly SRM requests are
processed (`print srm counters` command), in the nfs door and pool to
monitor NFS performance (`stats` and `nfs stats` commands,
respectively), the generic cell message monitoring (`monitoring info`
command), and pnfsmanager service (the "Statistics" section in
`info`).  This release fixes a rounding error that prevents these
statistics from including long-lived requests.

### pinmanager

The pinmanager service has the `ls` command that allows the admin to
limit the results to a specific pin or all pins against some PNFS-ID.
This release fixes listing by pin id.

### pnfsmanager

With this release, the path of automatically generated upload
directories has changed slightly to improve SRM upload performance.
Previously, these generated paths had the form `<upload>/<unique-ID>`,
where `<upload>` is the value of the `dcache.upload-directory`
configuration property (`/upload` by default) and `<unique-ID>` is
some unique value (a UUID).  With this release, these directories have
the form `<upload>/<processor-ID>/<unique-ID>`, where `<processor-ID>`
is some small integer value.  Standard-conforming clients are unaffect
by this change and no action are needed by the admin from this change.

Update pnfsmanager to avoid creating temporary directories if the srm
has already discarded the request.  This helps dCache recover more
quickly when it is overloaded from SRM uploads.

### pool

Fixed pool's erroneous interpretation of the HSM timeout (4 hours, by
default) as being from when a staging request was initially received,
rather than from when it started processing the request (by starting
the HSM script or via the new plug-in mechanism).

This release fixes how a pool's invokates the HSM script.  Previously,
the pool mistakely omitted the additional arguments that an admin may
configure the pool to include.

### replicamanager

This release fixes the `Can't clear the tables` error reported when
starting replicamanager service with certain PosgreSQL versions.

### spacemanager

Fix the `update space` admin command so it can remove any ownership
from a reservation.  The reservation's owner is allowed to release the
reservation via the SRM protocol.  If the reservation has no owner, it
may only be released through the admin interface.

### srm

The `info` admin command provides details about the srm service,
including information specifically about SRM activity that can be
processed synchronously or asynchronously: get, put, reserve-space,
ls, and bring-onling.  This information describes how many requests
are in each of the possible states, one of which is `Waiting for CPU`.
This release fixes the output of the `info` command to show the
correct `Waiting for CPU` values.

This release drastically improve srm service performance when there
are a large number (e.g., thousands) of queued requests; for example,
this brings considerable improve for bulk bring-online requests.

This release also brings improved performance when the SRM has only a
few queued requests; more specifically, when the number of queued
requests is less than or equal the number of currently unoccupied
max-inprogress slots.  For example, if dCache is not processing any
GET requests then the first `srm.request.get.max-inprogress` GET
requests are processed more quickly.

Fix the srm service switching from synchronous to asynchronous
processing when processing a bulk-requests with many files; in earlier
releases, such large requests could prevent a request from falling
back to asynchronous processing.

This release fixes the srm service so it cancels corresponding
pinmanager requests when an SRM client aborts a bring-online request.


### Changelog 2.10.30..2.10.31

<!-- git log 2.10.30..2.10.31 -no-merges -format='[%h](https://github.com/dcache/dcache/commit/%H)%n:   %s%n' -->

[a660869](https://github.com/dcache/dcache/commit/a6608692ea4e57995f03c472eb1462b1c71ffb78)
:   [maven-release-plugin] prepare release 2.10.31

[2ccd1b1](https://github.com/dcache/dcache/commit/2ccd1b1a66d4b685321cac7236f39c21f087eb4d)
:   (2.10) replica manager: fix table truncation

[27f8e91](https://github.com/dcache/dcache/commit/27f8e91553cba7fba3086306da180031177037bd)
:   common: Fix division by zero regression in gauges

[4bec44b](https://github.com/dcache/dcache/commit/4bec44b5e7ee357575ebc925c18aea9e6f550a82)
:   common: Fix rounding error in request gauge

[0208029](https://github.com/dcache/dcache/commit/0208029ab4fa0a8448f22572e0775cec0bd68848)
:   pnfsmanager: Discard upload path creation request on TTL expiration

[a4ef57a](https://github.com/dcache/dcache/commit/a4ef57ac7677e96eea2f98f4b555203c298d5b9a)
:   pnfsmanager: Use per-thread upload directory to reduce lock contention

[6a51067](https://github.com/dcache/dcache/commit/6a51067f09cf7d97e3c31dbb3ce3343d8506c41d)
:   srm: Optimize scheduler performance

[7f750bd](https://github.com/dcache/dcache/commit/7f750bdff152d1fb61230e9f661c35d540e2e702)
:   srm: Further optimize SRM scheduler

[7638d21](https://github.com/dcache/dcache/commit/7638d21412525a54cd390bbb55b49c908672566b)
:   srm: Abort pinning when cancelling bring-online requests

[3a8298d](https://github.com/dcache/dcache/commit/3a8298dc4bc0519977f8cb2dfc978e3c62d55ce6)
:   system-test: Enable MVCC and logging for HSQLDB

[37ee6d7](https://github.com/dcache/dcache/commit/37ee6d71aa18b4349980a6ffb36bd05a11d799f6)
:   srm: Fix sync to async mode timeout

[b737a5e](https://github.com/dcache/dcache/commit/b737a5e15ca6530d6803f2a1e6c4084ee3739379)
:   pinmanager: Fix listing by id

[fdcb0fa](https://github.com/dcache/dcache/commit/fdcb0fa802693a5bdb4ffad83263891785f9e08d)
:   pool: Add HSM options to hsm script remove callout

[6511528](https://github.com/dcache/dcache/commit/651152879df9e9bcbab58b04b7c6370a09762a40)
:   srm: Fix queue size reporting

[3098128](https://github.com/dcache/dcache/commit/30981289078bfc29a430b54aea302e7846d23e88)
:   pool: Fix timeout behavior of HSM requests

[857e8b1](https://github.com/dcache/dcache/commit/857e8b15c466bfbfc6dd486adab6e66a914acef7)
:   spacemanager: Allow spaces to become unowned

[501eb58](https://github.com/dcache/dcache/commit/501eb5851377a15784bc305c204d30139c73407f)
:   [maven-release-plugin] prepare for next development iteration

## Release 2.10.30

### nfs

There was an error in how ACLs were interpreted by the nfs door where
multiple ACEs for the same user were compacted ignoring the flags.
With this release, ACEs against the same user but with different flags
are honoured.


### Changelog 2.10.29..2.10.30

<!-- git log 2.10.29..2.10.30 -no-merges -format='[%h](https://github.com/dcache/dcache/commit/%H)%n:   %s%n' -->

[8eeaaf3](https://github.com/dcache/dcache/commit/8eeaaf35c5b2cdc7c3b21e5c02d4ccb7f2b2e9ef)
:   [maven-release-plugin] prepare release 2.10.30

[cd071b1](https://github.com/dcache/dcache/commit/cd071b190e46cc40d786b1beb07379ee5fd12c97)
:   libs: update to nfs4j-0.9.6

[57787cc](https://github.com/dcache/dcache/commit/57787ccfececb88db507cf052f723bfbfed3ba0d)
:   [maven-release-plugin] prepare for next development iteration

## Release 2.10.29

### Changes affecting multiple services

This release fixes an NFS problem triggered when a second process
opens a file that is already opened by another process on the same
computer.  The NFS specification allows the second open to reuse the
"layout" (== mover) from the first open.  With this release, the door
will detect this and reuse the existing mover; the mover is updated to
allow this.  The nfs door and all pools accessible via the NFS
protocol must be updated to this release or newer.

### admin

Restore compatibility with loginbroker information for pcells; in
particular, the problem affected information provided by the srm door.

### dcap

No longer log a stack-trace when transfering a file if the client is
expected to connect to the pool (the "active client mode" option; the
`-A` in the dccp command) and the pool is shutdown before the client
connects.

### srm

Some SRM requests support bulk requests, where multiple SURLs are
processed in the same fashion.  The assumption was that the SURLs in a
bulk request are distinct.  Bulkd requests have been observed that
violate this assumption: a request with a SURL appears more than once.
This causes problems when staging files from tape.  With this release,
a SURL that appears multiple times in a request is processed exactly
once.


### Changelog 2.10.28..2.10.29

<!-- git log 2.10.28..2.10.29 -no-merges -format='[%h](https://github.com/dcache/dcache/commit/%H)%n:   %s%n' -->

[6008a13](https://github.com/dcache/dcache/commit/6008a130a32ba3597fbba60a6b2a5a65030b1a25)
:   [maven-release-plugin] prepare release 2.10.29

[d9eb548](https://github.com/dcache/dcache/commit/d9eb5486020e401ac6e39b8f8b53c81ee977369e)
:   dcap: fix stack-trace when shutting down pool waiting for connection

[3d261ec](https://github.com/dcache/dcache/commit/3d261ec04d2f495670edaf0db05d015276d8c9ec)
:   srm: Remove duplicate SURLs in bringonline and get requests

[0097928](https://github.com/dcache/dcache/commit/00979281dca7033883298b5d83b2a310024bb758)
:   admin: Restore pcells compatibility with loginrbroker

[8756386](https://github.com/dcache/dcache/commit/8756386031211227991ce7e88d27cc9e360ee78f)
:   nfs: share mover for the same client

[79a956c](https://github.com/dcache/dcache/commit/79a956c793e369c91e9c4e0aa6a99be31ad34c7c)
:   nfs: use NFSv4MoverHandler instead of Map in embedded NFS server

[ea49803](https://github.com/dcache/dcache/commit/ea49803aa0336a1f5d995a226b460726da464722)
:   system-test: add missing dCache disposible CA certificate

[cb794a7](https://github.com/dcache/dcache/commit/cb794a77b33b4fc300853b74742cb79887323db9)
:   system-test: add regenerated host and user credentials

[6275545](https://github.com/dcache/dcache/commit/6275545d4474cd15d653ce7162e066c485f42885)
:   [maven-release-plugin] prepare for next development iteration

## Release 2.10.28

### Changes affecting multiple services

In previous versions of dCache deleting a directory with the last
reference to a tag did not remove that tag.  With the introduction of
upload directories this problem became acute, as many such directories
are created and deleted.  With this release, deleting the directory
with a tag's last reference is very likely (but not guaranteed) to
remove that tag's inode.  Further information about this will be made
available via user-forum.  The update affects both the nfs door and
pnfsmanager; however, most sites will see the most benefit from
updating pnfsmanager.  **Important #1** an updated nfs door will wait
for database changes that updating pnfsmanager will enact.
**Important #2** the database changes enacted by pnfsmanager can take
awhile (an hour or so for large dCache instances) as the change adds
an index to the `t_inodes` database table.

The "standard" Linux flag to mark an ACE as inherit-only is `i`, yet
previous versions of dCache accepted only 'o' as the inherit-only
flag.  With this release, both `o` and `i` are accepted.  The chimera
shell, pnfsmanager and nfs door should be updated.

### dcap

Previously the dcap door provided the dcap client with the wrong errno
(error number) should the client attempt to operate on a nonexisting
file or directory: `EIO` was returned instead of `ENOENT`.  This is
now fixed.

### nfs

Information about the filesystem, as reported by the `df` command, is
expensive to calculate.  Previously, the result was generated when a
client requests the value and the result cached for an hour.  This
proved awkward as all clients blocked until the calculation completes.
With this release, updating the cached value is a background activity:
the cached value is returned until the update completes.
Additionally, the cache lifetime is configurable via the
`nfs.fs-stat-cache.time` and `nfs.fs-stat-cache.time.unit` properties.

### pool

The file integrety checking (single file, entire pool one-off check
and background checking) produced ambiguous output; for example, not
being able to scan a file because it is still being uploaded counted
towards an "error" count, but no corresponding log message is
included.  With this release, the output is less ambiguous and
distinguishes between corruption, temporary and more permanent
problems.

### replicamanager

Added an admin command to query pool-manager for an updated list of
pools that are a member of the resilient pool group.  This allows
adjustments to the set of pools participating in replication without
restarting the replicamanager service.


### Changelog 2.10.27..2.10.28

<!-- git log 2.10.27..2.10.28 -no-merges -format='[%h](https://github.com/dcache/dcache/commit/%H)%n:   %s%n' -->

[698724f](https://github.com/dcache/dcache/commit/698724f443cbae3de73ed3716f9b217c1d789d4f)
:   [maven-release-plugin] prepare release 2.10.28

[1021708](https://github.com/dcache/dcache/commit/1021708238247cd94745a6370317a75b2cadfe75)
:   replicamanager: add an admin command to re-fetch resilient pool group

[f00a040](https://github.com/dcache/dcache/commit/f00a040f86491959d8063228f09f85609c10c97c)
:   acl: fix compatibility with linux ace

[af7b0ad](https://github.com/dcache/dcache/commit/af7b0adc0f507aa2cab9d8b02d35fcbedc01c833)
:   chimera: Delete unreferences tag inodes

[6487ea2](https://github.com/dcache/dcache/commit/6487ea265535a8378148a2b79f1617645dbe3ff3)
:   pool: update scrubber messages to be less ambigous

[a143cfa](https://github.com/dcache/dcache/commit/a143cfab90fc7825800a7dcd66eb77994b510b6f)
:   dcap:  fileAttributesNotAvailable must set pass ENOENT to the client

[969eb14](https://github.com/dcache/dcache/commit/969eb144a6db101f9c6aad04bac2b21b2068db3e)
:   [maven-release-plugin] prepare for next development iteration

[f94ed28](https://github.com/dcache/dcache/commit/f94ed280e9d8f2484a4b5aed32005281ada8ba07)
:   chimera: do not maintain time-based cached value of FsStat

[0f93f35](https://github.com/dcache/dcache/commit/0f93f359c5924142be84de6309aee16990f5d5ad)
:   chimera: squash usedFiles() and usedSize() into a single query

## Release 2.10.27

### Changes affecting multiple services

In prior versions of dCache, the `path` field that billing logs
for transfers contained the actual transfer path; i.e., for
SRM-initiated uploads this was the auto-generated path from the
TURL and not the user-supplied path from the SURL.  This proved
confusing so, with this release, the `path` field now has the
user-supplied path (i.e., from the SURL).  An additional field
(`transferPath`) has the transfer path.  While this is
not logged by default, billing configuration (the
`billing.text.format.mover-info-message` and similar properties)
may be updated to include it.  All doors used by srm clients and
the billing service should be updated.

### dcap

This version of dCache uses the connected socket when discovering the
IP address of the client for "channel binding", rather than a constant
value.  This is important for dual-stack machines (with both IPv4 and
IPv6 addresses) that host dcap doors with either gsi- or
kerberos-based authentication.

### spacemanager

In earlier versions of dCache, if a file is deleted while being
uploaded the space-manager will consider the transfer as successful
(and so using some of the reservation's capacity) whereas the pool
would delete the file immediately after the upload is complete.  Such
"leaks" results in a reservation being reported as having more used
capacity and less free capacity than it should.

### srm

The srm service maintains a counter of the number of requests for each
different type.  With earlier versions of dCache, if the srm
encounters jobs that have timed out while the service was no running, these
counters became inaccurate.  This is now fixed.

When an srm request times out, dCache may need to take some action to
"clean up"; for example, removing the upload directory.  If srm is
configured to discard all requests on start-up these cleanup
operations did not happen.  This is fixed with this release.
As a consequence, startup times will be longer.

If `srm.persistence.enable.store-transient-state` is set
to `false` (the default value) then transfer requests
do not survive an srm service restart if the limit on concurrent
transfers prevented handing out the TURLs.  With this
release, such requests survive an srm restart.

Previously, if `srm.persistence.enable.store-transient-state` is set
to `false` (as is the default) then information needed to clean up a job
might not be stored in the database.  If, after restarting the srm,
the job times out or is aborted then there is insufficient information
to clean up, resulting in upload directories not being cleaned, pins
(for bring-online requests) not being cleared, copy requests not being
cancelled and lifetime extensions being lost.  These problems are
fixed with this release.


### Changelog 2.10.25..2.10.27

<!-- git log 2.10.25..2.10.27 -no-merges -format='[%h](https://github.com/dcache/dcache/commit/%H)%n:   %s%n' -->

[a94ac75](https://github.com/dcache/dcache/commit/a94ac75adc77a25baa0e02b989f4b46739f961af)
:   [maven-release-plugin] prepare release 2.10.27

[eeace29](https://github.com/dcache/dcache/commit/eeace29c2eae5aef0822fee5ba6020b4e0fe0928)
:   all: Fix several NPEs when submitting billing messages

[daf84a3](https://github.com/dcache/dcache/commit/daf84a3a0ac746de27cb862587fb7d4a9dfab889)
:   [maven-release-plugin] prepare for next development iteration

[12c07e1](https://github.com/dcache/dcache/commit/12c07e16d0035f56aea50cfcbc6e9db2de4eadcf)
:   [maven-release-plugin] prepare release 2.10.26

[7c4c24d](https://github.com/dcache/dcache/commit/7c4c24d9a71dfe6f60f6966ba19e74814af0ee83)
:   srm: Fix scheduler counter initialization on restart

[66f8951](https://github.com/dcache/dcache/commit/66f8951c7cf599388fd1433a69d3818b9f1c918f)
:   doors: Log real path in billing

[475fa58](https://github.com/dcache/dcache/commit/475fa58f3dbc22cdc16a13b81ee1aafa132f01c1)
:   srm: Allow the SRM to take action upon cleaned requests

[4789735](https://github.com/dcache/dcache/commit/47897356c4c1fee37b93241c1d22620a474ce436)
:   srm: Force save jobs when adding information needed for cancellation

[bb4acc2](https://github.com/dcache/dcache/commit/bb4acc2ac1b80f66d8b3bb8d7e758268bdcb10e2)
:   srm: Force save when job becomes RQUEUED

[d1ee02c](https://github.com/dcache/dcache/commit/d1ee02c3857e9812d6da8ad202f6ba1f8170263d)
:   javatunnel: use connected socket to discover local inet address

[7512d5c](https://github.com/dcache/dcache/commit/7512d5ce8554f464e3ddf86a50618a15ae56151f)
:   [maven-release-plugin] prepare for next development iteration

[c4c8640](https://github.com/dcache/dcache/commit/c4c8640a2d6a15363f6a4b4b5164951be760f0f4)
:   spacemanager: Fix race condition leading to leaked files

## Release 2.10.25

### Changes affecting multiple services

When dCache suffers a sufficiently high inrush of requests that a
cell's request queue is exhausted, new requests to that cell are
rejected.  While overall dCache handles this situation correctly
(degrading gracefully), the internal message counting and event
logging were not updated correctly.  This is now fixed.

Fix a bug that triggers a NullPointerException in webadmin.  Although
the problem is logged in webadmin, the cause is in the doors supplying
the information.  Therefore, the dcap and ftp doors are to be updated.

When publishing an IPv6 interface, do not include the zone
information.  Zone information is an extension to IPv6, which appends
a '%' plus some opaque identifier to the regular address.  Not all
clients understand this extension and reject the address as invalid.
As zone information is not useful anyway, with this release zones are
no longer published.  This update is for all doors.

The gplazma, pinmanager pool and srm services can process several
dCache-internal messages concurrently.  Previously, shutting down
these services failed to wait for concurrent activity to finish
(within a reasonable deadline), which risked partially committed
activity and logging errors when shutting down a busy system.  This is
now fixed.

Fix possible NullPointerException in httpd and admin services.

In most cases dCache will publish door URLs with a hostname; if the
address cannot be resolved then the address is used instead.
Previously IPv6 addresses were written incorrectly: without the square
brackets.  This is now fixed if the info service and the info-provider
scripts are updated.

### admin

Fix division-by-zero error when the SSH client reports zero width or
height.  This happens forcing allocation of a pseudo TTY without
having a real TTY (see the `-t` option to OpenSSH client).

### pinmanager

Fix pinmanager so it does not log a stack-trace if it failed to fetch
fresh pool status information from poolmanager while unpinning a file.

### pool

Previously, the metadata reconstruction for files where the upload was
not completed and written without the client specifying a retention
policy would trigger a stack-trace `java.lang.IllegalStateException:
Attribute is not defined: RETENTION_POLICY`.  This is now fixed.

Sites have reported pools becoming stuck with messages like
`UNEXPECTED_STATE_FATAL: Unexpected internal state, unable to
continue.`, which is due to a problem with the Berkeley DB.  This
release includes an updated version that should fix these problems.


### spacemanager

A number of sites have reported problems with the database resolving
deadlocks.  While such reports are expected and dCache behaves
correctly when they happen, this release should reduce the likelihood
of them appearing.


### Changelog 2.10.24..2.10.25

<!-- git log 2.10.24..2.10.25 -no-merges -format='[%h](https://github.com/dcache/dcache/commit/%H)%n:   %s%n' -->

[52b4482](https://github.com/dcache/dcache/commit/52b4482d314da70196df51a67d5fb1e3c1277169)
:   [maven-release-plugin] prepare release 2.10.25

[026bd03](https://github.com/dcache/dcache/commit/026bd034244bdef93cc6d3f2e9043619f95dd9cd)
:   info/info-provider: publish valid IPv6 addresses

[df0a450](https://github.com/dcache/dcache/commit/df0a450fb957178a2a72cb30dfdf763e4162d8ce)
:   loginbroker: strip off zone off published interface name

[4aa0d5b](https://github.com/dcache/dcache/commit/4aa0d5b0f048093d5657d28a2399ae239b9cc8d1)
:   admin: Avoid division by zero when the client reports a zero sized terminal

[42a1929](https://github.com/dcache/dcache/commit/42a1929f1fd578bfd234bd217f5658cefe489cbc)
:   spacemanager: Optimize space record deletion

[69aca22](https://github.com/dcache/dcache/commit/69aca22b5afba7bf9e65e990a008d79b620688ac)
:   Update netty and berkeley DB to latest version

[3a92a16](https://github.com/dcache/dcache/commit/3a92a16b17697f673a4283fe1be7a0a90155c12f)
:   dcache: Make cell communication use the correct timeout

[186166c](https://github.com/dcache/dcache/commit/186166cd593bf66719d277244a4d9e74eb38d7e0)
:   httpd,admin: Fix NPE in transfer collectors

[955ae65](https://github.com/dcache/dcache/commit/955ae65f5c67ae63f78ed79f17eaf32ce1f69a74)
:   doors: Fix race condition that causes NPE in webadmin

[de754a4](https://github.com/dcache/dcache/commit/de754a4ec3188898ba4bd83c166238853468b440)
:   cells: Orderly shutdown of multi-threaded cells

[1f58c6f](https://github.com/dcache/dcache/commit/1f58c6f9cf809393ca2b7bd42114d582ddbb5cb6)
:   cells: Fix event queue counting bug

[d869b04](https://github.com/dcache/dcache/commit/d869b040bcbb85c6288079d6945709a3639c2bd3)
:   pinmanager: Don't log stack trace when unable to fetch pool monitor

[6f4358b](https://github.com/dcache/dcache/commit/6f4358bf16958113f77c54f9b1d3b6ebf832d2b9)
:   pool: Fix meta data reconstruction

[74f8190](https://github.com/dcache/dcache/commit/74f8190e6677326bf1c07d0d226cc5722a8de160)
:   [maven-release-plugin] prepare for next development iteration

## Release 2.10.24

### Changes affecting multiple services

Avoid potential message loop when both sender and receipient domains
are restarted while the message is in-flight.

### admin

pcells distinguishes between a failure to send a message to a
cell and that cell taking too long to respond.  Support for
that distinction was lost with 2.10; with this release, it is
restored.

The tab-completion feature of admin parses the help-hint to discover
what expansions are available.  This has been updated to support
more commands.

### httpd

Fix compatibility with pcells.  This requires a corresponding update to pcells.


### Changelog 2.10.23..2.10.24

<!-- git log 2.10.23..2.10.24 -no-merges -format='[%h](https://github.com/dcache/dcache/commit/%H)%n:   %s%n' -->

[0a220c4](https://github.com/dcache/dcache/commit/0a220c49b0e89f85e21d1f56856ffaa9385a5d4b)
:   [maven-release-plugin] prepare release 2.10.24

[9bab859](https://github.com/dcache/dcache/commit/9bab859e789a65dfeead3a3e1b48be5a3dc7a90b)
:   admin: Fix command completion

[25eff9b](https://github.com/dcache/dcache/commit/25eff9bcc0e9290a701c207da2ae7f5cfd2794e7)
:   admin: Propagate NoRouteToCellException to pcells

[ff3541f](https://github.com/dcache/dcache/commit/ff3541f2d1befb14af1eeecefc202c5c85155756)
:   cells: Restore CellExceptionMessage encoding

[dadae07](https://github.com/dcache/dcache/commit/dadae0721dcd57f862dba440b2d7a87111c5fb12)
:   httpd: Fix pcells compatibility

[9f44f34](https://github.com/dcache/dcache/commit/9f44f3470994645c77c2f2d6f37be88f03176949)
:   [maven-release-plugin] prepare for next development iteration

## Release 2.10.23

### admin

Restore support for pcells to gracefully handle timeouts.

Restore compatibility for pcells when querying space-manager.

### cleaner

Fix bug reported as `java.lang.ClassCastException: java.lang.String
cannot be cast to [Ljava.lang.String;`.

### pool

Fix pool reconstruction.  If, on startup, the pool detects it is in an
inconsistent state it will attempt to recover from that.  With this
release, this should work.

### srm

Update SRM default property values.  From various reports, it is clear
that the current default values are not ideal for many sites.  The
following properties are adjusted:

* `srm.limits.jetty-connector.backlog` increased to support bursts of
   activity; a larger value may be appropriate but not available due
   to default Linux configuration.

* `srm.request.threads` reduced as processing is asynchronous.

* `srm.request.ls.threads` change default to be
  `srm.request.ls.max-in-progress` as `ls` requests are blocking.

* `srm.request.max-requests` increased to satisfy user-demand; needed
   as clients typically request more concurrent TURLs that they make
   concurrent requests.

* `srm.request.max-transfers` increased to same value as
  `srm.request.max-requests`.  This way (by default) dCache never
  blocks requests pending a client returning a TURL.

* `srm.persistence.remove-expired-period` increased to 10 minutes to
  reduce stress on the database.

* `srm.service.pnfsmanager.timeout` decrease to two minutes as
  PnfsManager should respond within that time and clients will likely
  disconnect if they don't hear a response within that time.

* `srm.service.spacemanager.timeout` decrease to 30 seconds as the
  service should respond quickly.

* `srm.protocols.disallowed.get` and `srm.protocols.disallowed.put`
  now include `file` protocol by default.

* `srm.protocols.loginbroker.timeout` decrease to 20 seconds as this
  is a very light-weight service.

Support catching and logging some bugs that previously would be
silently ignored.

Increase default value for `srm.limits.db.queue` to survive database
activity when faced with bulk staging requests.

Fix a ConcurrentModificationException caused when SRM processes two
requests close tegether.


### Changelog 2.10.22..2.10.23

<!-- git log 2.10.22..2.10.23 -no-merges -format='[%h](https://github.com/dcache/dcache/commit/%H)%n:   %s%n' -->

[32230d6](https://github.com/dcache/dcache/commit/32230d609f64867514ff21c25e5dd44eb0a2ef99)
:   [maven-release-plugin] prepare release 2.10.23

[d817f6f](https://github.com/dcache/dcache/commit/d817f6fce95cedb2a1d41287bdae7677ad526435)
:   admin: Restore pcells compatibility

[4d51df9](https://github.com/dcache/dcache/commit/4d51df9ab9ed365ae8260020a06d68611cc275a9)
:   srm: log more SRM bugs

[b453bb7](https://github.com/dcache/dcache/commit/b453bb76c68fb38b7400695e428f2dda83d53ed3)
:   admin: Restore timeout semantics for pcells compatibility

[25b076e](https://github.com/dcache/dcache/commit/25b076e2fe7184d61991898b0f2bb26fb802b32f)
:   cleaner: Fix class cast exception

[3702d41](https://github.com/dcache/dcache/commit/3702d41b0e8596fb888070cc402a15d2b731f1f0)
:   srm: Increase default database queue

[ba0fd18](https://github.com/dcache/dcache/commit/ba0fd18fee9688c9ecd2367529e0167cfbd4bfd1)
:   srm: Use more sensible default values

[431e4e0](https://github.com/dcache/dcache/commit/431e4e0099fc66d9db62f416d3dc03d4811069d7)
:   srm: Fix ConcurrentModificationException in Axis

[e3b85a2](https://github.com/dcache/dcache/commit/e3b85a217adde990965e5a1d57576de4f683c5cd)
:   pool: Fix pool entry reconstruction

[c082039](https://github.com/dcache/dcache/commit/c082039d8f58e7b1ee5d8a0da5453d794305ccab)
:   [maven-release-plugin] prepare for next development iteration

## Release 2.10.22

### Changes affecting multiple services

This release improves the quality of information recorded when logging
problems and fixing synchronization of lease time.  This affects the
nfs door and pools.

### pool

When a client reads a file, the pool reads blocks of data from the
local filesystem.  When reading such a block, the pool could receive
fewer bytes than requested.  Previously, the pool assumed that this
only happens when the end-of-file is reached; however, this is not
guaranteed.  Should this assumption be violated then the data sent to
the client will be corrupt.  In practise, the pool's assumption is
true for Linux and local filesystems; however, the code has been
updated to remove this theoretical cause of corruption.

Fix a problem where a door can trigger the pool to post-process a file
many times.  Each trigger starts a new thread, resulting in very large
system load.

Fix that, during startup, the pool would fail when recovering a broken
file that has access-latency and retention-policy determined by
spacemanager.

Extend the nearline SPI so it provides plugins with the file's path
and provides an easier way of report errors.

### spacemanager

Improve the logging and handling of transitory errors.


### Changelog 2.10.21..2.10.22

<!-- git log 2.10.21..2.10.22 -no-merges -format='[%h](https://github.com/dcache/dcache/commit/%H)%n:   %s%n' -->

[70fa3b0](https://github.com/dcache/dcache/commit/70fa3b025a19ea39f17cf1db82a847502ec8db56)
:   [maven-release-plugin] prepare release 2.10.22

[2b734fd](https://github.com/dcache/dcache/commit/2b734fd0a175135940bf7a7eab34816761d511a6)
:   pool: Fix and align pool meta data recovery with current pnfs manager

[58ca239](https://github.com/dcache/dcache/commit/58ca2398492542bf93c73d16310fd632769d1b48)
:   pool: ignore duplicated mover kill requests

[48b3a47](https://github.com/dcache/dcache/commit/48b3a47d68741217e58fffd069e18db9cb32121c)
:   spacemanager: Making logging and handling of transient errors more robust

[0a95f67](https://github.com/dcache/dcache/commit/0a95f67fd0a0cbe6895b2c3b0746f76a79f1e08a)
:   pool: Fix read corruption in HTTP mover

[c484e1a](https://github.com/dcache/dcache/commit/c484e1a594d3eafc005c8ec122bac0fd9f2b06a8)
:   pool: Extend nearline storage SPI with path and custom error codes

[ed56243](https://github.com/dcache/dcache/commit/ed56243dc2d587436103cbe373e12cbdf69540ca)
:   libs: update to nfs4j-0.9.5

[0e8edbd](https://github.com/dcache/dcache/commit/0e8edbda140aa3f5cec0468cca783586bdef468f)
:   [maven-release-plugin] prepare for next development iteration

## Release 2.10.21

### Changes affecting multiple services

If a bug is found in dCache then it should be logged.  For the older
admin commands, an uninformative message was logged.

The LocationManager service is started automatically in the broker
domain (typically `dCacheDomain`).  This answers requests from other
domains with instructions on how to connect to the dCache cluster
(typically a star topology, other domains connecting to the
`dCacheDomain`).  With this release, the FQDN is sent rather than the
hostname name.  The node hosting the broker domain should be updated.

The version of HikariCP has been updated to 2.0.1.  This is to correct
for a bug in v1.3.9 that triggers logging a stack-trace with:

    Internal accounting inconsistency, totalConnections=-1

Previously, if a client attempts to write a file with Access Latency
and Retention Policy that conflicts with the selected reservation a
stack-trace was logged.  This is now fixed: both the FTP door and
spacemanager should be updated.

Previously, if a bug was discovered when starting up a service dCache
would abort starting up with a non-informative log message.  Now, the
stack-trace is logged.

### nfs

Log abandoned movers with the corresponding stateid.

### pnfsmanager

When writing into dCache with SRM, the Access Latency (AL) and
Retential Policy (RP) may be specified or omitted.  Additionally, the
client may specify a space reservation into which the file should be
written.  If the client specifies both, they must match.

In dCache, there are three mechanisms to support a client that
specifies neither AL/RP nor space reservation: the directory can have
`AccessLatency` and `RetentialPolicy` tags, the directory can have the
`WriteToken` tag, there are a system-wide default AL/RP values.

Previously, dCache would reject uploads where the user-supplied AL/RP
information does not match the AccessLatency/RetentialPolicy tags,
despite the latter being intended as default values.

With this release, if the client specifies neither space token, AL or
RP then the directory tags will be used.  If a directory specifies
both `WriteToken` and `AccessLatency`/`RetentionPolicy` tags, then
these have to be consistent.  If the directory conains a `WriteToken`
tag and the client specifies AL/RP, then the client specified values
have to be consistent with the `WriteToken` tag.

### pool


When attempting to upgrade non-precious and non-cached files (e.g. a
file marked `broken`), the receiving end of the migration module would
answer twice: first (correctly) with a failure and then (incorrectly)
with a success.  This is now fixed.

### spacemanager

With RDBMs, transactional deadlock rollbacks are normal behaviour,
which happen when the database must choose between two conflicting and
concurrent changes.  Previously, spacemanager would aggressively retry
when this happens.  This has been observed to trigger performance
degradation.  This release includes several strategies to minimise the
impact of this.

Previously, the default number of space-manager threads was the same
as the number of database connections.  This does not take into
account that there is background activity that also needs access to
the database.  With this release, the number of threads has been
lowered; having a large number of threads also increases the
likelihood of seeing transactional deadlock rollbacks.

Fix the shutdown sequence of spacemanager.  Previously, shutting down
a busy spacemanager could lead to attempts to modify the database
after all database connections were closed; such failures were logged.

Reduce logging on various DB errors; generic transient errors are now
warnings and transactional deadlock rollbacks are logged at debug
level.


### Changelog 2.10.20..2.10.21

<!-- git log 2.10.20..2.10.21 -no-merges -format='[%h](https://github.com/dcache/dcache/commit/%H)%n:   %s%n' -->

[9ce8df8](https://github.com/dcache/dcache/commit/9ce8df8cf6477c1c5663eec20de34898b97d91cb)
:   [maven-release-plugin] prepare release 2.10.21

[2f41134](https://github.com/dcache/dcache/commit/2f41134fe1a77918fa91cead7656dfdd11254969)
:   LocationManager: Use fqdn instead of hostname

[a4b8812](https://github.com/dcache/dcache/commit/a4b8812d3ee569389435e81d8f9e4a1dd8f8ddd6)
:   spacemanager: Controlled shutdown

[7fc3600](https://github.com/dcache/dcache/commit/7fc3600c2914b852c90128f03a1ef1458de39c9c)
:   spacemanager: Make request processing more robust

[41305ce](https://github.com/dcache/dcache/commit/41305cec9011621b41163e0610376b34ce5ed3ba)
:   spacemanager: Reduce log level on various transient DB errors

[e05fb97](https://github.com/dcache/dcache/commit/e05fb97f0d44dc1c569e7da13f0b5af7c61ea248)
:   spacemanager: Minor simplification to link group updates

[7d325d8](https://github.com/dcache/dcache/commit/7d325d85c0bf8a089d020fa5a761875f763b89da)
:   spacemanager: Don't log stack-trace on AL/RP/Reservation conflict

[d5a9928](https://github.com/dcache/dcache/commit/d5a99287c105a4385cb202ab2fe552ba99a5ca99)
:   spacemanager: Lower default for number of threads

[40efb76](https://github.com/dcache/dcache/commit/40efb76ddc53c6a227e89fead7925dfd5cb7d738)
:   2.10: Upgrade HikariCP to 2.0.1

[8608a2d](https://github.com/dcache/dcache/commit/8608a2d5bc3610c5d17b8d210b5ca9e8f2885a5e)
:   nfs4: log abandoned movers with WARN

[5e35b46](https://github.com/dcache/dcache/commit/5e35b460485e7d74bf2278d0a75664da61dfe74e)
:   cells: log bugs found by CellShell

[bd53579](https://github.com/dcache/dcache/commit/bd53579cbd27ddef2af9c2c6b521b49832d8129a)
:   cells: fix how bugs are reported from ac_ command.

[4c6eb11](https://github.com/dcache/dcache/commit/4c6eb1166bbdb5676efe1749431359bccb5b00e9)
:   pool: Fix bug in migration module upgrade logic

[4f1c69b](https://github.com/dcache/dcache/commit/4f1c69bdfea72701337c135630b8b19185e8db90)
:   pnfsmanager: Fix upload to space token that conflicts with AL and RP tags

[740b40c](https://github.com/dcache/dcache/commit/740b40cd9b61a4c14ba12abb3654416ec364dae1)
:   [maven-release-plugin] prepare for next development iteration

## Release 2.10.20

### Changes affecting multiple services

Various scripts, including the `dcache` command, invoke the `java`
command with a list of directories in which Java should look for
support libraries.  Previously, the current working directory was
(mistakenly) included in that list.  This could lead to odd behaviour;
one particular example is running a `dcache database` command from the
`/etc/dcache` directory.  This release fixes this problem by excluding
the current directory.

Normally, if running an admin command in some cell triggers a bug then
the log file of the domain hosting that cell will contain a
stack-trace.  Previously, for certain admin commands (spacemanager and
`sweeper ls` in the pool) this did not happen.  This is fixed with
this release of dCache.

When there is some problem in the communication between domains and
error message is logged.  Previously the explanation for the problem
was logged as "null".  With this release, a more descriptive
explanation is provided.

The help text within the chimera CLI and for the pool's migration
commands was badly formatted; this release fixes this.

### spacemanager

By default, when logging messages some contextual information is
included (in square brackets).  This typically includes the cell name
and the kind of activity that triggered the log message.  Previously,
some messages omitted all contextual information, which is fixed with
this release of dCache.

Fixed the `ls spaces` and `ls files` commands so they do not fail if
there is a reservation without an owner.

All space-reservations may have an owner: a username or an VOMS group;
ownership may be further restricted by VOMS role.  When created
through the admin interface, a reservation's ownership is optional.
With previous versions of dCache, if a space-reservation has no owner
then anyone can release it.  With this release of dCache, a
reservation without an owner may only be released through the admin
interface.


### Changelog 2.10.19..2.10.20

<!-- git log 2.10.19..2.10.20 -no-merges -format='[%h](https://github.com/dcache/dcache/commit/%H)%n:   %s%n' -->

[1cdaf24](https://github.com/dcache/dcache/commit/1cdaf24b03e21c811fd7ec72d9eba6b53901cd7e)
:   [maven-release-plugin] prepare release 2.10.20

[07b031f](https://github.com/dcache/dcache/commit/07b031fefa49e20e280fcb2f189645e07263eaa9)
:   spacemanager: Change release authorization for unowned reservations

[275bbf8](https://github.com/dcache/dcache/commit/275bbf8fda98ed8ac5eeb45eee5a5ae7192cb4a7)
:   Fix valueSpec help parser

[a8ca6ed](https://github.com/dcache/dcache/commit/a8ca6edbc3946e00a4c8674e08d8d5c5de0d7ced)
:   spacemanager: Fix NPE in listing space reservations

[e85713a](https://github.com/dcache/dcache/commit/e85713a419993e1f170d0d3aa0706aaf61883fd0)
:   Maintain CDC of threads in decorated thread pool

[806e8c0](https://github.com/dcache/dcache/commit/806e8c0ae88ba95cd986dfbb977954665297b1c2)
:   spacemanager: Log unexpected exceptions

[8d37d0a](https://github.com/dcache/dcache/commit/8d37d0a1156eb83a9247c59fb916bac3dc743a31)
:   tunnel: use toString if IOException#getMessage returns null

[67d047c](https://github.com/dcache/dcache/commit/67d047c37adcd287b0ac2dd142af5c478e8597ad)
:   Exclude cwd from classpath

[9feb238](https://github.com/dcache/dcache/commit/9feb23893a1cc4c382d940aa74d951061b11aa33)
:   [maven-release-plugin] prepare for next development iteration

## Release 2.10.19

### Changes affecting multiple services

Fix potential database connection leak for nfs door and pnfsmanager
service.  This was triggered when attempting to create an already
existing non-zero level via the `.(access)` or `.(use)` dot commands.

This patch fixes a race condition in Chimera that affects the nfs door
and the pnfsmanager service.  The effect is that, if two clients
attempt to delete the same target (a file, link or directory) at the
same time then the nlink count for the parent directory is decreased
twice.  "At the same time" means within the time taken to process the
deletion; this is instance-specific but should be much less than 1 ms
for well-configured systems.  Sites can repare any incorrect nlinks
with the following SQL:

    UPDATE t_inodes SET inlink = (
        SELECT COUNT(*) FROM t_dirs  WHERE t_inodes.ipnfsid = t_dirs.iparent
    ) WHERE itype = 16384;

This is safe to run on a running production instance, but may take
some time and will affect dCache's responsiveness while running.

### gplazma

The description for how to migrate away from using the forbidden
`useGPlazmaAuthorizationModule` and `useGPlazmaAuthorizationCell`
properties had caused confusion.  The description has now been updated
to be more explicit.

### httpd

Fix filtering boxes and sorting on Pool Admin, Pool Usage, Poolgroups,
Space Tokens and Tape Transfer Queue.

### pnfsmanager

When a user uploads a file via SRM, a directory is created under the
update directory (`/upload` by default).  Should this fail, the upload
will fail; however, this was not logged.  With this release,
pnfsmanager now logs why such failures happened.

### pool

Previously, the NFS mover stopped when the client disconnected.  This
had two problems: a client that never connects to the pool leaves a
mover that never dies and file transfers are not robust against
transitory networking problems, despite the client attempting to
reconnect.  The latter problem is particularly bad when writing data
as falling back to the door is not supported and such failures are not
handled well by the Linux kernel.

With this release of dCache, if the client is not connected then the
mover queries the door every 7.5 minutes to check it is still needed.
The mover dies only when the client closes the file, the door declares
the client is lost or the nfs door is stopped or restarted.

**IMPORTANT** Any pool upgraded to this version of dCache that is used
for NFS transfers requires all NFS doors to be upgraded to this
version or newer.

Currently, if there is a problem while a file is being uploaded using
HTTP chunked transfer encoding then dCache will contain an incomplete
file with no error mentioned in any log.  With this release, such
partially uploaded files will still exist (due to the partial upload
semantics of pools) but the problem is logged on the pool and with
billing.

### spacemanager

Add a `-blocking` option to the `update link groups` admin command to
ensure all subsequent commands will use the updated information.

### srm

When uploading files, the client may choose not to specify an access
latency, a retention policy or a space reservation for these files.
Likewise, when reserving space, the client may choose not to specify
an access latency for the reservation.  Previously, the detailed view
of the admin `ls` command showed `null` for these fields if the client
did not specify them.  With this release, those fields are omitted if
they have no useful data.

Uploading a file with SRM involves three steps: preparing for the
upload (`srmPrepareToPut`), uploading the file, marking the upload
finished (`srmPutDone`).  The third step can fail but previously the
response from dCache is always `Upload failed.`.  With this release, a
meaningful error message is returned.


### Changelog 2.10.18..2.10.19

<!-- git log 2.10.18..2.10.19 -no-merges -format='[%h](https://github.com/dcache/dcache/commit/%H)%n:   %s%n' -->

[53b9c39](https://github.com/dcache/dcache/commit/53b9c390f9c62698ec53077c8129f74e4cc7cf79)
:   [maven-release-plugin] prepare release 2.10.19

[67f3a8b](https://github.com/dcache/dcache/commit/67f3a8b4b137a3dbfbae6bb9210774e18b038c5d)
:   pool: Propagate HTTP mover failures to pool

[1e29206](https://github.com/dcache/dcache/commit/1e292060e3e4f5843c410cb8a0bea1d508d95c9c)
:   chimera: fix potential transaction leak on error path

[7f17d90](https://github.com/dcache/dcache/commit/7f17d90567db4d72859bb6f9f158fc5f47a0587e)
:   gplazma: update error message for forbidden properties

[84ad1e2](https://github.com/dcache/dcache/commit/84ad1e2f30a1094d5834d47e915cbb8dc324576f)
:   spacemanager: add blocking option to update link groups command

[b45ebdd](https://github.com/dcache/dcache/commit/b45ebdd68b07585198d1992b4444509dccf457d3)
:   srm: don't list absent information in ls

[6cc547a](https://github.com/dcache/dcache/commit/6cc547a168d569f9e59f32d45f46ae212b77d0fd)
:   fix broken merge

[c550606](https://github.com/dcache/dcache/commit/c550606a21b631d7b1042ab6c9fd1e3b91bb7c84)
:   pnfsmanager: log problems when creating upload directory

[e03d1f9](https://github.com/dcache/dcache/commit/e03d1f94e7af6fb22824638e823ac14542ae2f1a)
:   (2.10) webadmin: make jquery selector specific to individual tables

[38628b4](https://github.com/dcache/dcache/commit/38628b43d134d3e17ac031f3fd0f94ea3685d539)
:   (2.10) webadmin: restore missing components to respect jquery script options

[adf3ae1](https://github.com/dcache/dcache/commit/adf3ae185825698d1b5f3b01b831cc714d2c2e99)
:   srm: include the reason why upload failed

[b74d4a4](https://github.com/dcache/dcache/commit/b74d4a42e7d92c6a1327c161d90636b208dc426b)
:   chimera: fix race condition on remove

[044c33a](https://github.com/dcache/dcache/commit/044c33ad5bc1be9f5bf680848f3a51aac8991c68)
:   webadmin: ensure unique id attributes for all (currently) tested UI elements

[c6c6e87](https://github.com/dcache/dcache/commit/c6c6e87b517bc6720e46afc2867fef5b6dff0902)
:   pool: update NFS transfer service to validate inactive movers

[6e47601](https://github.com/dcache/dcache/commit/6e4760144354e1a36eb556dd0d035d8b2e2c07c4)
:   [maven-release-plugin] prepare for next development iteration

[a5634b0](https://github.com/dcache/dcache/commit/a5634b078581839dce794326da8318ac6615f302)
:   libs: use nfs 0.9.x

## Release 2.10.18

### ftp

Fix default value for `ftp.authz.readonly` for plain (unencrypted)
doors.  This restores the default value to the dCache v2.6 default
value of `true`.

Add the DN of a user in the access log file for "Grid FTP" access.

The response from the plain (unencrypted) ftp door if the user
specifies the wrong password is badly formed.  Althogh it is possible
that some clients are robust against such incorrect responses, with
this release the ftp door responds correctly.

### nfs

Previously, when enabling the nfs door's namespace cache, querying
information about a freshly created file could provide stale
information; for example, querying a recently uploaded file's length
could mistakenly show the file length is zero.  With this release, the
close after a successful write will invalidate that file's entry in
the nfs door's cache, allowing it to report up-to-date information.

Prevent leaking memory if a client's data transfer is proxied (i.e.,
no use of pNFS) and there is a communication error between the pool
and the nfs door.

### webdav

Fixes a bug where, if a double-slash is present, all parts of the path
leading up to the double-slash are ignored; for example, with the bug,
a path like `/a/b//c/d` is handled as if `/c/d` was specified.  With
this release, double-slashes are treated like single slashes; the
above example is handled as if `/a/b/c/d` was specified.

Fix the NullPointerException triggered if client attempts to upload a
file as a child of some existing file.


### Changelog 2.10.17..2.10.18

<!-- git log 2.10.17..2.10.18 -no-merges -format='[%h](https://github.com/dcache/dcache/commit/%H)%n:   %s%n' -->

[ef63f5d](https://github.com/dcache/dcache/commit/ef63f5da2ed7c9ea7677d9dec8cc31d9a8b21ef3)
:   [maven-release-plugin] prepare release 2.10.18

[c928fff](https://github.com/dcache/dcache/commit/c928fff536f57eda7bacb644181a3841da38612c)
:   ftp: fix response if user fails to authenticate to weak FTP door

[7064cd3](https://github.com/dcache/dcache/commit/7064cd33e83e6079431dc25f4b05341af62d8626)
:   nfs-proxy: remove proxy adapter on IO errors

[1d069d7](https://github.com/dcache/dcache/commit/1d069d7954d008be8bc33f0c8cd5719ed32ff6cf)
:   ftp: fix invalid default for ftp.authz.readonly property

[4d54186](https://github.com/dcache/dcache/commit/4d54186f51b77ad1e9a65e478e4a39f11223bcbb)
:   webdav: fix double-slash bug by upgrading to patched milton

[7c754df](https://github.com/dcache/dcache/commit/7c754df41ea6ab0700e6013dcae6cac012815960)
:   webdav: fix NullPointerException when PUT as a child of a file

[7ade469](https://github.com/dcache/dcache/commit/7ade469e374770824839fd17084d218de3034810)
:   ftp: add user to access log

[48178df](https://github.com/dcache/dcache/commit/48178df92a6e82cfb23fe82a13243c9aefb796d9)
:   nfs4: invalidate vfs cache on successful write

[fecbf9c](https://github.com/dcache/dcache/commit/fecbf9c2a2206e1fe58df211a062c5d663606eb2)
:   nfs4: add NFS file handle into NfsTransfer class

[aaa07fe](https://github.com/dcache/dcache/commit/aaa07fe2c9bd7561f9178f61428502bfd65e3718)
:   libs: update to nfs4j-0.8.6

[2f4a5e2](https://github.com/dcache/dcache/commit/2f4a5e2903b351c0df85e82061d0822b9ca07555)
:   [maven-release-plugin] prepare for next development iteration

## Release 2.10.17

### httpd

Fix two minor issues when authenticating with the webadmin interface:
"unauthorised access" and being redirected to the home page.  The
unauthorised access error can occur when selecting "Login" under the
bird logo (top right corner); this is now fixed.  The redirection
problem occurs when selecting a tab that requires administrative
privileges while not logged in; this redirects the browser to the
login page.  Previously, after a successful login, the browser was
redirected to the home page.  Now the browser is redirected to the
selected tab.

### info-provider

The previous bug-fix release of dCache included a regression in the
info-provider.  The SRM endpoint URL (which starts `httpg://`) omitted
the port number.  This is now fixed.

In previous releases, the info-provider assumed the broker domain is
`dCacheDomain`.  This assumption has been removed.

### pool

Fix logging that the HTTP mover returned an error so that a generic
message ("An unexpected server error has occurred.") is logged if no
more concrete message is available, rather than "null".

### srm

The `info` command in the `srm` service shows the current number of
requests in each state for each request-type, along with the maximum
allowed.  Previously, the total failed to include requests in `READY`
state.

### webdav

A previous bug-fix release fixed how dCache responds when the client
attempts to `DELETE` a non-existent file.  Unfortunately, this
triggered a different problem where such activity results in a
stack-trace that starts `java.lang.ClassCastException:
java.lang.String cannot be cast to javax.security.auth.Subject`.  This
second problem is now fixed.


### Changelog 2.10.16..2.10.17

<!-- git log 2.10.16..2.10.17 -no-merges -format='[%h](https://github.com/dcache/dcache/commit/%H)%n:   %s%n' -->

[ba2064d](https://github.com/dcache/dcache/commit/ba2064d5a52dacc7ca175d7678ed985d7c6a05ae)
:   [maven-release-plugin] prepare release 2.10.17

[6cfd529](https://github.com/dcache/dcache/commit/6cfd529835c2b96225d035fc4bda9109ce1de87e)
:   Revert "info-provider: fix publishing SRM port number"

[fb9e33d](https://github.com/dcache/dcache/commit/fb9e33db6deb88bf2aa874fc649d0cf98d9fd6ab)
:   info-provider: remove dCacheDomain assumption.

[c77a2e2](https://github.com/dcache/dcache/commit/c77a2e2020e1f5df26118395984256ccfc4394f6)
:   pool: Fix logging in HTTP mover

[9d617f6](https://github.com/dcache/dcache/commit/9d617f698d48227753db08f94cb7443de8be3cc9)
:   srm: Fix calculation of total number of requests

[23f966a](https://github.com/dcache/dcache/commit/23f966a0bb2578c2382bbebd26ebf2c35ead0bbd)
:   webdav: Alternative to fixing return code of DELETE of absent file

[6767c95](https://github.com/dcache/dcache/commit/6767c9514e4a427bc2550a0a45117175a454e46b)
:   (2.10) webadmin: fix login redirect bug

[73d9d2d](https://github.com/dcache/dcache/commit/73d9d2da1e9e1fb54c9a7fef0acf12fa6b88cfdb)
:   [maven-release-plugin] prepare for next development iteration

## Release 2.10.16

### Changes affecting multiple services

Reduce memory usage by avoiding multiple instances of common strings.
Although this improves many services, pools are most affected.

Previous dCache releases included some of the code necessary for
pcells, even though dCache made no use of this code.  As part of
on-going consolidation effort, this code has now been removed from
regular dCache releases.

The `cell.name` is a core property within dCache.  Its omission (most
easily, by forgetting to specify `pool.name`) prevents the `dcache`
script for working.  The script is now robust against such errors.

If the `dcache check-config` command discovers that a deprecated
property is being configured, it looks for the alternative property
that should be used instead.  In earlier releases, under certain
circumstances, the wrong alternative property is selected.  This is
now fixed.

It is possible that a sudden burst of activity from many clients
exceeds dCache capacity to queue such requests.  Although dCache is
designed to degrade gracefully under such circumstances, there existed
the possibility of certain requests becoming stuck or memory leaking.
This is now fixed.

### nfs

Upgrade to nfs4j v0.8.5.  This fixes export file parsing if a host is
mentioned multiple times; note `localhost` must now have an explicit
entry in the exports file.  This also fixes a deadlock when closing a
file on a busy dCache instance.

Allow an nfs door to avoid being published to loginbroker.  Not being
published in loginbroker means the door is unavailable to SRM and is
not published by info-provider.

### pinmanager

If the maximum concurrency (`pinmanager.cell.threads.max`) exceeds
the number of database connections
('pinmanager.db.connections.max') then there is a risk of pinmanager
becoming deadlocked under heavy load.  This release reduces the
default maximum concurrency to avoid this.

### pnfsmanager

Fix NullPointerException when a file is stored in a directory with an
empty tag.

### pool

Upon reloading the pool configuration an error is produced when an
nearline storage was already defined in the existing
configuration.  This is now fixed.

A recent release fixed a bug that caused
`pool.mover.ftp.allow-incoming-connections` to be ignored.  Fixing
that bug revealed another that caused the property to have the
opposite effect.  This is now fixed.

dCache pool configuration allows passing (fixed) arguments to the HSM
script.  In earlier releases, these arguments were supplied to the
script in an arbitrary order.  While HSM scripts should not depend on
the order, they might; so, with this release, the order is preserved.

### webdav

Although dCache behaves correctly if the client interrupts a proxied
transfer; however, this is logged as a bug.  This is now fixed.

Make HTTP third-party copy feedback and detecting when client
disconnects more robust against internal dCache problems.


### Changelog 2.10.14..2.10.16

<!-- git log 2.10.14..2.10.16 -no-merges -format='[%h](https://github.com/dcache/dcache/commit/%H)%n:   %s%n' -->

[e747823](https://github.com/dcache/dcache/commit/e7478238882bd9ccdad8cda633317c9e21e83ec0)
:   [maven-release-plugin] prepare release 2.10.16

[0f760f6](https://github.com/dcache/dcache/commit/0f760f604d17477edda7c656a29f62493f680509)
:   info-provider: fix publishing SRM port number

[6d67a58](https://github.com/dcache/dcache/commit/6d67a58d1c663b7271456363af84868f39a08c61)
:   [maven-release-plugin] prepare for next development iteration

[7306099](https://github.com/dcache/dcache/commit/73060993e076daadba28147b10326509fa398a91)
:   [maven-release-plugin] prepare release 2.10.15

[dcf8d77](https://github.com/dcache/dcache/commit/dcf8d776075e47c578423b33e191d3735a7498e1)
:   webdav: don't log a stack-track when proxy transfer is interrupted

[1144520](https://github.com/dcache/dcache/commit/11445200136a081197618ba92fb3a1db4ab6bc58)
:   fix broken commit

[bee43f4](https://github.com/dcache/dcache/commit/bee43f41a54994d55e56594d62cf8eb5259ab34f)
:   webdav: make progress markers more robust

[4932840](https://github.com/dcache/dcache/commit/49328406512ed44988abea31d03c7fd103582bc7)
:   Fix compilation with Java 7

[2b5cdda](https://github.com/dcache/dcache/commit/2b5cdda2ad0bb93970ee7102bd09b7f1215e9fd5)
:   cells: Fix message timeout in case of thread pool overflows

[5516165](https://github.com/dcache/dcache/commit/55161656f9eefce108df16e020d0b2d07eda2fb4)
:   chimera: handle NULL field of directory tags

[6277cd0](https://github.com/dcache/dcache/commit/6277cd0f4830bb89c06890e6ee92f14750644387)
:   pinmanager: Adjust pinmanager defaults

[e766e8e](https://github.com/dcache/dcache/commit/e766e8e0433158d2a6ca44802c5c849f2611755d)
:   Internalize common strings in StorageInfo

[634bbe1](https://github.com/dcache/dcache/commit/634bbe1d3adfcac7cdb97351f415d41721624c95)
:   bootloader: Don't fail on missing cell name

[0ebd0af](https://github.com/dcache/dcache/commit/0ebd0af10a103c9bd68d6589fb27b1425c3a259f)
:   check-config: fix warning for deprecated properties

[6ef87e1](https://github.com/dcache/dcache/commit/6ef87e1e932eca735a7e315b543adfa2078af435)
:   pool: Fix regression preventing configuration to be reloaded

[2b27ad6](https://github.com/dcache/dcache/commit/2b27ad6ff8d38aa1a3cafdac7dcb2fdc3091cd84)
:   (2.10) gitignore additions for IntelliJ

[6fd254d](https://github.com/dcache/dcache/commit/6fd254da709436b00fb22289071b28f12c860129)
:   libs: update to nfs4j-0.8.5

[7e52c73](https://github.com/dcache/dcache/commit/7e52c7303b7fd7b5ac4ac84cb3a795860a17e2b8)
:   pool: Fix regression causing FTP movers to default to proxy mode

[477f0c8](https://github.com/dcache/dcache/commit/477f0c8abad2e5b83d903c681ac9aceced033a22)
:   nfs: Allow not to publish to loginbroker

[cd8b59e](https://github.com/dcache/dcache/commit/cd8b59ec76ee005213c7f1bd9b56cabae0dcd044)
:   pool: Preserve HSM option ordering

[bbd5570](https://github.com/dcache/dcache/commit/bbd55705d0b1f5bfbdcd221db61f5b61912a9d04)
:   [maven-release-plugin] prepare for next development iteration

[bf26db9](https://github.com/dcache/dcache/commit/bf26db9296a46f1a4f1514ecac2fa528debe5df1)
:   cells: Delete pcells related classes

## Release 2.10.14

### Changes affecting multiple services

Although dCache system configuration property names do not contain
spaces, it is possible to define such properties.  Previously, doing
so breaks the `dcache` command.  This is now fixed.

Update for the nfs door and the pools that allows faster restart.  The
door is also updated to be more responsive to namespace operations
when suffering large number of proxy reads.

If the number of concurrent connections is set to `-1` then the ftp
and dcap doors will leak memory, eventually triggering an
out-of-memory error that will restart the domain.  This is now fixed.

### admin

Fix erronous reporting of bugs when the user supplies incorrect
arguments to an admin command.

### dcap

Fix the permissions check for bring-online with plain dcap and a NFSv3
mounted dCache.

Fix regression against v2.6 and earlier dCache in how gsidcap doors
are known to SRM and how they are published in BDII/GLUE.

### ftp

The ftp door supports the `HELP` command as some clients use this
commands output to discover if certain optional functionality is
available.  This release fixes the output from this command.

The ftp door's access log records some responses without the
corresponding command-line from the client; subsequent responses (if
the response is multiple-lined) and all responses due to `STOR` and
`RETR` commands were affected.  This is now fixed.

### nfs

The `info` command now lists the proxy adaptors.  A proxy adaptor is
created when the client rejects the pool and falls back to reading
data from the door.

Improve shutdown of nfs door when the embedded portmapper is used.

### pool

Improve which interface the ftp mover selects when the client is
redirected to the pool.  In particular, the door will only redirect
the client if the IP protocol matches (IPv4 vs IPv6); for example, if
a client connects with IPv6 and the pool has no IPv6 address then the
door will now proxy the data connection.

The `pool.mover.ftp.allow-incoming-connections` property had no
effect.  This is now fixed.

Add the `IoMode` (whether the mover is accepting new data, or
supplying existing data) to the status line describing the mover.

Improve shutdown of nearline storage subsystem; now dCache will
attempt to cancel all ongoing activity before shutting down the pool.
The previous asynchronous approach could lead to
`IllegalStateException` being logged if the pool was busy at that
time.

### spacemanager

Adjust spacemanager schema migration to be aware of earlier dCache
bugs and to work-around site-local indexes that clash with new indexes
that dCache needs.

In previous versions of dCache, both spacemanager and pnfsmanager had
default access-latency and retention-policy settings.  The
spacemanager default retention-policy is only used if the admin
doesn't specify a value when creating a reservation through the admin
interface.  The spacemanager default access-latency is also used as a
default for the admin command; additionally, it is used when
processing an SRM reserveSpace request that omits the (optional)
access-latency information --- the retention-policy is mandatory in
such SRM requests.

With this release, the spacemanager no longer has default
access-latency or retention-policy properties.  Creating a
space-reservation in the admin interface now requires specifying both
the access-latency and retention-policy.  When processing an SRM
reserve space request without an access-latency, the spacemanager will
check from which linkgroups the user is authorised to reserve space.
It will choose an access-latency based on the request's
retention-policy.  If the user is authorised to reserve space from
link-groups such that both access-latency options (`ONLINE` and
`NEARLINE`) are possible, space-manager will prefer to reserve
`ONLINE` if the retention-policy is `REPLICA` and `NEARLINE` if the
retention-policy is `CUSTODIAL`.

### srm

Previously, if the SRM client requests listing a directory, specifies
a non-zero offset and does not limit the response size then dCache
would fail this request with an IllegalArgumentException.  This is now
fixed.

### webdav

With the recent upgrade of the Milton library some new behaviour was
introduced.  One example is that, under certain circumstances (and to
support certain clients) the Milton library returns a `401` (not
authorised) when attempting to delete a non-existing file.
Unfortunately, this change then broke ATLAS clients.  This patch
updates dCache so it returns `404` (not found) under these
circumstances.

Fix the response when a client requests a byte-range beyond the end of
a file.  This is necessary for compatibly with ARC clients.


### Changelog 2.10.13 to 2.10.14

<!-- git log 2.10.13..2.10.14 -no-merges -format='[%h](https://github.com/dcache/dcache/commit/%H)%n:   %s%n' -->

[e35c5ab](https://github.com/dcache/dcache/commit/e35c5abb01a7388b6fbf926e01851964c14db6eb)
:   [maven-release-plugin] prepare release 2.10.14

[37af85b](https://github.com/dcache/dcache/commit/37af85bc96e7a601fc12835c4425c9737140461c)
:   webdav: Fix reported content length for partial GETs

[87eb009](https://github.com/dcache/dcache/commit/87eb009d07f4eb91a9a4a064e7886c12b4ffcd41)
:   ftp: ensure client command line is available in access log

[70afdaa](https://github.com/dcache/dcache/commit/70afdaa42be918bc5a3d526269b48abeef12c489)
:   webdav: Fix return code on DELETE of absent file

[409228b](https://github.com/dcache/dcache/commit/409228b5d7e4c6f8a812bb337ce30cdbe2d6abbd)
:   srm: fix semi-infinite ls range with non-zero offset

[ab86627](https://github.com/dcache/dcache/commit/ab86627d57f2d32c2fe40d59cd9e7a82ec597450)
:   pool: Partially fix interface selection for FTP mover

[bc3e762](https://github.com/dcache/dcache/commit/bc3e762393c993d9925555197c8ca0af4898775a)
:   pool: Fix typo that breaks pool.mover.ftp.allow-incoming-connections

[7b19902](https://github.com/dcache/dcache/commit/7b199022e9c46cb9907958f03f85dcd7974a1c7f)
:   shell: fix shell oracle for configuration keys with a space

[23715ac](https://github.com/dcache/dcache/commit/23715ac6d420d34205806bfa9d0f1684eacb73a7)
:   nfs: show current proxy-io transfers in the door

[cfaa0e9](https://github.com/dcache/dcache/commit/cfaa0e92838dbae173ec858a1bded838198ef918)
:   chimera-cli: fix chown

[7540735](https://github.com/dcache/dcache/commit/754073505ed7aa01de482c3cce9edc8eea20b44a)
:   dcap: Fix regression in published protocol family

[0aac485](https://github.com/dcache/dcache/commit/0aac485fdf8ed9bdae500bca109b8b88b75d51dc)
:   ftp: fix help output

[5175403](https://github.com/dcache/dcache/commit/517540312e0855bf677364908ee300412a4e42e5)
:   loginmanager: Fix leak caused by absent child limit

[f540180](https://github.com/dcache/dcache/commit/f5401807b301c86bdf2647623e3d58ae2c8f71fa)
:   pool: Fix shutdown of nearline storage subsystem

[83608c6](https://github.com/dcache/dcache/commit/83608c6ed611b8449aaf4c187ca652711fe9e50b)
:   spacemanager: Fix null constraints and other schema migration issues

[fe1da05](https://github.com/dcache/dcache/commit/fe1da05741412bfdbbc07128453fba768a6a2021)
:   dcap: check for url in some commands

[3901c80](https://github.com/dcache/dcache/commit/3901c801a76f080032882e322ee57d121f334127)
:   admin: Fix error reporting

[553fdce](https://github.com/dcache/dcache/commit/553fdceee3bea0747143c77c7128126594f70d35)
:   pool: add Io mode into mover's status line

[a275f1e](https://github.com/dcache/dcache/commit/a275f1e58e10023850b0c22395a49ec231105e46)
:   spacemanager: Get rid of access latency and retention policy defaults

[b079809](https://github.com/dcache/dcache/commit/b0798092ecc9ea5a2bf7455daf52cca87e9aff38)
:   nfs: stop embedded portmap on shutdown

[0063089](https://github.com/dcache/dcache/commit/0063089a0b1530ba5f8b07ef151179048c08dff1)
:   libs: update to nfs4j-0.8.4

[0312ac0](https://github.com/dcache/dcache/commit/0312ac081686b22169fee9c3559b3d33294e97ff)
:   [maven-release-plugin] prepare for next development iteration

[907f1da](https://github.com/dcache/dcache/commit/907f1da86eda76db2e9abcb823582b1a634dec4e)
:   dcap: refactor PnfsSessionHandler to unify permission check and url handling

## Release 2.10.13

### ftp

Relax requirements for the EPSV and EPRT commands.  Previous versions
of dCache would reject all RFC 2428 commands from an IPv4 client.
This has been relaxed with this release.  Now, IPv4 clients can use
EPRT.  IPv4 clients can also use EPSV if delayed passive is enabled.

### info

Info service includes a safety feature that prevents it from
bombarding the rest of dCache with too many messages.  With this
release, the safety limit is reduced allowing info to send messages
more often.

Reduce the delay between subsequent messages of the same type.  This
allows the info service to recover information more quickly after
being restarted.

### pool

The NFS specification allows the server to specify multiple addresses
when telling the client where to connect; for example, specifying both
an IPv4 and an IPv6 address, or both addresses for multi-homed
machines.  This requires the client to choose the appropriate
interface.  For Scientific Linux 6, the kernel client will always use
the first supplied address in the list and fail if it cannot access
the pool with that address.  With this release, pools will order the
list, using heuristics to select which IPv4 address is "correct" and
list it first.

Prior to flushing a file to tape, the pool checks if the name-space
entry still exists and deletes the replica (rather than flushing) if
not.  Version 2.10.7 introduced a regression where, if this happens,
there is a IllegalStateException stack-trace.  This is fixed with this
release.

### poolmanager

With previous dCache versions, the WAAS selection algorithm had a bug
where it could (mistakenly) consider pools full if all pools had very
fresh files.  This is fixed with this release.

### spacemanager

Fix various issues to improve the robustness of spacemanager: handle
failed uploads correctly, handle files deleted during upload
correctly, increase robustness against dCache loosing (internal)
messages.

### webdav

Upgrade to Milton v2.6.  This fixes the buffering problem where a
proxied vector read request results in the entire file being written
to a `tmp` directory and not deleted.  With this release, requests for
100 kiB or less data result in no data being written to disk; requests
for more than 100 kiB are still written to disk, but only the data
needed to satisfy the request is stored and the file is deleted once
the response has been sent.  Some issues persist: data isn't deleted
if there is a failure sending it to the client and the whole file is
requested from the pool.


### Changelog 2.10.12 to 2.10.13

<!-- git log 2.10.12..2.10.13 -no-merges -format='[%h](https://github.com/dcache/dcache/commit/%H)%n:   %s%n' -->

[04efb0b](https://github.com/dcache/dcache/commit/04efb0b34e990d21dfd59dadc36b7368af48a2e9)
:   [maven-release-plugin] prepare release 2.10.13

[4431ddf](https://github.com/dcache/dcache/commit/4431ddfe762a1e496d7e3ecdfc122a01a72b04f8)
:   ftp: Relax requirements for EPSV and EPRT

[1f7afdb](https://github.com/dcache/dcache/commit/1f7afdb87333fbe122dfb8d4d1992db9689f88b5)
:   poolmanager: Fix full pool detection for WASS

[2e1ecd5](https://github.com/dcache/dcache/commit/2e1ecd5530cf58aa2bb41aedab5eb7342c7cad20)
:   ftp: Relax requirements for EPSV and EPRT

[27783b3](https://github.com/dcache/dcache/commit/27783b3575665704b147e36e8bf4c189efbff6c2)
:   Upgrade to Milton 2.6

[b74db9d](https://github.com/dcache/dcache/commit/b74db9d049aff19b50f2d76815e1e1e9dc238efc)
:   info: Reduce safety limit to 50 ms

[e4fe223](https://github.com/dcache/dcache/commit/e4fe2239d6db5542ee37003bd38680e8f8143b25)
:   pool: reorder ip addresses returned to NFS client

[a157ef8](https://github.com/dcache/dcache/commit/a157ef8127eb3d1308a23af1d7622f7ecdd21ff8)
:   pool: Fix ISE when flushing deleted file

[53bbe92](https://github.com/dcache/dcache/commit/53bbe92aec725c44823900f31d1a329828f98ab9)
:   info: Reduce delay between messages

[c509fbc](https://github.com/dcache/dcache/commit/c509fbc1dffa3a3ad20c051552bbd56a2452919b)
:   spacemanager: Fix various error recovery scenarios

[39dadfa](https://github.com/dcache/dcache/commit/39dadfa1bc8dc11050f22f461a2ea87a2d03a4e2)
:   [maven-release-plugin] prepare for next development iteration

## Release 2.10.12

### Changes affecting multiple services

Restarting a domain within an active dCache instance can lead to a
domain receiving messages for a cell as it is starting.  Strict
control is require to avoid the cell attempting to process messages
before it is ready.  This release fixes one place where this control
was missed, which could lead to a `NullPointerException`.  While this
problem can affect any core dCache service, it was noticed with the
spacemanager service.

### httpd

dCache versions including and after 2.11.0, 2.10.9, 2.9.12, 2.8.16,
2.7.21 and 2.6.36 required sites to delete existing RRD files when
upgrading; i.e., run the command `rm -f /var/lib/dcache/plots/*.rrd`
when the domain hosting the `httpd` service is stopped.  This release
reverts that change, but requires sites that have already upgraded to
repeat the `rm` command.  Sites upgrading from an earlier dCache
version do not need to delete anything.

Fix a potential `NullPointerException` in `poolCollector`.

### nfs

Protect against a `NullPointerException` if the client attempts to
read the contents of a file's level where that level exists in the
database but contains a Nil value.  This does not happen under normal
circumstances.

### pool

Previously, any problems found when the xrootd client is writing to a
pool were silently ignored: neither the pool, the client, or billing
appreciated there was a problem.  With this release, problems are
logged in billing, reported back to the client.  The client is also
disconnected.

The Berkeley DB, which may be used to store file metadata on the pool,
does not like being interrupted.  The pool tries hard to avoid
interrupting reading or writing; this release fixes one place that
slipped through.

Fix regression in the output from the info command: it did not include
statistics about the number of HSM requests and HSM timeouts.  Also
fixes how active HSM jobs are counted: cancelled jobs are still active
until the underlying job as ended.

Improve the error message reported back to the xrootd client should
its request have an invalid or missing UUID.


### Changelog 2.10.11 to 2.10.12

<!-- git log 2.10.11..2.10.12 -no-merges -format='[%h](https://github.com/dcache/dcache/commit/%H)%n:   %s%n' -->

[9de625c](https://github.com/dcache/dcache/commit/9de625c17c1b951bc81184c1f9fdb393580e3cf3)
:   [maven-release-plugin] prepare release 2.10.12

[4af8b23](https://github.com/dcache/dcache/commit/4af8b23b465b2ad27e79b9352c7b97bd3d102cf7)
:      imera: protect against NPE in FsSqlDriver#read

[df5bab0](https://github.com/dcache/dcache/commit/df5bab033a7d395c10f96c16f5506cf506cb844d)
:   xrootd: Propagate mover errors to dCache

[fb61ae4](https://github.com/dcache/dcache/commit/fb61ae428dbbac7faed34914c6bcdc94dc5433a5)
:   pool: Restore flush and stage stats in info

[3f9044d](https://github.com/dcache/dcache/commit/3f9044d5f65bea809ecfdc1c99e1c9f9e180d130)
:   pool: Improve xrootd error message on missing UUID

[6762e04](https://github.com/dcache/dcache/commit/6762e044e43066fd82d2835a6d344d044a68b513)
:   Fix NPE in cell initialization

[46940a6](https://github.com/dcache/dcache/commit/46940a62c03bc53f687f75b59d63f7284850653b)
:   Fix NPE in httpd service

[036e80f](https://github.com/dcache/dcache/commit/036e80f8f5ee7cfa01d58adf16bfc2c7b1a3e56e)
:   pool: Avoid interrupting Berkeley DB in migration module server

[8257601](https://github.com/dcache/dcache/commit/825760104c3b4395a880ab59c9fc6c615b67e257)
:   dcache-webadmin: revert rrd data source names

[9c9bc38](https://github.com/dcache/dcache/commit/9c9bc382fddb770087466a68c1483c1818111b37)
:   [maven-release-plugin] prepare for next development iteration

## Release 2.10.11

### Changes affecting multiple services

dCache will discard queued internal messages where the sender is no
longer expecting a reply (due to internal time out); this helps an
overloaded system recover quickly.  Such discarded messages are
logged.  This release provides better logging when this happens:
string commands are logged correctly and both the time-to-live and the
age have been added.

The xrootd door and, on the pool, the HTTP and xrootd movers logging
included incorrect context information, always showing the first
connection.  This has been fixed.

### alarms

Fix minor corruption at beginning of the alarms defaults file.

### httpd

In previous versions of dCache, the webadmin war file is automatically
unpacked.  This has been problematic as a dCache upgrade did not
always trigger updating the unpacked webadmin, resulting in dCache
running the older webadmin.  With this release, dCache no longer
unpacks the war file; the `webadminWarunpackdir` and
`httpd.container.webapps.tmp-dir` properties are now obsolete.


### Changelog from 2.10.10 to 2.10.11

<!-- git log 2.10.10..2.10.11 -no-merges -format='[%h](https://github.com/dcache/dcache/commit/%H)%n:   %s%n' -->

[8448a04](https://github.com/dcache/dcache/commit/8448a04ff10dda03585c7f085e87436feb247a7d)
:   [maven-release-plugin] prepare release 2.10.11

[3cbd3f8](https://github.com/dcache/dcache/commit/3cbd3f89fd120d5c3af04ab8502ab27477058f77)
:   cells: Refine TTL discard message

[f436cad](https://github.com/dcache/dcache/commit/f436cadb25f1d3fa5fcfd2af26436d60ce56a206)
:   xrootd,pool: Fix xrootd and http logging context

[5ca7b4b](https://github.com/dcache/dcache/commit/5ca7b4bde0972cf95fb9ec7b52e90f542eec0892)
:   alarms.properties fix accidental header corruption

[6f37b1c](https://github.com/dcache/dcache/commit/6f37b1c531705485df30ed7db8c2bacf2635bd8a)
:   [maven-release-plugin] prepare for next development iteration

[cca38b7](https://github.com/dcache/dcache/commit/cca38b7cddb7743f5cb81c50e63961c679556526)
:   (2.10) dcache-webadmin: change Jetty setting so .war is not unpacked



## Release 2.10.10

### Changes affecting multiple services

Doors report to billing when a file is deleted.  Previously, many
doors neglect to include the PNFS-ID and sent only the path.  This can
be ambiguous so, with this release, all doors send the PNFS-ID in
addition to the path.  Some doors also failed to send the file size
(if known) and client IP address.  These, too, have been fixed. In
summary:
 *  dcap additionally sends: PNFS-ID, file-size and client
    address.
 *  ftp additionally sends: PNFS-ID
 *  srm additionally sends: client address.
 *  webdav additionally sends: PNFS-ID and file size
 *  xrootd additionally sends: PNFS-ID.


A bug was discovered that resulted in the nlink count becoming
negative.  While wrong, this had a knock-on effect that prevented
pnfsmanager and nfs services from listing the affected directory.
With this release, directory listing are robust against such problems.

### alarms

Fix alarm definition that triggers when the pool discovers a file with
the wrong checksum.  Previously it mistakenly triggered if an upload
was incomplete.

### dcap

Create a session identifier for the duration of a client connecting.
This session identifier is available in log messages and in the
billing entries.

### gplazma

Update ldap plugin to support both RFC 2307 and RFC 2307bis LDAP
schema types.  Additionally, the memory footprint of this plugin has
been reduced and its performance improved.

### nfs

Update nfs4j to v0.9.2.  This brings some small performance benefits
when listing a directory and for reading data through NFS v3.

Fix bug where, when a client read or write activity is proxied, the
corresponding dcap mover wasn't removed if client didn't wait for the
queued mover to start.  Previously, such movers would accumulate on
the pool.

### pnfsmanager

Prevent attempts to remove the `.` and `..` directories.

This release improves the shutdown procedure.  It's now faster and
does not generate error messages if shutdown while dCache is active.

### spacemanager

When uploading a file outside a space reservation (i.e., using
implicit space reservation) on a loaded dCache instance, the
spacemanager may report a database deadlock.  These messages do not
indicate a problem: dCache behaves correctly and the upload is not
affected; however, there is an impact on performance.  With this
release, there should be no further deadlock messages and spacemanager
should place less load on the database, with corresponding increase in
performance.

### webadmin

Display the command's output in the cell admin page to use a monospace
font.

Remove a javascript error due to missing clojure dependency.

Sending commands in cell admin page is fixed.

### webdav

Fix webdav door so it no longer reports a stack-trace when the client
issues a `USERINFO` request.  The davfs2 client, in particular, issues
these requests.

### xrootd

Add a logging plugin.  This allows an admin to investigate problems
between an xrootd client and either the xrootd door or the pool.  It
is not enabled by default: sites must explicitly include the plugin in
their configuration to achieve additional logging.

Create a session identifier for the duration of a client connecting.
This session identifier is available in log messages and in the
billing entries.

### Changelog from 2.10.9 to 2.10.10

<!-- git log 2.10.9..2.10.10 -no-merges -format='[%h](https://github.com/dcache/dcache/commit/%H)%n:   %s%n' -->

[4c162a3](https://github.com/dcache/dcache/commit/4c162a38aa41deea3b82eb23a891b2df1f6a4607)
:   [maven-release-plugin] prepare release 2.10.10

[592236f](https://github.com/dcache/dcache/commit/592236f35151701c55426339119e25a4494e1ba4)
:   doors: Add pnfs ID to billing remove entries

[d4d868e](https://github.com/dcache/dcache/commit/d4d868e8c331d9428ec6536a20c9f493bd7cdee4)
:   webadmin: Fix ClassCastException in cell admin

[bec30a9](https://github.com/dcache/dcache/commit/bec30a9c478b921d6b76e562f15b75354c554d57)
:   alarms:  fix regex for checksum alarm

[1ef0e2a](https://github.com/dcache/dcache/commit/1ef0e2a0eded503d40a5bd78ec555f65fd482d1e)
:   Fix compilation for Java 7

[d741823](https://github.com/dcache/dcache/commit/d7418231338c47fa5b08be349d49036266fe6e1c)
:   webadmin: remove redundant head element in alarms panel html

[a46f2f1](https://github.com/dcache/dcache/commit/a46f2f10735077b312e68d7580b1beb2ad55c793)
:   dcache-webadmin: change output field of cell admin page to monospace font

[7274f12](https://github.com/dcache/dcache/commit/7274f12da7c9c6714b54738abe1687e859b381a6)
:   (2.11) dcache-webadmin: eliminate clojure dependency

[525962e](https://github.com/dcache/dcache/commit/525962ef69fced5b83ad202ef8ef5b2c34509590)
:   libs: update to nfs4j-0.8.3

[115cfe1](https://github.com/dcache/dcache/commit/115cfe12dc41247dabf95d383d85aac6f9daf4d5)
:   dcache-xrootd: Extend and improve xrootd access log plugin

[c5c4775](https://github.com/dcache/dcache/commit/c5c4775e650f94d14f3e6300479848d9dd03f787)
:   gplazma-ldap: pull only required attribute

[8e55ee2](https://github.com/dcache/dcache/commit/8e55ee2c75b55a52fbb66393f50cf553b4412f33)
:   gplazma-ldap: support uniqueMember based group membership query

[6c51061](https://github.com/dcache/dcache/commit/6c51061e65b192cdc0f6e456912846b187bcb81a)
:   nfs-proxy: kill mover on close

[5d7820b](https://github.com/dcache/dcache/commit/5d7820be5ba1bc815cebe489f33b415dbe00140d)
:   chimera: protect list initialization from FS inconsistencies

[8757c04](https://github.com/dcache/dcache/commit/8757c0407d3d74de9d77270e16e7f187ed435317)
:   webadmin: tidy up unavailable page slightly

[320324b](https://github.com/dcache/dcache/commit/320324baa0f040a91b7223b6c9b8c6a8362bdb70)
:   xrootd: Add access-log plugin

[3e58f42](https://github.com/dcache/dcache/commit/3e58f42e4067d9238bb0906553ada9bc7c269883)
:   xrootd: Fix compilation of backported session initialization

[d176e4c](https://github.com/dcache/dcache/commit/d176e4cbde6f871aaadb2e0152d197e35a8944a2)
:   fix WebDAV door logging stacktrace on USERINFO request

[15ec5c8](https://github.com/dcache/dcache/commit/15ec5c84b611061ec0dfa425a9554642a346577e)
:   dcap: Initialize CDC session

[a6215e6](https://github.com/dcache/dcache/commit/a6215e6935a69f6988c93d3311158e3fcfc65ea7)
:   xrootd: Initialize session

[3dbecd4](https://github.com/dcache/dcache/commit/3dbecd47163cd349203c6ed8ec9cc34e13b8e079)
:   chimera: prevent attempts to remove '.' and '..'

[077c6d8](https://github.com/dcache/dcache/commit/077c6d8a79b1ba8983a5097251baa3db2b4db7f2)
:   spacemanager: Avoid a transaction deadlock and reduce DB overhead

[0b54294](https://github.com/dcache/dcache/commit/0b54294e4e8b38e0a48efa902194d24a8db098bb)
:   pnfsmanager: Controlled shutdown of processing threads

[fe21ad9](https://github.com/dcache/dcache/commit/fe21ad937648996b77948d16b9e6ce741ad74f28)
:   srm-client: Report file level errors

[393fad1](https://github.com/dcache/dcache/commit/393fad171e9597512ccb690cb2209e45cdd20274)
:   [maven-release-plugin] prepare for next development iteration




## Release 2.10.9

### Fixes affecting multiple services

Update `dcache check-config` to print an error if site-local
configuration contains scoped properties: one that contain a '/'
character.

Fix that, under certain circumstances, the FTP and dcap doors could
log error messages against the wrong cell.  Also makes shutting down
the doors a more orderly process.

### billing

Make shutdown quieter and faster.

### httpd

Fix pool queue plots in webadmin.

### nfs

Performance improvements.

### pnfsmanager

Fix the message reported when moving (or renaming) a file or directory
and certain problems were found: the destination directory isn't a
directory, the source doesn't exist, or overwriting with different
types (e.g., overwriting a directory with a file).

Fail requests earlier that plan to upload a file if that file's path
already exists as a directory.  Previously, dCache would fail such
uploads after the file was upload (during srmPutDone).  With this
release, dCache will fail during srmPrepareToPut instead.

### poolmanager

If a site using WAAS specifies too large a Space Cost Factor then the
algorithm used for write pool selection breaks down, logging
"Unreachable statement." Starting with this release, a warning is
logged indicating the cause of the problem.

Made shutting down poolmanager more orderly and faster.

### srm

The `srm.enable.space-reservation.implicit` property is now marked
forbidden.  This means a dCache instance with this property configured
will not start.  Consider the
`spacemanager.enable.unreserved-uploads-to-linkgroups` property
instead.

### webdav

The third-party copy implementation supports the Credential HTTP
header.  If an incorrect value is specified then the error returned to
the user provides incorrect list of valid values.  This is now fixed.

### Changelog from 2.10.8 to 2.10.9

<!-- git log 2.10.8..2.10.9 -no-merges -format='[%h](https://github.com/dcache/dcache/commit/%H)%n:   %s%n' -->

[bd39c7a](https://github.com/dcache/dcache/commit/bd39c7acc087fa17cf58bb50a8780ee43ac445d0)
:   [maven-release-plugin] prepare release 2.10.9

[cdb2028](https://github.com/dcache/dcache/commit/cdb2028bb826eee3c3c775a5a4b27218dd1b78eb)
:   webdav: correct error message for incorrect Credential header value

[6cf3a1d](https://github.com/dcache/dcache/commit/6cf3a1d6e13e7d592096de153926cc7a5f5f8d67)
:   srm-client: delegate by default for https 3rd-party transfers

[8c061b0](https://github.com/dcache/dcache/commit/8c061b04171553c5e5891fd3a091b942ab126d9a)
:   chimera: Add messages to JdbcFs#move exceptions

[f37fb2a](https://github.com/dcache/dcache/commit/f37fb2ab533e5eb06fc8e48695ef7a8099574c31)
:   poolmanager: Warn when spacecostfactor is too big

[e7589b2](https://github.com/dcache/dcache/commit/e7589b24252fda35d9f4424e83d5fb910f50852a)
:   poolmanager: Warn when spacecostfactor is too big

[ac6cd39](https://github.com/dcache/dcache/commit/ac6cd3902294138f1a0ebbea3d67adf9a60ea578)
:   pnfsmanager: Check file type before overwrite

[cf33a8b](https://github.com/dcache/dcache/commit/cf33a8b88ae1aafffa21a386f9971c9efc1a70bb)
:   srm-client: Report srmPutDone failure

[d07c1a7](https://github.com/dcache/dcache/commit/d07c1a7ac3b35a0a02953dfd144cdf6745e53ba4)
:   check-config: Produce error when using scoped properties

[ec26c94](https://github.com/dcache/dcache/commit/ec26c94df25ff352763b34a816dddb5750677b4b)
:   srm: Mark srm.enable.space-reservation.implicit forbidden

[9a8fa95](https://github.com/dcache/dcache/commit/9a8fa9593564668c722f4a8966cc72cca4e3fdcf)
:   loginmanager: Associate ScheduledExecutor with the cell's thread group

[c59f668](https://github.com/dcache/dcache/commit/c59f66892ad819a2c2a2c508a5190bde5565317e)
:   pom: update to nfs4j-0.8.2

[0cf0d3f](https://github.com/dcache/dcache/commit/0cf0d3fef0bae43e8148ed453c6518f15564f7e4)
:   (2.10) pool queue plots - fix partial package refactoring and neglected removal of jndi arguments

[0f82d09](https://github.com/dcache/dcache/commit/0f82d09e3b36668b41a7af39698c7e01163faa36)
:   billing: Improve shutdown for db backend

[80186eb](https://github.com/dcache/dcache/commit/80186eb8a79803add12c2bbfff6a67d58f3463ad)
:   poolmanager: Shut down request container thread pool during shutdown

[7bf0578](https://github.com/dcache/dcache/commit/7bf0578914aa6506a59fd524dcc44a52facae8fb)
:   [maven-release-plugin] prepare for next development iteration



## Release 2.10.8

### Fixes affecting multiple services

Running the `eval` admin command so it returns a non-zero return-code
would respond indicating that a bug had been found.  This has been
fixed.

An named environment may be executed and can contain a reference to
itself.  If this recursion is unchecked, eventually memory is
exhausted and the domain would restart. Now an error is logged and the
domain is not killed.

The RPM package now includes the file `/etc/logrotate.d/dcache`.  This
is a default configuration for the logrotate application so that
domain logs are rotated weekly, with compression, retaining one year
history.

Previously, some exceptions were logged with the wrong cell context or
without any context.  This has been fixed.

#### Relative upload directories

This release adds support for upload directories that are relative to
the user's root directory. If the `dcache.user-directory`
configuration property is defined as a relative path, it is now
interpreted relative to the account's root directory.

Some sites use account-specific roots to guarantee isolation of users
from each other.  Previously, such sites had to run additional doors
to allow SRM uploads.  With this release, sites now have an
alternative: to configure dCache so that uploads are make into
user-specific upload directories.

There are both benefits and disadvantages to both approaches
(deploying extra doors, user-specific upload directories).  These are
documented in the `dcache.properties` default file (see the
`dcache.upload-directory` property).  Sites are encouraged to read
this carefully before configuring a relative upload directory.

Sites that do not use user-specific roots remain unaffected by this
issue.

All doors and pnfsmanager needs to be updated for the change to be
effective.  If the feature is not used, then there is no limitation on
upgrades.

### admin

Under certain circumstances the admin interface would hide useful
information about a bug that some admin command had triggered.  That
information is made available.

### billing

Fix indexer's inability to parse billing PoolHitInfoMessage events.

Improve error message if the indexer cannot parse a date argument.

Billing records issued by doors never included the file's size.  This
is now fixed for all doors except NFS.

The indexer includes a work-around for the lack of 4-digit year in the
billing records.  Unfortunately, this work-around was broken and could
lead to badly formatted dates being output.  This is now fixed.

The indexer will skip unrecognized records.  When the output format is
YAML the raw billing line is included as a comment.

Fixes an issue where index would output incorrect JSON output for
multiple days.

### nfs

Improve client cache consistency when creating files at rates of 1 kHz
or greater.

Fix reported `rdev` value.

### pool

Fix internal copying of files (triggered by the SRM `copy` command) so
they respect the LAN port range.

Fix migration module's random pool selection so that it does not
select pools that are full.

Fix NullPointerException triggered when using migration module's
proportional pool selection and all pools are full.

Make cancelling a migration task more robust against bugs: a cancelled
task timer is started first so, if there is a problem, the task will
timeout.

The `rep ls` command can calculate per-storage-class statistics.  This
release fixes a problem where files without a storage-info would
trigger an IllegalStateException when calculating these statistics.

Fix sweeping of files without a storage-info.  Previously an
IllegalStateException was thrown; this could be triggered by the admin
interface or by the sweeper.

Fix a problem where the pool would register free space before actually
deleting the file from the file system; for a brief moment, the pool
would appear to have more free space that is actually available.

Periodically, pools check that dCache's internal accounting of total
and free capacity does not exceed the OS supplied values for the
partition (i.e., the output from the `df` command); if they do then
the dCache internal accounting is adjusted to match.  The dCache.org
team have observed that, after a file is deleted, some seconds may
elapse before the corresponding extra free capacity is reported by the
OS.  To protect pools from this effect, the total and free capacity
check is suppressed for 60 seconds after a file was deleted.

### spacemanager

If a transient deadlock resolution error occurs, unconditionally retry
the operation and do not log it.  Such errors are part of RDBMS design
when resolving concurrent updates.

### srm

Fix the srm service's admin interface `ls` command so that listed jobs
can optionally include only those that have failed, have completed or
were cancelled.

### webadmin

Webadmin periodically creates billing graphs by querying the billing
service for the information it needs.  Previously, if this query
failed (e.g., the billing service was restarted or failed to start
first) then no further billing graphs are generated and a domain
restart is needed.  As a result of this work, the properties
`poolqplots.refresh-interval`, `poolqplots.refresh-interval-unit`,
`httpd.plots.pool-queue.refresh` and
`httpd.plots.pool-queue.refresh.unit` are no longer supported.  The
`httpd.plots.pool-queue.min-time-step` and
`httpd.plots.pool-queue.min-time-step.unit` properties now also cover
this configuration.




### Changelog from 2.10.7 to 2.10.8

<!-- git log 2.10.7..2.10.8 -no-merges -format='[%h](https://github.com/dcache/dcache/commit/%H)%n:   %s%n' -->

[4ef77da](https://github.com/dcache/dcache/commit/4ef77da9c9ad535c1eb7215e6e490d74f1050d27)
:   [maven-release-plugin] prepare release 2.10.8

[e100b34](https://github.com/dcache/dcache/commit/e100b349b7f4c2f431350a9bfd19c13494efd9f5)
:   chimera: fix unit tests

[97fa65a](https://github.com/dcache/dcache/commit/97fa65a2862d7169810ba3313c9f158a20bf2de0)
:   pool: Fix pool size health check in case of asynchronous release of space

[a11e7c6](https://github.com/dcache/dcache/commit/a11e7c6c60d1e59f5c547501332d88a2577e2644)
:   spacemanager: Suppress transient deadlock resolution errors

[7710255](https://github.com/dcache/dcache/commit/77102558ecada90e413fec0ee61e314fbc08514d)
:   pool: Fix race leading to false positices in pool size health checks

[5673c4b](https://github.com/dcache/dcache/commit/5673c4b4adcddd4fd1dc08e165a8c50bca62f6a1)
:   pool: Fix ISE in CacheEntryImpl#toString

[d5851e8](https://github.com/dcache/dcache/commit/d5851e8c7852b0e02fef972493e2808998c04672)
:   pool: Fix ISE in 'rep ls'

[c6280fa](https://github.com/dcache/dcache/commit/c6280faf4900fcb138869e29c720d42c3195c21b)
:   Made PoolQueuePlotData enum java 8 compatible.

[e25597b](https://github.com/dcache/dcache/commit/e25597b99f7228bec478c556a94beafdd20b7b45)
:   (2.10) webadmin: fix exit login in billing refresh loop

[aa873e3](https://github.com/dcache/dcache/commit/aa873e3507bf1c976d61d3f00896b2d945071746)
:   Removed comments.

[0efdd4d](https://github.com/dcache/dcache/commit/0efdd4dd58f681464a0c5f118639f9b3457ab9a3)
:   Marked refresh properties as obsolete.

[f665f17](https://github.com/dcache/dcache/commit/f665f175b81ff8fafcecd7ac8e72749adbd61198)
:   pool: Make migration task cancellation more robust

[787be04](https://github.com/dcache/dcache/commit/787be04f25a0a5eb2f412470c8044b802be47808)
:   cell: Log exceptions within the correct cell context

[d85629d](https://github.com/dcache/dcache/commit/d85629dfba3027144ae0664d84120e2d0ce4bd92)
:   pool: Fix pool selection bugs in migration module

[cf8768a](https://github.com/dcache/dcache/commit/cf8768aba8b6eebb8f0a2f84475cef8bffd5c371)
:   admin: Propopage NPE to user

[86ca482](https://github.com/dcache/dcache/commit/86ca482c36f087ea0cc98562274566865536309e)
:   chimera: query for inode generation on readdir

[c65b7fe](https://github.com/dcache/dcache/commit/c65b7fee1a987c98cc6d62fafdcc7715ea1b0356)
:   billing: Fix date handling for json and yaml output

[261183b](https://github.com/dcache/dcache/commit/261183b2f438354976b49c7e6a233a3b3234c6c9)
:   billing: Add file size to request records

[61002c8](https://github.com/dcache/dcache/commit/61002c882adb64632a7e80c9b7221df8264c1335)
:   billing: Improve error message on failur to parse date arguments

[c0392c8](https://github.com/dcache/dcache/commit/c0392c89edd8350f078fda0a9aa6044e9866fb40)
:   billing: Add billing format for PoolHitInfoMessage

[1eb71fe](https://github.com/dcache/dcache/commit/1eb71fe2ec175661e250da9d06b7618d81e3dd79)
:   (2.10) webadmin: minor improvements to rrd4j-based pool-queue plots

[403a709](https://github.com/dcache/dcache/commit/403a709c130bb84b6a4e1a2b3ad5b0390cf9f71f)
:   pnfsmanager,doors: Add user relative upload directories

[48b8e7b](https://github.com/dcache/dcache/commit/48b8e7b4714909676e82cac3f963e28486456bd7)
:   rpm: include logrotate config file

[921e569](https://github.com/dcache/dcache/commit/921e569fc83ebcf6c8ca5ef45c8bb65628107aeb)
:   srm-client: Output file level errors for sync requests

[c7dd7c0](https://github.com/dcache/dcache/commit/c7dd7c044070ce595a3313e9d29e4fb357067197)
:   pool: Respect LAN port range for internal srmcp transfers

[3d51f29](https://github.com/dcache/dcache/commit/3d51f295de38fce49ad660d354328335b95dbbaf)
:   srm: Fix listing of failed, done and cancelled jobs

[950f726](https://github.com/dcache/dcache/commit/950f726052b9561bcac82f3ddab22633265c55fc)
:   cell: Prevent interpreter stack overflow from killing the domain

[42d2907](https://github.com/dcache/dcache/commit/42d2907534516c89c681a562f702726a49db4bb0)
:   cell: Declassify eval failure as a bug

[73ee6d8](https://github.com/dcache/dcache/commit/73ee6d84a58fb0afc76199ca1312bd529f725e93)
:   [maven-release-plugin] prepare for next development iteration




## Release 2.10.7

### Fixes affecting multiple services

The nfs and srm both cache replies from gPlazma to increase the speed
of authenticating and identifying the user.  Previously transient
errors when communicating with gPlazma were also cached, delaying the
recovery time from such errors.  Now, such errors are not cached.

Fix a problem where `show pinboard` command can trigger the error:
`java.lang.IllegalArgumentException: number to skip cannot be
negative`.

Update the comments within the configuration property files to reflect
the new configuration property names.

Fix OpenMQ communications to use new configuration property names.

### dcap

Fix opening a file when space-manager enabled.

### ftp

Fix SRM uploads when the ftp door has a static root (the `ftp.root`
property) and this static root is not an ancestor (i.e., a prefix) of
the user's root.

### nfs

No longer trigger an NullPointerException when opening the
`.(parent)()` dot-command file in Chimera's root directory.

The `dcache ports` command now shows the NFS port based on the new
configuration properties.

### pool

Fix a race-condition when a user starts uploading a file that should
go to tape, deletes the file before the write is completed, then
cancels the file upload.  Previously, there was a risk that the pool
fails to delete the uploaded data.

Fix Berkley DB usage when an HSM operation is cancelled to avoid an
error logged as:

    InterruptedException may cause incorrect internal state, unable to
    continue. Environment is invalid and must be closed.

Fix xrootd support for vector read.  The problem was discovered with
ROOT v6, which reports errors like `Single readv transfer is too
large`.

Fix the dcap mover to use the new `pool.mover.dcap.port` configuration
property.

### httpd

Fix the statistics location to use `statistics.location` configuration
property.

### srm

Fix how durations are reported when reporting information about jobs
(e.g., the `ls` admin command).

Fix cleaning of upload directories for expired uploads after service
restart.

### xrootd

Fix problems when calculating a response to the kXR_set request.  If
encountered, the problem results in the following being logged, where
'nnn' in 'xrootd-disk-nnn' is some integer number:

    Uncaught exception in thread xrootd-disk-nnn java.lang.IllegalStateException: null


### Changelog from 2.10.4 to 2.10.7

<!-- git log 2.10.4..2.10.7 -no-merges -format='[%h](https://github.com/dcache/dcache/commit/%H)%n:   %s%n' -->

[be5d6ea](https://github.com/dcache/dcache/commit/be5d6ea94bb17d989058ba3d37c1aa24dc7a1f16)
:   [maven-release-plugin] prepare release 2.10.7

[45afb2a](https://github.com/dcache/dcache/commit/45afb2a9f0bd7ec782e7ff32e99d2b6a07e8e438)
:   ftp: Fix root path validation for upload directory

[9912145](https://github.com/dcache/dcache/commit/9912145ca9cc9f188b8612332acea6ffdf3d25f4)
:   [maven-release-plugin] prepare for next development iteration

[b28e2f7](https://github.com/dcache/dcache/commit/b28e2f7be33dd18330241669ba8ff50adcc100a9)
:   [maven-release-plugin] prepare release 2.10.6

[9d1b4a8](https://github.com/dcache/dcache/commit/9d1b4a8293ecbf5d49b46f5d2ff5f69b8d6ad301)
:   xrootd: Upgrade to xrootd4j 1.3.5

[d2185fa](https://github.com/dcache/dcache/commit/d2185fad29d892006554167c769988bf72443a4d)
:   [maven-release-plugin] prepare for next development iteration

[66b5982](https://github.com/dcache/dcache/commit/66b5982bf2d70aeb0de0693c59883e10cb7f1354)
:   [maven-release-plugin] prepare release 2.10.5

[e947426](https://github.com/dcache/dcache/commit/e947426b8e0e463cd55f41b1014221d91edc972d)
:   pool: Prevent interruption of replica deletion during HSM flush

[5c3f6b6](https://github.com/dcache/dcache/commit/5c3f6b6b475a3e56721ee6e3085224a4c023b496)
:   pool: Fix HSM cancellation

[6bfdfa8](https://github.com/dcache/dcache/commit/6bfdfa83d5b51c8601bd30d5de262ae032b14da8)
:   The gPlazma cache used by NFS and SRM caches both positive and negative replies. Unfortunately it also caches failures to communicate with gPlazma. This means that a transient timeout would be cached too, thus increasing the effect of the transient error.

[6ddd40b](https://github.com/dcache/dcache/commit/6ddd40baf1186598bb4c1a7ba718c672ee5462bb)
:   cells: fix IAE in 'show pinboard'

[c9c84ce](https://github.com/dcache/dcache/commit/c9c84ce0ba73bbd5f570012a90ee20df9545f36d)
:   commons: fix TimeUtils nanos to duration string conversion

[42e2a90](https://github.com/dcache/dcache/commit/42e2a905f293324613e6df361fb5d8c782855f2d)
:   pool: Fix xrootd vector read limits

[0e216e4](https://github.com/dcache/dcache/commit/0e216e43afc63082dc11056a77eb77cf84b0e73d)
:   chimera: fix NPE on '.(parent)()' for root inode

[f5852f9](https://github.com/dcache/dcache/commit/f5852f973188252c44236a42b8e8a6634dd196cd)
:   dcap: fix interaction with Spacemanager

[d6a4e2a](https://github.com/dcache/dcache/commit/d6a4e2aae614c26b0309807af474e24f38c34ac8)
:   srm-client: Fix logback configuration

[af8e546](https://github.com/dcache/dcache/commit/af8e54672959d1f35fb30bd23bce18c193a44e31)
:   srm: Fix asynchroneous job storage leak

[e513209](https://github.com/dcache/dcache/commit/e51320964bdbf621a517a4c90e52e1907bc82ea2)
:   configuration: adjust references to deprecated properties

[235237b](https://github.com/dcache/dcache/commit/235237bd0b76b74494b8d8374bae344737bdbf13)
:   unittests: increase timeouts and fix race in DiskSpaceAllocatorTest

[8d749c0](https://github.com/dcache/dcache/commit/8d749c0a89421702be927ef36e1f6c8bd048cc19)
:   [maven-release-plugin] prepare for next development iteration



## Release 2.10.4

### Fixes affecting multiple services

In some cases, dCache would log the wrong cause of an internal
failure.  This has been fixed.

The pinboard has been improved in two ways:

* The timestamp now includes AM/PM
* The memory and CPU usage has been decreased.

Two problems are fixed that affected those services that make use of
the grid trust store (/etc/grid-security/certificates): gplazma, srm,
gsiftp, webdav and xrootd:

* When a CA is found not to have a signing-policy file, subsequent
  attempts to discover a signing-policy file will automatically
  fail for one hour.  Previously, if any CA was removed since the
  service started then certain CAs (those using UTF-8 encoded
  subject RDNs) would be placed in this not-found cache by
  mistake.  This resulted users with certificates from such CAs
  would succeed the first time they used dCache but all subsequent
  attempts would fail until the cache expires or the trust-store
  is refreshed.

* A minor memory leak is fixed.  The amount of memory leaked was
  proportial to the number of different CAs in use.

Two problems are fixed that affected services providing GSI or plain
SSL authentication using the jGlobus library:

* dCache now supports TLS v1.2 clients when using GSI or plain SSL
  using the jGlobus library.

* Signal end-of-stream when remote sends a CLOSE notification.
  The remote party normally sends a CLOSE notification before
  terminating the TCP connection, typically send from server to
  client.  Previously, receiving such a notification was treated
  as an error.

Fixed thread safetly of timestamp formatting, principally used in
logging and generating the output of admin commands.


### billing

Fixes a bug where the bytes read graph can show inflated values.

### httpd

Update service to use `httpd.service.loginbroker` configuration
property rather than the generic `dcache.service.loginbroker`.

Introduce the `httpd.setup` configuration property to expose and allow
configuration of the existing mechanism to support site-specific
customisation of the httpd service batch file.

### nfs

Fix permission check when client requests a list of some directory's
contents.

Add support for mounting when the server-side mount-point is a
sym-link.

### srm

Fix the lifetime of the response when client makes a successful
request for a reservation with infinite lifetime.

Update the `info` admin command to produce scheduler information that
is easier to understand and better reflects the new scheduling.

Fix incomplete restore of "ready queued" jobs.  After restarting the
srm service, any jobs in this state RQUEUED would not be handled
correctly.  This has been fixed.

Allow credentials to be reloaded; in previous versions of 2.10 this
was ineffective and resulted in a null-pointer exception being logged
instead.

Allow srm to start if there were active bring-online requests when the
service was stopped.

Fix the `set max ready get` command in the admin interface.

Fix a problem where, if a client aborts an upload shortly after
initiating the upload then the server blocks all activity for a
timeout period.  The SRM will eventually recover but, during this
period, it appears deadlocked.

The SRM checks whether there is a door that statisfieds a users upload
request, taking into account the door's root directory.  It could be
that doors are configured so that the upload directory is not visible,
preventing any uploads.  This problem is logged so it is more obvious.

### chimera

Speed up deletes by Chimera no longer explicitly removing non-zero
levels when a file is deleted.  The database handles this
automatically.

The chimera shell failed to interpret the creation time flag when
choosing which time should be displayed in directory listing.

### Changelog from 2.10.3 to 2.10.4

<!-- git log 2.10.3..2.10.4 -no-merges -format='[%h](https://github.com/dcache/dcache/commit/%H)%n:   %s%n' -->

[5169a28](https://github.com/dcache/dcache/commit/5169a28c1cc53d221235c5c67ac1a6e0f9e7443e)                                  
:   [maven-release-plugin] prepare release 2.10.4                                                                            
                                                                                                                             
[72dedf9](https://github.com/dcache/dcache/commit/72dedf995da1331e485dec9d23659fa7c7dc8d91)
:   srm: Log common misconfiguration preventing upload

[4fa394e](https://github.com/dcache/dcache/commit/4fa394e8098e6b620ff4f7a6c10a3206e58f0f4a)
:   common: Fix race condition in AtomicCounter unit test

[eca3c50](https://github.com/dcache/dcache/commit/eca3c508b3a027636b921b9fbf43ab41eb969c48)
:   srm: Fix deadlock like bug

[a1f3d96](https://github.com/dcache/dcache/commit/a1f3d96193944fd33f8b5ad90d8520784b7aef88)
:   billing plots: use 'transferred' rather than 'size' for bytes

[dc67a13](https://github.com/dcache/dcache/commit/dc67a1321037b44e47bd936284ac22649f4b4167)
:   httpd: Use service specific property for list of login brokers

[8595102](https://github.com/dcache/dcache/commit/8595102206afa2b2cde54bcde413ad7b26ad55b0)
:   srm: Fix reporting of infinite space lifetime

[06d205a](https://github.com/dcache/dcache/commit/06d205af4bcf8ad4aa7bc6c7abff64d6cc327e78)
:   chimera: Fix creation time flag in ls command

[a65d0e5](https://github.com/dcache/dcache/commit/a65d0e57e91a96dc511dd1645e6e61f64c149c17)
:   Fix CacheException references in error messages

[adbae8e](https://github.com/dcache/dcache/commit/adbae8e9b94081961521e233c2b8f294d2dd465e)
:   srm: Align SRM info output with recent changes to scheduler configuration

[0d0bbd6](https://github.com/dcache/dcache/commit/0d0bbd69a2f347a66753217cc20628e95017eafa)
:   chimera: do not explicitly remove enties in t_level_x

[95165df](https://github.com/dcache/dcache/commit/95165dfecba96e3d982836bf5f0968ea8c7cd036)
:   cells: Improve pinboard

[7085fa2](https://github.com/dcache/dcache/commit/7085fa21c3a2137c94984999ba046bb5ad59df02)
:   libs: update jglobus to 2.0.6-rc8.d

[a75a70d](https://github.com/dcache/dcache/commit/a75a70d7d6f094adc6f188433111d9d7bac04275)
:   srm: Fix incomplete restore of "ready queued" jobs

[65de44e](https://github.com/dcache/dcache/commit/65de44efb578a1b9bd501422b7e585324ba44893)
:   Avoid thread-unsafe use of SimpleDateFormatter

[916b322](https://github.com/dcache/dcache/commit/916b3227f585527eb5a9351d03d9889663064f66)
:   srm: Fix credential store registration

[a83e308](https://github.com/dcache/dcache/commit/a83e308d5ebc6a737d4e232001e849a3c9f0b245)
:   srm: Fix restore of bring-online requests on restart

[c6c3e8f](https://github.com/dcache/dcache/commit/c6c3e8f7f13318fa904f6e1f42883a980d526474)
:   srm: Fix set max ready get command

[e6245c9](https://github.com/dcache/dcache/commit/e6245c92fac845a8c078756535a3fd8e683905a4)
:   libs: update to jglobus-2.0.6-rc7.d

[8b3c169](https://github.com/dcache/dcache/commit/8b3c169cb3238ad37c7897cf63d5c42fa01202e8)
:   libs: update to nfs4j-0.8.1

[04d1b1e](https://github.com/dcache/dcache/commit/04d1b1e0751d59591c775ba8da1857b084c1e29f)
:   [maven-release-plugin] prepare for next development iteration

[6d94f34](https://github.com/dcache/dcache/commit/6d94f3414a6d9a2b558622b0aa29e1f78a04f329)
:   build: Update to findbugs 3


## Release 2.10.3

### Utilities

Add support for an alternative ACL format for the `setfacl` command in
the chimera command.  Now, an ACL may be specified either like
`USER:7:rlwfx:o:ALLOW:FFFF` or like `USER:7:i+rlwfx:o:FFFF`.

### pnfsmanager

Previously, the automatic schema management for Chimera failed to
create an index on the `iparent` column of `t_dirs` table.  The lack
of this index results in deletions becoming progressively slower as
dCache stores more files.  If your dCache instance was created with
dCache v2.3.0 or newer then it is likely affected by this problem.
Instances created with an earlier version are not affected.  The
pnfsmanager service will check for the index when it starts and add
the index if it is missing.  Alternatively, the check may be performed
manually using the `dcache database update` command.

### pool

This release fixes several issues with the sweeper:

- Previously, the sweeper consumed considerable amount of memory while
  freeing up space; in the worse case, this could result in the domain
  running out of memory and restarting; this has been fixed.

- The `sweeper ls` command would make the pool unresponsive while the
  output is generated; now, running this command no longer prevents
  the pool from taking on more work.

- As the `sweeper purge`, `sweeper free` and `rep rmclass` commands
  can take a long time to finish, the admin interface does not wait
  for them to finish; instead, a quick response is returned and the
  command continues in the background.  Previously there was no
  indication when such commands had finished; now, the pool will log
  when the command has completed.

- The pool logs regular sweeper operations at lower priority; this
  makes the pool logs less noisy when operating under normal
  conditions.

### poolmanager

In previous versions, poolmanager would log a stack-trace if a user
attempts to open a file for reading and no read pool could be found
because a unit failed to match.  Now the failure is logged as a normal
message.

### xrootd

The xrootd door now informs billing when a user uses the xrootd
protocol to delete a file.

### gplazma

The ldap plugin allows a door to request converting a uid or gid back
to a username; currently, only the nfs door makes use of this
functionality, when generating a directory list.  In previous dCache
releases, the plugin behaved incorrectly if the uid or gid is unknown;
this is now fixed.

### Changelog from 2.10.2 to 2.10.3

<!-- git log 2.10.2..2.10.3 -no-merges -format='[%h](https://github.com/dcache/dcache/commit/%H)%n:   %s%n' -->

[ab651cb](https://github.com/dcache/dcache/commit/ab651cbb6f6c60867b1d688e05e27da5cf890d40)
:   [maven-release-plugin] prepare release 2.10.3

[577f16f](https://github.com/dcache/dcache/commit/577f16f3f1ec186e5133519e66971e82d923bdd7)
:   chimera: mark as-run if i_dirs_ipnfsid exists

[0f1cea4](https://github.com/dcache/dcache/commit/0f1cea448091c58ec0a492fd5b91b9b0e8ab5121)
:   solaris: fix solaris package script and add work-around for pkgmk bug

[e1dd257](https://github.com/dcache/dcache/commit/e1dd25754f679e0a347c9a1c532a8cda6cf3c93f)
:   acl: add heuristic to detect acl format

[7f9ef6d](https://github.com/dcache/dcache/commit/7f9ef6d7caefb0861aa1fa292c324c7e06b7c0c7)
:   chimera: create missing index i_dirs_iparent

[0bfaa7e](https://github.com/dcache/dcache/commit/0bfaa7edb47fc67083993acd4a02e6a06f946c7c)
:   pool: Resolve high memory usage and other issues in sweeper

[befad25](https://github.com/dcache/dcache/commit/befad2578ed7834138b25beba3322df6dc6ca123)
:   info: Fix HashMap ordering assumption in unit test

[08f7865](https://github.com/dcache/dcache/commit/08f7865e7a6ff56f3f26461c2130bd0f2e25a2c3)
:   Make JDK byte code verification bug workaround Java 8 compatible

[fc19b7a](https://github.com/dcache/dcache/commit/fc19b7adc60f88c6846126f6311c2ab5ae0839f0)
:   gplazma: Fix JVM implementation dependency in unit test

[639653f](https://github.com/dcache/dcache/commit/639653f80f0337f8e8155c4497ef541683b1cef5)
:   poolmanager: Suppress stack trace in case of unmatch units

[92fe17a](https://github.com/dcache/dcache/commit/92fe17a59a3be1711c5fe8276133fcdf89272421)
:   xrootd: Add billing entry on delete

[ca6c026](https://github.com/dcache/dcache/commit/ca6c0268b9c016252ce7cff55b7b9a8fb147a4c5)
:   bugfix: fix reverseMap not throwing NoSuchPrincipalExceptions

[8e7edbc](https://github.com/dcache/dcache/commit/8e7edbc121ebdfac7afa0b2b4011e4347bca1b53)
:   [maven-release-plugin] prepare for next development iteration





## Release 2.10.2

### Cell startup

Fix potential dead-lock when a dCache domain is starting.  The problem
is triggered when a cell receives a message while initialising.  If
dCache is started "from cold" then this cannot happen.  However, if a
domain that contains well-known cell restarts while the rest of dCache
is operational then the problem could be triggered.  For example, if a
door domain ran out of memory then there is a small risk that the
domain would not restart correctly.  The problem was present since
dCache v2.8.0 and is fixed with this release.


### Changelog from 2.10.1 to 2.10.2

<!-- git log 2.10.1..2.10.2 -no-merges -format='[%h](https://github.com/dcache/dcache/commit/%H)%n:   %s%n' -->

[44daad1](https://github.com/dcache/dcache/commit/44daad1dca4833d1c326938236a608e86570d3a9)
:   [maven-release-plugin] prepare release 2.10.2

[333a819](https://github.com/dcache/dcache/commit/333a819d9fafaf2595e67dd75506e37d5d081dbd)
:   cells: Fix deadlock during startup

[fa3b2f1](https://github.com/dcache/dcache/commit/fa3b2f10fa74f5a247531c2effa263b7fde4220e)
:   [maven-release-plugin] prepare for next development iteration



## Release 2.10.1

### cell communication

The decision on which cell communication system to initialise was
based on the (old) `broker.scheme` configuration property and ignored
the (new) `dcache.broker.scheme` configuration property; this has been
fixed.  Note that configuration using the old `broker.scheme`
continues to be supported for backwards compatibility.

### billing

Update to use the `billing.text.dir` configuration property instead of
`billingLogsDir`; the latter is still supported for backwards
compatibility.


### dcap

When the client authenticates via GSI, the dcap door will check the
user certificate (generally, a voms-proxy certificate) to extract the
DN and primary FQAN.  To do this, it needs to know where the trusted
CAs and trusted VOMS server identities are stored; these are typically
`/etc/grid-security/certificates` and `/etc/grid-security/vomsdir`
respectively.  Previously, dcap ignored the `dcap.authn.capath` and
`dcap.authn.vomsdir` properties.  With this release, these properties
are honoured.

### pool

If a stage request has been forwarded to the nearline subsystem and
the file is deleted then the stage request is now cancelled.

Nearline storage configuration is now applied atomically rather than
one attribute at a time.

The maximum number of concurrent nearline operations may be adjusted
using the `hsm set` admin command.  Previously, if the concurrency is
increased then additional activity is only started as more requests
are received, ignoring any existing backlog.  This has been fixed so
increasing the concurrency limit will immediately start more activity
if there is a backlog of requests.

This release reduces the CPU processing required when starting a
third-party HTTPS transfer.

When transferring files to some third-party service using HTTPS, the
remote host must provide a trusted certificate.  The trust material
(CA certificates and CRLs) that are necessary for this are now
refreshed without requiring the pool to be restarted.

### poolmanager

Stage and pool-to-pool transfers, triggered by poolmanager, are
monitored by poolmanager querying the source pool to check if the
request is still active.  In previous versions of dCache, for n
transfers from a pool, this monitoring generated O(n*n) of network
traffic.  In particular, poolmanager's monitoring of bulk staging
requests can result in sufficient network traffic between the pool and
poolmanager that other dCache activity is impacted.  With this
release, the monitoring traffic is reduced in general, most
prominently for large concurrent activity, such as bulk stage
requests.

The `rc destroy` command has been removed.  The implementation was
incomplete and the operation was dangerous.

If the door resubmits a request to poolmanager that triggers staging
of a file, poolmanager uses additional memory while waiting for the
stage to complete.  For bulk staging, this additional memory usage can
be significant, potentially resulting in poolmanager exhausting the
available memory.  This release updates poolmanager so a door
resubmitting a stage request does not increase the memory footprint of
poolmanager.

The poolmanager has an incomplete feature called 'clumping'.  This is
where poolmanager can handle multiple select-pool-for-read requests
for the same file as a single request.  There is a hard-coded clumping
limit that prevents too many files from being handled together; this
allows poolmanager to choose an alternative pool when staging or
replicating to make the file available.  Once this limit is reached,
subsequent open requests for the same file will fail in poolmanager.
Doors handle this failure differently; the xrootd and webdav doors
propagates this failure back to the client, while the dcap and ftp
doors will resubmit the request to poolmanager.  This release
increases the clumping limit from 1 to 20; it also changes the
behaviour of the doors so all will retry the pool-selection if the
clumping limit is reached.  This fixes the 'request clumping limit
reached' failures.

This release fixes a race-condition between two clients opening the
same file.  Previously, if poolmanager starts processing the second
open request as it is finishing processing the first then there is a
tiny chance that the second request is lost.

### srm

The srm service will check the user certificate (generally a
voms-proxy certificate) to extract the DN and primary FQAN.  To do
this, the srm service needs to know where the trusted CAs and trusted
VOMS server identities are stored; these are typically
`/etc/grid-security/certificates` and `/etc/grid-security/vomsdir`
respectively.  Previously the SRM ignored the `srm.authn.capath`
property and there was no way to configure the trusted VOMS server
identity path.  With this release, the `srm.authn.capath` is
honoured and the `srm.authn.vomsdir` property is introduced.

When the SRM server sends an asychronous response to the client, the
client must make subsequent queries to check if the request has
completed.  Part of each response is a hint suggesting for how long
the client should wait before querying for a progress update.  Prior
to dCache v2.9, the srm service provided this hint where subsequent
responses suggested a longer wait time.  With v2.9, this feature was
lost, resulting in the SRM client hammering the srm service.  This has
been fixed.

When the SRM client wants to initialise a download (using the
srmPrepareToGet call) for a file that is already online there is a
very small risk that the srm service will hang and provide no reply.
This has been fixed.

When processing a srmBringOnline request, the server checks there is
at least one transfer protocol that both the client and server
support.  In previous versions, this was checked when processing each
file in the srmBringOnline request, failing the file if no common
transfer protocol is found.  This has been updated so the transfer
protocols are checked once for the entire request.  This new behaviour
matches how the transfer protocols are checked for other types of SRM
requests.

### webdav

Update door to use the `webdav.root` configuration property instead of
`webdavRootPath`; the latter continues to be supported for backwards
compatibility.

Allow more control over webdav door behaviour; in particular, thread
usage and connection handling.  This allows sites to tune their door
to match hardware capabilities and client activity.  The following
configuration properties are introduced `webdav.limits.acceptors`,
`webdav.limits.idle-time`, `webdav.limits.idle-time.unit`,
`webdav.limits.low-resource-idle-time`,
`webdav.limits.low-resource-idle-time.unit`,
`webdav.limits.handshake-time`, `webdav.limits.handshake-time.unit`,
`webdav.limits.backlog`, `webdav.limits.threads.max`,
`webdav.limits.threads.min`, `webdav.limits.threads.idle-time`,
`webdav.limits.threads.idle-time.unit`, `webdav.limits.queue-length`,
`webdav.limits.graceful-shutdown`,
`webdav.limits.graceful-shutdown.unit`.  See the `webdav.properties`
defaults file for more details.

If the client reads or writes through the door and the door detects a
lack of progress then it will cancel the transfer.  Previously, the
door did not kill the mover, leaving it to time out.  With this
release, the door will kill the mover when it cancels the transfer.

The door is updated so, when a client initialises a third-party
transfer, the distinguished name and primary FQAN comes from the
gplazma login result rather than being generated locally.  This change
means the node hosting the webdav door does not require a vomsdir
setup.

### xrootd

Previously the xrootd batch service required the user to specify a
non-empty pool queue for uploading.  This requirement has been
relaxed.


### Changelog from 2.10.0 to 2.10.1

<!-- git log 2.10.0..2.10.1 -no-merges -format='[%h](https://github.com/dcache/dcache/commit/%H)%n:   %s%n' -->

[b14aa7f](https://github.com/dcache/dcache/commit/b14aa7fdf7858ab8a83d92f92c3c15199e9567f1)
:   [maven-release-plugin] prepare release 2.10.1

[33a7ec7](https://github.com/dcache/dcache/commit/33a7ec72b484fb47c0e5638b7f8c2978af0aa79e)
:   srm: srm,dcap: Use configured vomsdir and capath

[cc0c6d6](https://github.com/dcache/dcache/commit/cc0c6d6d5ce1d3914b119735aff5be0ddbcdf655)
:   build: add work-around for JDK bug and PowerMock

[85e97f7](https://github.com/dcache/dcache/commit/85e97f7a8e3d10c8b5d879ac595666c72bd2445c)
:   pool: Fix concurrency settings for script nearline storage

[63cbc4e](https://github.com/dcache/dcache/commit/63cbc4e528e3758d727c4670d91f0cf8cc6a2c9d)
:   poolmanager: Fix 'request clumping limit reached' failures

[ca2afba](https://github.com/dcache/dcache/commit/ca2afba19a8255fc1bc401f871a83cfabf44c981)
:   poolmanager: Avoid request leak

[e970b90](https://github.com/dcache/dcache/commit/e970b9051601cc353edef5496a0d920152c5bce6)
:   srm: Fix race condition in srmPrepareToGet

[b85329b](https://github.com/dcache/dcache/commit/b85329b90098e869f847d7378e3f4bc72f3c437a)
:   webdav: Fix certificate handling for HTTP third-party copy

[9051f82](https://github.com/dcache/dcache/commit/9051f8272b6bb2e7351dcdaebe7e1efe0bdf407a)
:   poolmanager: Fix excessive p2p and stage alive checks

[04db77b](https://github.com/dcache/dcache/commit/04db77bdcd3fa1552d08035d9a8d68333d4af822)
:   srm: Restore estimated wait time update

[f0951c1](https://github.com/dcache/dcache/commit/f0951c1c219c02aa046a384b4f7c992079b9b82a)
:   webdav: Kill mover in case transfer times out

[87ad152](https://github.com/dcache/dcache/commit/87ad1525b0360ea02e9e63a3214c6b0c46039a59)
:   webdav: Make threading and TCP connection limits configurable

[ce24ff6](https://github.com/dcache/dcache/commit/ce24ff67bf2794201022f05db4e318d4ce9c36c5)
:   pool: Fix several minor issues in nearline storage subsystem

[4a2b9b5](https://github.com/dcache/dcache/commit/4a2b9b5c48a98e102aea286e6dd6f4c3fa9587f0)
:   srm,dcap: Use configured vomsdir and capath

[3d3263f](https://github.com/dcache/dcache/commit/3d3263f47d3ac9f3c2b312b09e803ce383d9da96)
:   Don't use legacy properties

[14dbed7](https://github.com/dcache/dcache/commit/14dbed7acd70ad2a9a8639f51fed8dfdb352014d)
:   [maven-release-plugin] prepare for next development iteration




## Release 2.10.0

### Changes affecting several services

#### Libraries

Updated Spring to v4.0.5, AspectJ to 1.8.1, SMC to v6.3.0, Jetty to
8.1.15.v20140411, Wicket to v6.16.0, Guava to v17.0, HikariCP to
v1.3.9, Netty to v3.9.2.Final, BerkleyDB v6.0.11, Apache
commons-compress 1.8.1, Scala v2.11.1

#### Logging FTP client disconnects

The FTP protocol contains commands that a client uses to indicate that
it is about to disconnect from the server.  Not all clients use this;
some simply disconnect the network connection, which is unfortunate as
dCache cannot know whether or not this indicates a problem with the
client.

dCache logs when the client disconnects unexpectly (without using the
BYE command).  Previous versions of dCache also logged this in
pnfsmanager and spacemanager but, with v2.10, dCache no longer logs
these events in either service; logging in the door continues.

#### Messaging

Most messages sent from one dCache cell to another are requesting some
information or that some action should take place.  These messages
include an expiry date.  The expiry date provides a hint when the
response message will not be of interest.  For example, when the srm
sends a message to gplazma (to log the user in), the srm will fail the
request if it doesn't receive a response from gplazma within some
timeout period (3 minutes, by default).  Therefore, after 3 minutes,
the srm is not interested in the reply from gplazma.

Services can make use of this information and reject messages where it
cannot reply in time.  This is most useful when dCache is recovering
from being overloaded: dCache can recover faster because it can reject
some of the backlog of work.

In previous versions of dCache, this behaviour was limited to
pnfsmanager and the pool's migraion module.  With dCache v2.10, this
behaviour applies to all services.

Certain messages request the current status of a service.  Often, the
result of these queries provides similar information.  Currently, for
certain pieces of information, objects are created afresh, despite
there being relatively few distinct values.  With 2.10, these
same-valued Strings are represented by the same object, reducing the
memory footprint of services, especially webdamin.

#### Kerberos

dCache will now use the kerberos configuration in `/etc/krb5.conf` by
default.  The existing configuration is still supported, but the
system configuration file is now taken as the default.

#### http third-party transfers

dCache v2.10 sees greatly improved support for HTTP third-party
transfers.  These are transfers between dCache and some other HTTP
server, so that the traffic does not go through the client.

In keeping with gsiftp, http third-party transfers are initiated on
the pool.  dCache now supports both pull and push transfers.  A pull
transfer is where the pool fetches a file from the remote server using
the HTTP GET method.  A push request is where the pool uploads a file
to the remote server using the HTTP PUT method.

A transfer can use either an unencrypted transport (`http://...`) or
make use of SSL/TLS encryption (`https://...`).  If an SSL/TLS
transport is used then the pool can use an X.509 credential when
establishing the SSL/TLS connection.

Both transfer directions (push and pull) will attempt to check the
integrity of the transferred data. For pull requests, all data
integrity information comes from the headers supplied in the GET
response. For push requests, the pool will make a subsequent HEAD
request and use the supplied information to verify the data was sent
correctly.

For push requests, if a PUT request is successful but the subsequent
HEAD request reveals data corruption then the pool will attempt to
delete the file with an HTTP DELETE request.  If this DELETE fails
then the error message is updated accordingly. For pull requests, no
additional cleanup steps are needed.

File checksum values are discovered via the RFC 3230 extension to
HTTP.  Unfortunately, this is not widely supported by HTTP servers;
therefore, dCache supports two levels of data integrity checking: weak
and strong. Weak data integrity is satisfied when

  * the remote service and the dCache server agree on the content
    length,

  * none of the checksums supplied by the remote server (if any)
    disagree with the checksums known by dCache.

Strong data integrity is satisfied when, in addition to satisfying the
weak conditions:

  * there is at least one checksum supplied by the remote server that
    agrees with a dCache-local checksum.

Weak data integrity can be satified by any HTTP server whereas strong
data integrity requires an HTTP server with RFC 3230 support.  A
transfer satisfying weak integrity might not check the checksum values
match; strong integrity requires that checksums exist and match.

Third-party HTTP transfers also allow the client to specify zero or
more (arbitrary) headers when requesting a file be transferred. This
allows the client to customise the HTTP request the pool sends to the
remote server.  Such headers could include authorisation information
or some other information to steer how the remote server handles the
HTTP request.

Third-party transfers may be initiated by the webdav service and the
srm service.  See the following sections on those services for details
on how to trigger third-party copying.

### Changes to services

#### ssh1

The ssh v1 admin interface has been removed; ssh v2 is now the only
way to connect to the admin interface.

#### webadmin

The active transfers page has been reimplemented.  The new
implementation focuses on faster rendering, faster issuing of
commands, and a reduced memory footprint.

#### webdav

The WebDAV door uses the StringTemplate language for generating
directory listings for web-browsers and for error pages.  With
previous versions of dCache, a missing or unreadable template file
resulted in a NullPointerException.  With dCache v2.10, there is a
hard-coded "broken dCache" page that describes the problem and
suggests how to fix it.

dCache v2.9 saw the introduction of an activity log that recorded SRM
and FTP commands and their corresponding responses in the log file
_Domain_.access.  This allows easy investigation of client-specific
problems.  With v2.10, support has been extended to include
HTTP/WebDAV requests.  The access file now includes a single line for
each HTTP/WebDAV request.  Logged information includes the mapped
user, the request method, the URL, the numerical response code and
explanation, the client IP address, and the user-agent.

The default HTML rendering of directory listings and error messages
has been updated to use the Bootstrap framework, which supports a rich
set of features.  This new default provides a deliberately toned-down
presentation.  The default page now contains two links for each file:
one that hints the browser should show the content and the other that
the browser should download the file.  As before, admins may customise
the rendering of directory listings and error messages.  To support
clients with poor or no Internet connection, all required javascript
libraries and Bootstrap files for the default layout are included with
dCache.  This release also fixes a rendering bug in the breadcrumbs.

##### third-party transfers

The webdav door now supports requesting third-party file transfers.
This is an extension to the WebDAV COPY command, which is normally
limited to internal copies.  A client may request a file be
transferred to a remote site by specifying the remote location as the
`Destination` HTTP request header.  Currently supported transports are
GridFTP (destination URI starts `gsiftp://`) and HTTP.  For HTTP both
plain (`http://`) and with SSL/TLS (`https://`) are supported.

The `Credential` HTTP request header may be used by the client to
describe whether or not the pool should use a delegated credential
when transferring the file.  The accepted values are `none` and
`gridsite`.  If `none` then no credential is to be used; if `gridsite`
then a delegated credential is to be used.  If the `Credential` header
isn't specified then a transport-specific default is used: for gsiftp
and https transports the default is `gridsite`; for http transport the
default is `none`.  Some combinations are not supported: gsiftp with
`none` and http with `gridsite` are not supported.

If a delegated credential is to be used, the client must delegate a
credential to dCache using the delegation service, which is part of
the srm service.  If no useful certificate could be found, the webdav
door will redirect the client to itself and include the
`X-Delegate-To` HTTP header in its response.  This header contains a
space-separated list of delegation endpoints.

For 'http' and 'https' transfers, the client may choose whether to
require weak or strong verification; see above for a definition of
these.  The `RequireChecksumVerification` header controls this
behaviour; if this header has a value 'true', strong verification is
required.  If 'false', weak verification is sufficient.  If the header
is not specified, a configurable default value is used.

Again, for 'http' and 'https' transfers, the client may specify
additional or replacement HTTP headers that the pool should use when
making the transfer.  These are specified as headers that start
`TransferHeader`.  This prefix is removed and the header used by the
pool.  For example, to have the pool use basic authentication with
userid 'Aladdin' and password 'open sesame', the client would add the
following header to its request:

    TransferHeaderAuthentication: Basic QWxhZGRpbjpvcGVuIHNlc2FtZQ==

Once the transfer is accepted, the client will receive periodic
progress information.  If the client closes the TCP connection, the
transfer is cancelled.


#### alarms

The alarms system, through the logback library, has always supported
sending emails if an alert is found.  However, enabling this feature
required editing an XML file.  With dCache v2.10, the standard dCache
configuration now includes properties that allow the admin to
configure this behaviour through dCache's normal configuration
properties.



#### space-manager

If a space reservation is over-subscribed, the free space is shown as
a negative number.  This breaks the layout, with that line being badly
formatted.  This is fixed with dCache v2.10

#### dcap

The dcap door has been made more robust when processing unexpected
replies from other dCache services.

#### admin

The prompt shown in the admin interface has changed from green to
bold.  This is in keeping with other dCache CLIs.

For many services, if the 'info' command is called after a cell is
accepting commands but before initialising has completed, a
NullPointer error is produced internally and no information is
provided.  This has been fixed.

#### billing

Billing messages are no longer sent to the pinboard, so the 'show
pinboard' admin command is now limited to showing information about
the service itself.

Some of the information about a transfer is written as a
colon-separated list of items.  In previous versions of dCache, the
protocol version and client hostname were not separated, resulting in
entries like:

    {Http-1.1zitpcx6184.desy.de...}

With dCache v2.10, this has been fixed for the http and xrootd
transfers, so entries now are correctly separated:

    {Http-1.1:zitpcx6184.desy.de...}



#### info

The info service, which collects and collates information from various
dCache components, now supports presenting the gathered data in
different formats.  Previous versions of dCache only supported a
dCache-specific XML format.  With dCache v2.10 two additional formats
are available.

There are two ways the client can choose the format.  The HTTP client
can specify the MIME type as the "Accept" request header;
JSON-specific clients may do this automatically.  The alternative is
to append "?format=_some_format_" to the URI; e.g.,
`http://httpd-service.example.org:2288/info/summary/pools?format=json`.
There are four supported MIME types (`application/xml`, `text/xml`,
`application/json` and `text/x-ascii-art`) and three supported formats
for '?format=' (`xml`, `json` and `pretty`).  The default format
continues to be XML.

#### srm

dCache v2.10 sees a major overhaul in how the srm controls and limits
its interaction with other dCache services.  The following sections
describe these changes.

##### Background

The SRM protocol has the concept of a client's request not being
processed immediately, with the request being queued prior to any work
being conducted.  This is most apparent for asynchronous requests,
where the client reconnects periodically to discover what progress, if
any, has taken place.  The following also applies for synchronous
requests (where the client waits to learn the result of the query);
however, the client is oblivious of these details.

In general, a successful request will start out in a "queued" state.
After dCache starts processing the request, the request will have an
"in-progress" state.  For transfer requests (GET or PUT), the request
will be in a "ready" state when there is a TURL for the client to use,
and in a "success" state after a successful transfer.  For
non-transfer requests (LS, BRING-ONLINE, ...) the request will go into
the "success" state once dCache finishes processing it, skipping the
"ready" state.

To answer most client-issued requests, the srm service must trigger
some activity in other dCache services.  For the most part, the srm
service simply issues requests to other services, collects the
responses and converts them into a corresponding SRM reply.

The srm service has several execution pools to throttle processing of
requests.  These limits are applied to individual files, so, for
example, from a single request to read 10 files, each of the files is
scheduled as if there were 10 requests, each reading a single file.

Prior to dCache v2.10, the srm throttled itself by limiting the number
of requests it can process concurrently. Once this limit is reached,
additional requests are placed in a queue with a limited capacity.
Once this queue limit is reached, subsequent requests are rejected.
The effect is to throttle the frequency of messages being sent.

In practice, a single thread could easily saturate the rest of dCache,
which meant that this was not a particularly effective way to throttle
the srm service.

Furthermore, the queue limits would also affect requests that had
already begun processing. Thus under high load, one could observe
requests being failed even if they had already started processing. At
least in theory, this could lead to a starvation problem, in which a
lot of processing could take place while no requests would ever
succeed.

##### New approach

Rather than rate-limiting the delivery of internal messages, dCache
v2.10 provides the ability to limit the number of requests in each of
the different states mentioned above ("queued", "in-progress" and
"ready").  This is taking into account "in flight" requests.

There are now three types of limit: __max-requests__,
__max-inprogress__ and __max-transfers__.

  * The __max-requests limit__ controls the total number of requests
    that are queued or being actively worked on.  Once this limit is
    reached, any more requests from an SRM client are rejected.

    This limit allows the srm service to protect against running out
    of memory.  Setting a value too low will result in the srm not
    fully utilising the available memory; setting it too high will
    risk running out of memory under heavy load.

  * The __max-inprogress limit__ controls the concurrent activity
    within dCache; once this limit is reached, subsequent requests are
    either queued or rejected, depending on the max-requests limit.

    This allows the srm service to stop itself from overloading core
    dCache services when processing SRM requests.  The max-inprogress
    limit also controls the maximum number of staging requests for GET
    and BRING-ONLINE requests.  For COPY requests, it sets the maximum
    number of current transfers.

    Setting the value too low will result in the srm artificially
    limiting its performance, as requests will needlessly spend time
    queued.  Setting the value too high will risk overloading core
    components when the srm service is under heavy load.

  * The __max-transfers limit__ controls the number of TURLs handed
    out to clients. Once this limit is reached, the srm keeps
    subsequent requests that have a TURL in the in-progress state -
    at least from the point of view of the client. Internally, such
    requests are in the "ready queued" state and no longer count
    towards the max-inprogress limit. Once the SRM client completes
    transfers, those requests that have a TURL but are in the ready
    queued state can become ready.

    This limit is mostly to allow dCache to protect pools by limiting
    the number of concurrent transfers.  It will also provide some
    protection for the transfer doors (typically ftp) and poolmanager.

    Since this limit type affects only transfers, setting the value
    too low will result in artificially poor transfer rates (with
    client requests spending a large amount of time in the
    "in-progress" state despite having a TURL) while other SRM
    requests are processed quickly.  Setting the value too high risks
    overloading pools when dCache is under heavy load.

There are request-specific properties that may be configured for each
of these three types of limit.  These have names like
`srm.request.TYPE.{max-requests, max-inprogress, max-transfers}`,
where `TYPE` is one of `get`, `put`, `ls`, `bring-online`, `copy` or
`reserve-space`.

For example:

 * `srm.request.bring-online.max-inprogress` controls the maximum
   number of concurrent staging requests.

 * `srm.request.get.max-transfers` controls the maximum number of
   concurrent downloads (maximum number of TURLs handed out at any
   time).

 * `srm.request.ls.max-requests` controls how many file metadata and
   directory listing queries to allow (either actively being processed
   or queued) before rejecting new requests.

The max-requests limit properties (`srm.request.get.max-requests`,
`srm.requests.put.max-requests`, etc) all take a common default value
controlled by the `srm.request.max-requests` property.  The current
default value for `srm.request.max-requests` is 10,000.  Note that the
`srm.request.max-requests` value applies to each SRM request type
(GET, PUT, BRING-ONLINE, ...)  independently.  Therefore, the overall
maximum number of requests is six times the configured value.

The max-inprogress properties (`srm.request.get.max-inprogress`,
`srm.request.put.max-inprogress`, etc.) all take individual default
values.  The current default values are to allow concurrent processing
of 10,000 BRING-ONLINE requests, 1,000 GET and COPY requests, 50 PUT
requests, 50 LS requests, and 10 RESERVE-SPACE requests.

The two max-transfers properties (`srm.request.get.max-transfers` and
`srm.request.put.max-transfers`) take pre-2.10 srm configuration
properties as default values.

As with prior versions of dCache, if a request suffers a transitory
failure, the srm will retry the operation after waiting awhile.  Prior
to 2.10, such retries were treated specially.  With 2.10, the retry is
treated as if it were a fresh request, so is subject to the three
limits described above.

##### srm protecting itself

The srm service continues to protect against trying to process too
many requests concurrently.  As with pre-2.10 srm, this is achieved by
scheduling activity using a set of threadpools.  These are controlled
by the srm.request._type_.threads configuration property, where _type_
is one of {get, bring-online, put, copy, ls, reserve-space}.  These
all take `srm.request.threads` as a default value.  The threadpool
sizes also accept pre-2.10 configuration (for example,
srm.request.put.threads takes the value of srmPutReqThreadPoolSize as
a default value).

##### Notes for sites upgrading

We have tried to reduce the impact of this change by continuing to
support some pre-2.10 configuration.  However, since this change
reflects a new processing model, sites should expect that some
configuration changes are needed.  Therefore, admins are recommended
to familiarise themselves with the new scheduler options and adjust
their configuration accordingly.

The `dcache check-config` command will describe which configuration
properties are no longer supported, and so may indicate the need for
alternative configuration.

#####  HTTP third-party transfers

The srm service now supports http and https transfers in both pull
(dCache pool makes an HTTP GET request) and pull (pool makes an HTTP
PUT request) operations.  The SRM client can steer the transfer by
supplying ExtraInfo arguments.  The ExtraInfo arguments are a set of
arbitrary key-value pairs that the client can specify when making the
request.  The currently supported ExtraInfo keys are:

 * `verified` If set, takes a value of either `true` or `false`.  This
    controls whether weak or strong verification is required.  If set
    to false then weakly verified transfers are successful.  If set to
    true then a transfer must be strongly verified to be successful.

 * `header-`. All ExtraInfo elements that start "header-" are
    converted into HTTP headers.  The HTTP header key is the ExtraInfo
    key without the initial "header-".  The HTTP header value is the
    ExtraInfo value.  These HTTP headers are used when the pool makes
    a request.

If the SRM client delegates a credential as part of the GSI
connection, this credential is used to authenticate when the pool
makes an SSL/TLS-based connection to the remote server.  If the client
doesn't delegate then dCache will attempt the transfer without any
client credential.

See the above section on HTTP/HTTPS third-party transfers for more
details.


##### Other srm improvements

The dCache srm implementation places client requests into one of a
number of internal states.  Each of these internal states broadly
correspond to a single SRM state, as described above ("queued",
"in-progress", ...).  With dCache v2.10 this similarity has been made
more explicit and, as a result, some incorrect mappings have been
fixed.

Previously, the srm would log "illegal state transition" messages if a
user aborts a request involving more than one file.  This has been
fixed.

If the srm service sends a message to some other service due to some
client request (e.g., prepareToPut), and the response from this
message takes too long, the srm service will fail the client request.
It could happen that, after the client request has been failed, the
srm service receives the reply message, stating the requested
operation was successful.  If this happens then the client will see
dCache in an inconsistent state: the srm service told the SRM client
its request failed, yet its request resulted in successful activity.
In the case of preparing for uploading a file, pinning a file and
creating a space-reservation, the srm service can safely "undo" the
effect of the message by removing the temporary upload directory,
unpinning the file, or releasing the space-reservation.  This
behaviour has been added with dCache v2.10.

The error message sent to the SRM client if the srm service receives
certain malformed LS requests has been improved.

The output of the admin interface 'ls' command (which provides an
overview of the current requests and allows more detailed information
about any specific request) has been improved.  The timestamps are
easier to read; the history also shows the time spent in each internal
state.  Also, a lot of "noise" has been removed, making it easier to
understand what is happening.

#### pool

Wake up sweeper if new entry is added.

Make pool-to-pool transfers more robust against two problems: busy
networks during the initial phase of the internal transfer (when the
mover is queued) and the source sending the URL for the transfer just
as the destination was giving up.

The allocate-now (NFS-only) garbage-collection now also utilises all
reclaimable space.

The classic dCache behaviour is to block when a client writes into a
file and there is insufficient space to satisfy the request.  For the
NFS protocol, this blocking behaviour is seen by the client as the
server being unresponsive and will trigger the client banning the pool
and attempting to recover by sending subsequent IO to the door.  For
NFS v4.1 traffic, writing through the door is not supported, so the
upload will fail.  With dCache v2.10, when the pool runs out of space,
this information is relayed back to the NFS client so it can behave
correctly.

The number of files has been added to the output from the 'info'
command.

#### poolmanager

The wrandom partition type has been removed.  The same behaviour may
be achieved with the WAAS partition type.

#### gplazma

The nis plugin will fail if no matching pincipal was found.

The ldap plugin default value has been updated.

The xacml plugin now supports the gums server returning GID values.

#### nfs

The nfs door may now be configured whether or not it is well-known.

The admin interface for the nfs door has been updated to include
better on-line help.

The 'pool reset id' command has been added to the nfs door to reset
pool's device id.  This command is used to recover from unknown
failures: the Linux kernel may choose to ban a pool (due to some real
or imagined protocol violation) and send IO through the NFS door.
This command allows the door to simulate a pool being rebooted,
triggering the client to reassess its opinion of the pool.

#### ftp

Additional, useful information has been added to the output of the
info command for the cell handling a client's command channel.

#### pnfsmanager

The error message reporting a problem when a user cancels an upload
has been fixed.

When querying for a file's checksum values, the chimera pnfsmanager
plugin would try each supported checksum algorithm.  In most cases, a
file will have only a single checksum value, so many queries gave no
additional information, but placed load on the PostgreSQL database and
increased latency.  Now such requests are handled with a single
database query.

#### Scripts

The `dcache-star` command has been updated so it will create a valid
(albeit empty) StAR record if there is a database connection failure.

The `dcache billing` command has been extended to support the
`--since` and `--until` options.  These allow reports to be generated
within a specific period.  The output has been enhanced so search
results can be provided in JSON or YAML format, in addition to the
existing raw and files format.  Please be aware that the JSON and YAML
formats are not finalised: future versions of dCache may make slight
alterations as experience is garnered.



### Changelog from 2.9 to 2.10.0

<!-- git log 2.9..2.10.0 -no-merges -format='[%h](https://github.com/dcache/dcache/commit/%H)%n:   %s%n' -->

[befd0f8](https://github.com/dcache/dcache/commit/befd0f8d00587606e435bcd4b4f61ec92d0d8a26)
:   [maven-release-plugin] prepare release 2.10.0

[f602324](https://github.com/dcache/dcache/commit/f60232478dc18eb8a36f14089b23df784485ce17)
:   srm: fix NPE when checking delegated credential

[4b2812d](https://github.com/dcache/dcache/commit/4b2812d9e2da0de4f52571557969fcc5ba0ba6e7)
:   srm: fix deserialise of TExtraInfo

[efe4315](https://github.com/dcache/dcache/commit/efe431524ed2afa3baa9dd14eec3f8f591eda6b2)
:   srm: fix IllegalStateTransition for COPY requests

[76a393b](https://github.com/dcache/dcache/commit/76a393b3da2b97223254b49ffeeb66bf3cd6ca91)
:   nfs4: use only address string in ProtocolInfo#toString() method

[d8fff55](https://github.com/dcache/dcache/commit/d8fff55ac80574f8e135e87b43bc0cdd47dd7ad2)
:   Add support for webdav 3rd-party transfer using http and https

[a150e36](https://github.com/dcache/dcache/commit/a150e3632b92fe1becaea4df41c3eddd578505fc)
:   webdav: allow users to choose between showing file's content inline and downloading it

[30c515b](https://github.com/dcache/dcache/commit/30c515b0a025acdb0e06ccf92732d76217c2b955)
:   Fix broken commit

[62bb02a](https://github.com/dcache/dcache/commit/62bb02a762b86adfd5f60165191997d6a10932f6)
:   srm,pool: improve support for 3rd-party HTTP copy

[7c8a5ea](https://github.com/dcache/dcache/commit/7c8a5ea592d3e1647873e0cb9ad17623268ff0fa)
:   webdav: add support for remote copy

[ed5bb82](https://github.com/dcache/dcache/commit/ed5bb826f6b423c9cc159cc6bc665f1a65be6879)
:   chimera: fix liquibase changeset to fail peacefully

[ab65294](https://github.com/dcache/dcache/commit/ab65294b6678fa56b4f633ff4c060fc109296012)
:   fix .gitignore to work for Eclipse on MacOS X

[f354005](https://github.com/dcache/dcache/commit/f35400570957144775db9bd5650bb7e9d0de8904)
:   libs: revet luquibase to 3.1.2

[f28f204](https://github.com/dcache/dcache/commit/f28f204d8216c7c221c34c24f8b1b25ce470e872)
:   Revert "Update to DataNucleus 4"

[23c6d2b](https://github.com/dcache/dcache/commit/23c6d2b54ca380c90c125ce5a4adb107223a417b)
:   srm: make timestamps easier to read

[27fa708](https://github.com/dcache/dcache/commit/27fa708c5306221cc94bca6620d8c1ca16fcc8a0)
:   srm: fix retry and failure messages for scheduled jobs

[ff2397f](https://github.com/dcache/dcache/commit/ff2397ffe9cf7470235d50c869a973be705f69d8)
:   srm: fix status of all-failed container jobs

[908ae5a](https://github.com/dcache/dcache/commit/908ae5a77f5467dc021a7e2945d1c0f368edb7cf)
:   srm-client: by default only delegate for srmcp with 3rd-party copies

[201af9e](https://github.com/dcache/dcache/commit/201af9e59e5bf952f4b0a04242c22fb9686fa490)
:   alarms: Fix checksum alarm filter.

[99e73b0](https://github.com/dcache/dcache/commit/99e73b0144edfbd43a31d06e12b6ff767aa8b084)
:   src: kill more of obsolete code

[3445ee3](https://github.com/dcache/dcache/commit/3445ee3aafc41e56fb92ab6211aaaa4bf99fe3c4)
:   src: kill more obsolete code

[87081b2](https://github.com/dcache/dcache/commit/87081b269657f4f394c1621275e9f5adcc38dbc7)
:   src: more obsolete code

[caf476c](https://github.com/dcache/dcache/commit/caf476c0d629e82b7ecaa5c3a3fa76762d123acb)
:   src: remove obsolete code

[9e4251e](https://github.com/dcache/dcache/commit/9e4251e60027145594e133841ecb5d719598108c)
:   pool: Add file count to 'info' output

[efa2de6](https://github.com/dcache/dcache/commit/efa2de674ac1ca5aa1b18d0aba186ee98c4ead22)
:   deb: Add python-psycopg2 as a recommended dependency

[5e71072](https://github.com/dcache/dcache/commit/5e710729cf24782c596d6a2baf8b5974d7ef51fd)
:   Update to DataNucleus 4

[75d3718](https://github.com/dcache/dcache/commit/75d3718f78818e5ea5c08e39fa59eb22ec683a8a)
:   Update third party dependencies

[38f00db](https://github.com/dcache/dcache/commit/38f00dbc4ac51757642d5873fb0593dcfc839783)
:   nfsv4: get client from current session for v4.1

[cf399f9](https://github.com/dcache/dcache/commit/cf399f9d4cd0a3a8ab3e3b7c39cbb2b242cd93f9)
:   delegation-shell: generate delegated credential of correct type

[a8438a5](https://github.com/dcache/dcache/commit/a8438a5f96d00c712336d83ff3b31ca2aa1dcde3)
:   pool: add soft/hard space allocation modes

[2a4efa6](https://github.com/dcache/dcache/commit/2a4efa6dc160e411aaf63f7d3c96c17b74d8b4ed)
:   pool: add Allocator#allocateNow()

[d22ad32](https://github.com/dcache/dcache/commit/d22ad32a3358151a7a270bafbc5d4d06fb92fc0c)
:   pool: Account#allocateNow() should trigger sweeper to get some space

[c22bba3](https://github.com/dcache/dcache/commit/c22bba37410ea5830642ddae3f702a370f2c6c27)
:   pool: Update repository javadoc

[5da93bb](https://github.com/dcache/dcache/commit/5da93bb9e6b5ff0149a30eae5a414fdc0ae97078)
:   Suppress nfs' file protocol from being published

[ade506e](https://github.com/dcache/dcache/commit/ade506eb0c921bdeb4284d42e7c247794b3e5d1a)
:   pool: Fix race condition that leads to orphaned files

[87bcfb2](https://github.com/dcache/dcache/commit/87bcfb2005a3234933cc39671995863cee2cf340)
:   srm: improve error message

[7fed889](https://github.com/dcache/dcache/commit/7fed8893e0e718cd053f80e6ae3f4c432d4ed9fe)
:   dcache-webadmin: fix pool queue plot grid placeholder image

[3740796](https://github.com/dcache/dcache/commit/37407965bbcfe197fd9eaaba894d39cfcb1113d1)
:   webadmin: fix regression in alarm deletion filter

[d7f67a7](https://github.com/dcache/dcache/commit/d7f67a79c52fae242d4d531ebe46bd57bdae6936)
:   cells: remove System time dependency in unit-test

[1722627](https://github.com/dcache/dcache/commit/1722627a02861b167707b264918cebdcb1b6b058)
:   webadmin: Reimplement active transfers page

[52d2f1c](https://github.com/dcache/dcache/commit/52d2f1c7346d0042c8cad4d27c4ef3de83eac906)
:   Intern several strings on message deserialization

[43ddb9f](https://github.com/dcache/dcache/commit/43ddb9fc53414a4e706baf186c6015b208f0097f)
:   webadmin: Simplify titel initialization of base page

[5026cf9](https://github.com/dcache/dcache/commit/5026cf9052b4170a54fc0c42389eba3ce40a52f3)
:   pool: log with error if checksum scanner gets an IO error

[b756c66](https://github.com/dcache/dcache/commit/b756c667239822895a97f9c96eb1a7f725e0d9b9)
:   nfs: add a command to reset pool's device id

[4d14b40](https://github.com/dcache/dcache/commit/4d14b40d4246d531fb3c07d66529d054673b00f4)
:   nfs: use new admin command interface

[b2575fa](https://github.com/dcache/dcache/commit/b2575fa08f8a26cbedd1545c8b5d9ae6ff8799dd)
:   nfs: remove double locking

[6a6fcfd](https://github.com/dcache/dcache/commit/6a6fcfd1e23776e3a7395b7d5441c68ba686ff3e)
:   ftp: Close passive port on failure

[44ecaa3](https://github.com/dcache/dcache/commit/44ecaa3fd3bc7058ca79ff50a709dcfd804e3e52)
:   ftp: Fix indentation

[0764f2a](https://github.com/dcache/dcache/commit/0764f2a0e20e31e496c83289169e4ce232c04613)
:   srm: Undo external operations if the request has expired

[15fa2ee](https://github.com/dcache/dcache/commit/15fa2eee32566e46907f60135e7df19f449854c9)
:   srm: Cancel upload path if request was aborted

[8b7bc70](https://github.com/dcache/dcache/commit/8b7bc70c21d6c6941982555a1f3f43427fa4b185)
:   ftp: fix LIST, NLST and MLSD cmd-channel output

[f1bee28](https://github.com/dcache/dcache/commit/f1bee28e1367db30958d5a8e5855b2e8bc63ee40)
:   pool: Fix regressions in new HSM subsystem

[e73977e](https://github.com/dcache/dcache/commit/e73977e85d6708cdf0aa23268ef1113c738f3b09)
:   Fix ArrayIndexOutOfBoundsException when processing multiple surls invoking srmget.

[d12513c](https://github.com/dcache/dcache/commit/d12513ca3f760c175b84ea7df90601f403840aeb)
:   Fix issue with incorrect determination of whether or not a string is encoded by replacing URLDecoder with import org.springframework.web.util.UriUtils as the former does not handle '+' character.

[40356b5](https://github.com/dcache/dcache/commit/40356b5bfbc3aab0f81fbb5434181bbeae974a16)
:   gplazma-xacml: Add handling of GID returned by GUMS in gPlazma2 XACML plugin

[97bd31a](https://github.com/dcache/dcache/commit/97bd31a3c2e89559d375094d1009c7c09bb01223)
:   dcache alarms: add properties and fuller documentation for configuring SMTP appender

[6f97e8d](https://github.com/dcache/dcache/commit/6f97e8db9711caef2749bff52fb819474de8ffb2)
:   system-test: fix web font corruption

[cb46d8a](https://github.com/dcache/dcache/commit/cb46d8a3347a59f736f584585ab6c2b1859bbd9f)
:   config: do not set default values for kdc and realm

[5c63d0e](https://github.com/dcache/dcache/commit/5c63d0e26a408eacd1c5d8d8398e47fd3eaad045)
:   http: fix multipart response size

[3fd5888](https://github.com/dcache/dcache/commit/3fd58888d25c406b448690208dd77560d9136d4e)
:   dcache-star: create valid xml even on db connection failure

[93e94be](https://github.com/dcache/dcache/commit/93e94bee1bf3773cd62b19f0da556ed05e14ee89)
:   xrootd,nfs: Add support for space management

[ab39955](https://github.com/dcache/dcache/commit/ab39955ff726598e30f8d9ff714b96e1d9bb27ec)
:   pinmanager,srm,spacemanager,xrootd: Fix pool monitor expiration

[3ac48ab](https://github.com/dcache/dcache/commit/3ac48ab7b5e81965f900b9546e53f6d0e929a7b0)
:   srm: Fix lock congestion

[3f40abe](https://github.com/dcache/dcache/commit/3f40abe39319bad44995d5f29d251e690708ccca)
:   http: do not use depricated API

[b0afa4f](https://github.com/dcache/dcache/commit/b0afa4f64612cfca1938a41dfa17d19544709949)
:   chimera-provider: fix regressions introduced by API change

[e671d5c](https://github.com/dcache/dcache/commit/e671d5c2a822a5ba242b79e8c82c61fe610d0292)
:   chimera: remove FileSystemProvider#getInodeChecksum

[1a79834](https://github.com/dcache/dcache/commit/1a7983408641f1c113884ddb536aa0a23201f866)
:   dcache-chimera: query for all checksums in one go

[0cb9af2](https://github.com/dcache/dcache/commit/0cb9af20ba77d0d6c75970fc3123fde015001b08)
:   Update third party libs

[e85f9cf](https://github.com/dcache/dcache/commit/e85f9cf3964014d692f4d78b628e91c867aee9e9)
:   webdav: Bootstrap for directory listing

[4137a00](https://github.com/dcache/dcache/commit/4137a0029247ee5f0bfb864b9fbc927cfbb82309)
:   xrootd: Quote IPv6 addresses in kXR_redirect replies

[c2d5170](https://github.com/dcache/dcache/commit/c2d5170da210e92daffb784eefa3f40a3c233911)
:   nfs: remove unused argument in NFSv41Door#getPool()

[bd7a2fe](https://github.com/dcache/dcache/commit/bd7a2fee1765d8cc69f5b0114a6c203698d3d9b3)
:   cells: Fix hidden NPE during initialization

[1933780](https://github.com/dcache/dcache/commit/1933780bcd0d1622497d246aec0d7aae2d21dcbd)
:   xrootd: Fix error message for read patch check

[39c2c0e](https://github.com/dcache/dcache/commit/39c2c0ebc16d97c1446c11c4a7a77c0d4862228f)
:   dcache-webadmin: fix login redirect bug which misleadingly results in Access Denied Page

[cabce53](https://github.com/dcache/dcache/commit/cabce532b44e6c3252b3cd344b1feabbd98f65a7)
:   xrootd: Upgrade to xrootd4j 1.3.3

[722ea6c](https://github.com/dcache/dcache/commit/722ea6c186cdd1347f2f205f2a10cd576259bae8)
:   system-test: Make log configuration more similar to production config

[8f2a7a0](https://github.com/dcache/dcache/commit/8f2a7a062a31d078d637d438fa3d1850de6fa1a2)
:   cells: Minor cleaning of CellPath and CellAddressCore

[41a3b9b](https://github.com/dcache/dcache/commit/41a3b9b6f3260044c23a85e3d78085c203119b77)
:   billing: Add date range and json/yaml output for billing search tool

[c3a83d9](https://github.com/dcache/dcache/commit/c3a83d944f4dbc854eb32394f5e3bff5602fcebc)
:   admin: Make prompt bold

[4a838d2](https://github.com/dcache/dcache/commit/4a838d240102db12eaa1d0fc035155e1b22495eb)
:   scripts: allow java8 runtime

[24a244f](https://github.com/dcache/dcache/commit/24a244fa940657ac8a2d544a3b408ab9f62584c2)
:   gplazma: authzdb add test case

[8f63805](https://github.com/dcache/dcache/commit/8f63805207506d60a8469f1ccebf8b737f25df9f)
:   dcap: do not call toString() on error object

[2f2badb](https://github.com/dcache/dcache/commit/2f2badb6a9ceb931d4522dac2355ad30f86e8faa)
:   dcap: ensure that we remove session on DoorTransferFinishedMessage

[3f34bda](https://github.com/dcache/dcache/commit/3f34bda57bde62ca1d1b9f98bd76634db81b93eb)
:   info-provider: fix works-by-accent bug when importing dCache config

[bdc8f49](https://github.com/dcache/dcache/commit/bdc8f49353e66760248952d6fea3bd99d470f52e)
:   webdav: switch activity logging to NetLogger format

[005b7bf](https://github.com/dcache/dcache/commit/005b7bf391f599b596aadd21982e35e82e64471f)
:   pom: update jglobus library

[35ab3f8](https://github.com/dcache/dcache/commit/35ab3f8869d91e51e618d19252bb53f09dd53a46)
:   srm: Use srm.enable.space-reservation rather than dcache.enable.space-reservation

[85d9e29](https://github.com/dcache/dcache/commit/85d9e29e4b21b808a0599edb26fe37e6d5dae312)
:   Fix rendering of negative numbers in columm layout

[4bd5947](https://github.com/dcache/dcache/commit/4bd59471b7fdc9f86ba27b7838316ff8782a528a)
:   namespace: Improve error message in upload cancellation

[58192a1](https://github.com/dcache/dcache/commit/58192a13e8151572185b1fbddcd360ed45fc0524)
:   srm: Fix NPE

[eeb9301](https://github.com/dcache/dcache/commit/eeb930158860212fcf3a9360641235fbd57c67b2)
:   ftp,dcap: Don't export child doors

[eb9212c](https://github.com/dcache/dcache/commit/eb9212c581f50266e4210fb8545e2973f8fe4bc5)
:   ftp: Add more information to info page

[a966d7a](https://github.com/dcache/dcache/commit/a966d7ada711f438657622ae616109a3e374fce9)
:   cleaner: Shut down timer thread

[afac6ab](https://github.com/dcache/dcache/commit/afac6abdf24ff4f99570362e0eaf99939b898f77)
:   pool: Improve robustness of p2p

[ed1975e](https://github.com/dcache/dcache/commit/ed1975e03a69065d1fe2b9af5f2570341e9bd13e)
:   httpd: Fix a couple of bugs

[39b2c11](https://github.com/dcache/dcache/commit/39b2c1153e02882c4b4ae4309d37bffdffbe8f87)
:   srm: Avoid duplicate status code update on status query

[0eb1af0](https://github.com/dcache/dcache/commit/0eb1af0b1c867fe736220ba1dbbf581232c4aefc)
:   xrootd: split protocol name form the client IP in XrootdProtocolInfo

[ee90392](https://github.com/dcache/dcache/commit/ee903925e9ea4513b3c553847ad120f62dab5ab3)
:   chimera: Fix duplicate key supression

[9bbb9dc](https://github.com/dcache/dcache/commit/9bbb9dc9a0e4670d287754af12264481eab5a1ef)
:   Revert "srm: Drop fail fast for protocol checks"

[fd9d0c7](https://github.com/dcache/dcache/commit/fd9d0c7f0bc624332f43318473c40910c1a7d312)
:   srm: Fix request cancellation due to SURL deletion

[4837397](https://github.com/dcache/dcache/commit/4837397fb0c48305e610233f8e446e5b19cee44a)
:   srm: Fix request expiration

[45f658f](https://github.com/dcache/dcache/commit/45f658f9af050d7bdf347a143c3a81d1793027c9)
:   nfs: make cell export configurable

[2e3034d](https://github.com/dcache/dcache/commit/2e3034d83b82c9d5acbd23782419c9382ed64957)
:   fix type in gplazma ldap default value

[27fdd4d](https://github.com/dcache/dcache/commit/27fdd4d6d1ddabc1dbc55d1bdfd70d7e88629f33)
:   Drop messages when TTL is exceeded

[360a230](https://github.com/dcache/dcache/commit/360a2302a77cde3eac52e5d30f3fd9ae33b98872)
:   cells: Fix message counting in case of queue overflow

[69fbf87](https://github.com/dcache/dcache/commit/69fbf87d1dedc111fbfaf9321e80e2222ccafd5d)
:   pool: Improve how we deal with unexpected files in pools

[c34fa7e](https://github.com/dcache/dcache/commit/c34fa7ef92e96d5131a7d338b28c8440e9340a87)
:   pool: Fix error handling in staging code

[c67f043](https://github.com/dcache/dcache/commit/c67f043c8399935819c65f3414302378cda48935)
:   system-test: Pick up DN of dCache user cert if available

[3a22b10](https://github.com/dcache/dcache/commit/3a22b10f971e3a78372636c9c18930acfd223a28)
:   pool: Log P2P fatal errors with stack trace

[6723151](https://github.com/dcache/dcache/commit/67231510af1a3b705faadd4456efde9c6b9eb1dd)
:   info: add JSON serialisation

[f6c4fc5](https://github.com/dcache/dcache/commit/f6c4fc5aef90652c2fa5199dc63d845fd3b47ce2)
:   srm: Fix transition ordering for restored requests

[3a27973](https://github.com/dcache/dcache/commit/3a27973cc6675cca4c7bcf9822c2834846b00cda)
:   hsm scripts: fix command and options order

[8364809](https://github.com/dcache/dcache/commit/8364809029923b25a96c1d3eaae80eca77f501d4)
:   billing: do not generate billing message if file based store is disabled

[47852ba](https://github.com/dcache/dcache/commit/47852ba48cc9c1d6843301d43f5ab772f081277d)
:   webdav: generate error page when template couldn't be found

[c688083](https://github.com/dcache/dcache/commit/c688083c041725bf4528babc31f4bd53c6d1ad88)
:   webdav: work-around race-condition in StringTemplate library

[239a7f9](https://github.com/dcache/dcache/commit/239a7f99bf250e14b51e170f6ac62c8c8957713d)
:   systemtest: regenerate host credentials, add user credentials

[d728fc0](https://github.com/dcache/dcache/commit/d728fc0a0da1f745bb4ebfe2de49c3212721ec5e)
:   httpd: log bugs with stacktrace

[eb82e9f](https://github.com/dcache/dcache/commit/eb82e9f9122925f960bdd92f6585a5ae5f8617ea)
:   core: remove obsolete code

[d90196a](https://github.com/dcache/dcache/commit/d90196a5a324363943bd26b9bafefc2d197f6184)
:   srm: Fix deadlock in pinning

[e0e9a51](https://github.com/dcache/dcache/commit/e0e9a510a51b037e8b0e16fcef449af78e6c0272)
:   srm: Schedule resubmit of pin request to avoid deadlock

[0f5a4d5](https://github.com/dcache/dcache/commit/0f5a4d579476094c12e393bd14fdccb90ba99826)
:   srm: Drop fail fast for protocol checks

[d078fdb](https://github.com/dcache/dcache/commit/d078fdb96a6081d578bf133f4a83017b239e98cb)
:   pnfsmanager: Fix expected size extraction and tag caching

[b30bc4a](https://github.com/dcache/dcache/commit/b30bc4a8575d4a8a734d175e1bf3e4fb6643ad8a)
:   scripts: fix credentials script to work for non-Linux machines

[b97bec9](https://github.com/dcache/dcache/commit/b97bec9dfabd8bfafc2bda2107a07ad9c56fd64b)
:   srm: Minor cleanup of job scheduling

[4b84cef](https://github.com/dcache/dcache/commit/4b84cef40930a634945cdc165329bd970329668e)
:   srm: Simplify scheduler configuration

[608b736](https://github.com/dcache/dcache/commit/608b73600ed4fbfa044adc43b703bc0db3bda44b)
:   ssh1: Remove service from dCache

[c1e6fed](https://github.com/dcache/dcache/commit/c1e6fed84a1a09bbdec8bb1ca1ca594da32f4c5b)
:   Silence log messages commonly associated with client disconnects

[4b7d7a0](https://github.com/dcache/dcache/commit/4b7d7a057f9fbbea32eeffb8caa741e62235c992)
:   fhs: Use gzip compression for deb package

[654b6ce](https://github.com/dcache/dcache/commit/654b6ce3f1d6c265bc30ae0f6c5931c51780c90b)
:   srm: Simplify unpin callbacks

[7209d9f](https://github.com/dcache/dcache/commit/7209d9f5c1e858a7893b4872c80072cb6d7741de)
:   srm: Align SRM scheduler with SRM request states

[4fc36a0](https://github.com/dcache/dcache/commit/4fc36a0cc020c1a1808dbcf7ea47777e07860a69)
:   srm: Report correct state for RQUEUED and TQUEUED

[0194173](https://github.com/dcache/dcache/commit/01941732a40f7be8abfbaf4cb5c9bc4cba96fc0e)
:   statistics: Fix NPE

[a01653f](https://github.com/dcache/dcache/commit/a01653f5a10a222ace769ce57b0acc446a432b29)
:   pool: Remove legacy hsm initialization from default pool setup

[418c8ff](https://github.com/dcache/dcache/commit/418c8ff1fd3c16e8274f26250fe09d3587e44092)
:   core: split protocol name form the client IP in HttpProtocolInfo

[5cf8806](https://github.com/dcache/dcache/commit/5cf880600decbfc70227ce8585b08654378f2581)
:   srm: Split standalone configuration from generic configuration

[cbb5936](https://github.com/dcache/dcache/commit/cbb593659dc87834d3ae8015de6808f651b6b56e)
:   srm: fix retry of copy-pull

[a4c7f34](https://github.com/dcache/dcache/commit/a4c7f34615a4a567bccd8b26636b4100f7f8e636)
:   alarms, billing: fix liquibase character varying and cleanup.

[460b9e0](https://github.com/dcache/dcache/commit/460b9e0ed64f2c8d83a738471b28700e71a698f7)
:   systemtest: add support for generating user credentials

[7e6e2ef](https://github.com/dcache/dcache/commit/7e6e2ef7a8ad506293fc440cc1354eeed9c2607a)
:   pool: Report correct client IP to billing for passive FTP transfers

[942035a](https://github.com/dcache/dcache/commit/942035ad08e781006a7fa87201ab35f3eba7d502)
:   srm: Fix race condition in listing

[6750fd4](https://github.com/dcache/dcache/commit/6750fd426d7e60da7332453a28bfbc88d228274e)
:   poolmanager: Fix infinite loop in lru partition type

[3c6da51](https://github.com/dcache/dcache/commit/3c6da5111544709105f5adbb3d6dbf4d38de988f)
:   gplazma-nis: pulgin must fail if no matching principal found

[c34be64](https://github.com/dcache/dcache/commit/c34be640f9aaa59a93048fd5ef16ef7af652c8ca)
:   nfs: do not use CDC as try-with-resource

[dfc809c](https://github.com/dcache/dcache/commit/dfc809c6c6d38f9bd764ebf58f40fbed65c0b890)
:   databases: update hikari minimum connection configuration

[193cba9](https://github.com/dcache/dcache/commit/193cba946cdf5235035379f24b4735ec91627645)
:   nfs4: do not log stacktrace on IO errors

[b937f41](https://github.com/dcache/dcache/commit/b937f415804f44da3bbf96d34ac688ba8a0cc506)
:   nfs: make cache time unit property name guideline compliant

[80ade65](https://github.com/dcache/dcache/commit/80ade65b1a6399b443512fc5c12f929c276eb630)
:   poolmanager,pool: Fix precision underflow in WASS

[d56c1e0](https://github.com/dcache/dcache/commit/d56c1e0b47287760086c316f7f23bb5f361b6bf2)
:   poolmanager: remove wrandom partition type

[dc0188b](https://github.com/dcache/dcache/commit/dc0188bdb48ef728dbfb5dcec89f5a58bcdec3b6)
:   pool: small cleanups in sweeper

[f82ced7](https://github.com/dcache/dcache/commit/f82ced725ceeba30fef777586fc1184be788d7ba)
:   pool: wake-up sweeper if new entry is added

[89e8063](https://github.com/dcache/dcache/commit/89e806308531e871646d3883d7142aa3434a9bdc)
:   releases: update dCache version to v2.10



</div>
</div>
</div>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js" type="text/javascript"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.2/jquery-ui.min.js" type="text/javascript"></script>
<script src="https://netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js" type="text/javascript"></script>
<script src="https://google-code-prettify.googlecode.com/svn/loader/run_prettify.js" type="text/javascript"></script>
